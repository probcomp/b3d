
TypeError: true_fun and false_fun output must have same type structure, got 
PyTreeDef((*, (CustomNode(Pose[None], 
                [CustomNode(Diff[('primal', 'tangent'), (), ()], [*, CustomNode(_NoChange[(), (), ()], [])]), CustomNode(Diff[('primal', 'tangent'), (), ()], [*, CustomNode(_NoChange[(), (), ()], [])])]), [CustomNode(Pose[None], [CustomNode(Diff[('primal', 'tangent'), (), ()], [*, CustomNode(_NoChange[(), (), ()], [])]), CustomNode(Diff[('primal', 'tangent'), (), ()], [*, CustomNode(_NoChange[(), (), ()], [])])])]), *, *))
and
PyTreeDef((*, (CustomNode(Pose[None], [*, *]), [CustomNode(Pose[None], [*, *])]), *, *)).