<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.4.0"/>
    <title>b3d.io API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
    }
</style><style>
    .pdoc .mermaid-pre {
        border: none;
        background: none;
    }
</style>
<script type="module" defer>
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";

    /* Re-invoke Mermaid when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => mermaid.run()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../b3d.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;b3d</a>

            <img src="https://github.com/probcomp/b3d/assets/66085644/50bc2fc3-c9cd-4139-bed6-9c6d53933622" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#MeshData">MeshData</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MeshData.__init__">MeshData</a>
                        </li>
                        <li>
                                <a class="variable" href="#MeshData.vertices_positions">vertices_positions</a>
                        </li>
                        <li>
                                <a class="variable" href="#MeshData.vertices_normals">vertices_normals</a>
                        </li>
                        <li>
                                <a class="variable" href="#MeshData.vertices_uv">vertices_uv</a>
                        </li>
                        <li>
                                <a class="variable" href="#MeshData.triangles">triangles</a>
                        </li>
                        <li>
                                <a class="variable" href="#MeshData.triangles_materials">triangles_materials</a>
                        </li>
                        <li>
                                <a class="variable" href="#MeshData.materials">materials</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshData.save">save</a>
                        </li>
                        <li>
                                <a class="function" href="#MeshData.load">load</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#FeatureTrackData">FeatureTrackData</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FeatureTrackData.__init__">FeatureTrackData</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.observed_keypoints_positions">observed_keypoints_positions</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.keypoint_visibility">keypoint_visibility</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.camera_intrinsics">camera_intrinsics</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.rgbd_images">rgbd_images</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.fps">fps</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.observed_features">observed_features</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.latent_keypoint_positions">latent_keypoint_positions</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.latent_keypoint_quaternions">latent_keypoint_quaternions</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.object_assignments">object_assignments</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.camera_position">camera_position</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.camera_quaternion">camera_quaternion</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.num_frames">num_frames</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.num_keypoints">num_keypoints</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.shape">shape</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.uv">uv</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.vis">vis</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.rgb">rgb</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.visibility">visibility</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.rgbd">rgbd</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.camera_poses">camera_poses</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureTrackData.intrinsics">intrinsics</a>
                        </li>
                        <li>
                                <a class="function" href="#FeatureTrackData.save">save</a>
                        </li>
                        <li>
                                <a class="function" href="#FeatureTrackData.load">load</a>
                        </li>
                        <li>
                                <a class="function" href="#FeatureTrackData.slice_time">slice_time</a>
                        </li>
                        <li>
                                <a class="function" href="#FeatureTrackData.downscale">downscale</a>
                        </li>
                        <li>
                                <a class="function" href="#FeatureTrackData.has_depth_channel">has_depth_channel</a>
                        </li>
                        <li>
                                <a class="function" href="#FeatureTrackData.remove_points_invisible_at_frame0">remove_points_invisible_at_frame0</a>
                        </li>
                        <li>
                                <a class="function" href="#FeatureTrackData.all_points_visible_at_frame0">all_points_visible_at_frame0</a>
                        </li>
                        <li>
                                <a class="function" href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0">sparsify_points_to_minimum_2D_distance_at_frame0</a>
                        </li>
                        <li>
                                <a class="function" href="#FeatureTrackData.min_2D_distance_at_frame0">min_2D_distance_at_frame0</a>
                        </li>
                        <li>
                                <a class="function" href="#FeatureTrackData.quick_plot">quick_plot</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#VideoInput">VideoInput</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#VideoInput.__init__">VideoInput</a>
                        </li>
                        <li>
                                <a class="variable" href="#VideoInput.rgb">rgb</a>
                        </li>
                        <li>
                                <a class="variable" href="#VideoInput.xyz">xyz</a>
                        </li>
                        <li>
                                <a class="variable" href="#VideoInput.camera_positions">camera_positions</a>
                        </li>
                        <li>
                                <a class="variable" href="#VideoInput.camera_quaternions">camera_quaternions</a>
                        </li>
                        <li>
                                <a class="variable" href="#VideoInput.camera_intrinsics_rgb">camera_intrinsics_rgb</a>
                        </li>
                        <li>
                                <a class="variable" href="#VideoInput.camera_intrinsics_depth">camera_intrinsics_depth</a>
                        </li>
                        <li>
                                <a class="variable" href="#VideoInput.z">z</a>
                        </li>
                        <li>
                                <a class="variable" href="#VideoInput.depth">depth</a>
                        </li>
                        <li>
                                <a class="variable" href="#VideoInput.rgbd">rgbd</a>
                        </li>
                        <li>
                                <a class="variable" href="#VideoInput.fps">fps</a>
                        </li>
                        <li>
                                <a class="function" href="#VideoInput.to_dict">to_dict</a>
                        </li>
                        <li>
                                <a class="function" href="#VideoInput.save">save</a>
                        </li>
                        <li>
                                <a class="function" href="#VideoInput.save_in_timeframe">save_in_timeframe</a>
                        </li>
                        <li>
                                <a class="function" href="#VideoInput.load">load</a>
                        </li>
                        <li>
                                <a class="variable" href="#VideoInput.rgb_float">rgb_float</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../b3d.html">b3d</a><wbr>.io    </h1>


                        <input id="mod-io-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-io-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">1</span></a><span class="kn">from</span> <span class="nn">.data_loader</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">2</span></a><span class="kn">from</span> <span class="nn">.feature_track_data</span> <span class="kn">import</span> <span class="n">FeatureTrackData</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">3</span></a><span class="kn">from</span> <span class="nn">.mesh_data</span> <span class="kn">import</span> <span class="n">MeshData</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">4</span></a><span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">5</span></a><span class="kn">from</span> <span class="nn">.video_input</span> <span class="kn">import</span> <span class="n">VideoInput</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">7</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;MeshData&quot;</span><span class="p">,</span> <span class="s2">&quot;FeatureTrackData&quot;</span><span class="p">,</span> <span class="s2">&quot;VideoInput&quot;</span><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="MeshData">
                            <input id="MeshData-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclasses.dataclass(kw_only=True)</div>

    <span class="def">class</span>
    <span class="name">MeshData</span>:

                <label class="view-source-button" for="MeshData-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshData"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshData-10"><a href="#MeshData-10"><span class="linenos">10</span></a><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span><span class="p">(</span><span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="MeshData-11"><a href="#MeshData-11"><span class="linenos">11</span></a><span class="k">class</span> <span class="nc">MeshData</span><span class="p">:</span>
</span><span id="MeshData-12"><a href="#MeshData-12"><span class="linenos">12</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="MeshData-13"><a href="#MeshData-13"><span class="linenos">13</span></a><span class="sd">    Mesh data class. Note: Spatial units are measured in meters.</span>
</span><span id="MeshData-14"><a href="#MeshData-14"><span class="linenos">14</span></a>
</span><span id="MeshData-15"><a href="#MeshData-15"><span class="linenos">15</span></a><span class="sd">    Args:</span>
</span><span id="MeshData-16"><a href="#MeshData-16"><span class="linenos">16</span></a><span class="sd">            vertices_positions:     (T, N, 3) Float Array</span>
</span><span id="MeshData-17"><a href="#MeshData-17"><span class="linenos">17</span></a><span class="sd">            vertices_normals:       (T, N, 3) Float Array</span>
</span><span id="MeshData-18"><a href="#MeshData-18"><span class="linenos">18</span></a><span class="sd">            vertices_uv:            (N, 2) Float Array; corresponds to the texture coordinates associated with the vertex. [0,0] represents the bottom-left corner of the texture, and [1,1] represents the top-rigtht.</span>
</span><span id="MeshData-19"><a href="#MeshData-19"><span class="linenos">19</span></a><span class="sd">            triangles:              (M, 3) Int Array; vertices indexes</span>
</span><span id="MeshData-20"><a href="#MeshData-20"><span class="linenos">20</span></a><span class="sd">            triangles_materials:    (M, ) Int Array; material index</span>
</span><span id="MeshData-21"><a href="#MeshData-21"><span class="linenos">21</span></a><span class="sd">            materials:              (A, B, H, W, 3) Uint8 Array; there are B RGB textures for each material. For each material, the first texture is the color map texture, the second one (optional) is the normal map texture, and the third one (optional), the specular map texture.</span>
</span><span id="MeshData-22"><a href="#MeshData-22"><span class="linenos">22</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MeshData-23"><a href="#MeshData-23"><span class="linenos">23</span></a>
</span><span id="MeshData-24"><a href="#MeshData-24"><span class="linenos">24</span></a>    <span class="n">vertices_positions</span><span class="p">:</span> <span class="n">Array</span>
</span><span id="MeshData-25"><a href="#MeshData-25"><span class="linenos">25</span></a>    <span class="n">vertices_normals</span><span class="p">:</span> <span class="n">Array</span>
</span><span id="MeshData-26"><a href="#MeshData-26"><span class="linenos">26</span></a>    <span class="n">vertices_uv</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MeshData-27"><a href="#MeshData-27"><span class="linenos">27</span></a>    <span class="n">triangles</span><span class="p">:</span> <span class="n">Array</span>
</span><span id="MeshData-28"><a href="#MeshData-28"><span class="linenos">28</span></a>    <span class="n">triangles_materials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MeshData-29"><a href="#MeshData-29"><span class="linenos">29</span></a>    <span class="n">materials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MeshData-30"><a href="#MeshData-30"><span class="linenos">30</span></a>
</span><span id="MeshData-31"><a href="#MeshData-31"><span class="linenos">31</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="MeshData-32"><a href="#MeshData-32"><span class="linenos">32</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves input to file&quot;&quot;&quot;</span>
</span><span id="MeshData-33"><a href="#MeshData-33"><span class="linenos">33</span></a>        <span class="n">to_save</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>
</span><span id="MeshData-34"><a href="#MeshData-34"><span class="linenos">34</span></a>        <span class="n">jnp</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="o">**</span><span class="n">to_save</span><span class="p">)</span>
</span><span id="MeshData-35"><a href="#MeshData-35"><span class="linenos">35</span></a>
</span><span id="MeshData-36"><a href="#MeshData-36"><span class="linenos">36</span></a>    <span class="nd">@classmethod</span>
</span><span id="MeshData-37"><a href="#MeshData-37"><span class="linenos">37</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="MeshData-38"><a href="#MeshData-38"><span class="linenos">38</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads input from file&quot;&quot;&quot;</span>
</span><span id="MeshData-39"><a href="#MeshData-39"><span class="linenos">39</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="MeshData-40"><a href="#MeshData-40"><span class="linenos">40</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MeshData-41"><a href="#MeshData-41"><span class="linenos">41</span></a>            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>  <span class="c1"># type: ignore</span>
</span></pre></div>


            <div class="docstring"><p>Mesh data class. Note: Spatial units are measured in meters.</p>

<p>Args:
        vertices_positions:     (T, N, 3) Float Array
        vertices_normals:       (T, N, 3) Float Array
        vertices_uv:            (N, 2) Float Array; corresponds to the texture coordinates associated with the vertex. [0,0] represents the bottom-left corner of the texture, and [1,1] represents the top-rigtht.
        triangles:              (M, 3) Int Array; vertices indexes
        triangles_materials:    (M, ) Int Array; material index
        materials:              (A, B, H, W, 3) Uint8 Array; there are B RGB textures for each material. For each material, the first texture is the color map texture, the second one (optional) is the normal map texture, and the third one (optional), the specular map texture.</p>
</div>


                            <div id="MeshData.__init__" class="classattr">
                                <div class="attr function">

        <span class="name">MeshData</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">vertices_positions</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span>,</span><span class="param">	<span class="n">vertices_normals</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span>,</span><span class="param">	<span class="n">vertices_uv</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">triangles</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span>,</span><span class="param">	<span class="n">triangles_materials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">materials</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>


    </div>
    <a class="headerlink" href="#MeshData.__init__"></a>



                            </div>
                            <div id="MeshData.vertices_positions" class="classattr">
                                <div class="attr variable">
            <span class="name">vertices_positions</span><span class="annotation">: jax.Array</span>


    </div>
    <a class="headerlink" href="#MeshData.vertices_positions"></a>



                            </div>
                            <div id="MeshData.vertices_normals" class="classattr">
                                <div class="attr variable">
            <span class="name">vertices_normals</span><span class="annotation">: jax.Array</span>


    </div>
    <a class="headerlink" href="#MeshData.vertices_normals"></a>



                            </div>
                            <div id="MeshData.vertices_uv" class="classattr">
                                <div class="attr variable">
            <span class="name">vertices_uv</span><span class="annotation">: Optional[jax.Array]</span>        =
<span class="default_value">None</span>


    </div>
    <a class="headerlink" href="#MeshData.vertices_uv"></a>



                            </div>
                            <div id="MeshData.triangles" class="classattr">
                                <div class="attr variable">
            <span class="name">triangles</span><span class="annotation">: jax.Array</span>


    </div>
    <a class="headerlink" href="#MeshData.triangles"></a>



                            </div>
                            <div id="MeshData.triangles_materials" class="classattr">
                                <div class="attr variable">
            <span class="name">triangles_materials</span><span class="annotation">: Optional[jax.Array]</span>        =
<span class="default_value">None</span>


    </div>
    <a class="headerlink" href="#MeshData.triangles_materials"></a>



                            </div>
                            <div id="MeshData.materials" class="classattr">
                                <div class="attr variable">
            <span class="name">materials</span><span class="annotation">: Optional[jax.Array]</span>        =
<span class="default_value">None</span>


    </div>
    <a class="headerlink" href="#MeshData.materials"></a>



                            </div>
                            <div id="MeshData.save" class="classattr">
                                        <input id="MeshData.save-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">save</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshData.save-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshData.save"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshData.save-31"><a href="#MeshData.save-31"><span class="linenos">31</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="MeshData.save-32"><a href="#MeshData.save-32"><span class="linenos">32</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves input to file&quot;&quot;&quot;</span>
</span><span id="MeshData.save-33"><a href="#MeshData.save-33"><span class="linenos">33</span></a>        <span class="n">to_save</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">asdict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>
</span><span id="MeshData.save-34"><a href="#MeshData.save-34"><span class="linenos">34</span></a>        <span class="n">jnp</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="o">**</span><span class="n">to_save</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Saves input to file</p>
</div>


                            </div>
                            <div id="MeshData.load" class="classattr">
                                        <input id="MeshData.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MeshData.load-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MeshData.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MeshData.load-36"><a href="#MeshData.load-36"><span class="linenos">36</span></a>    <span class="nd">@classmethod</span>
</span><span id="MeshData.load-37"><a href="#MeshData.load-37"><span class="linenos">37</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="MeshData.load-38"><a href="#MeshData.load-38"><span class="linenos">38</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads input from file&quot;&quot;&quot;</span>
</span><span id="MeshData.load-39"><a href="#MeshData.load-39"><span class="linenos">39</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="MeshData.load-40"><a href="#MeshData.load-40"><span class="linenos">40</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MeshData.load-41"><a href="#MeshData.load-41"><span class="linenos">41</span></a>            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>  <span class="c1"># type: ignore</span>
</span></pre></div>


            <div class="docstring"><p>Loads input from file</p>
</div>


                            </div>
                </section>
                <section id="FeatureTrackData">
                            <input id="FeatureTrackData-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">FeatureTrackData</span>:

                <label class="view-source-button" for="FeatureTrackData-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData-23"><a href="#FeatureTrackData-23"><span class="linenos"> 23</span></a><span class="nd">@dataclass</span>
</span><span id="FeatureTrackData-24"><a href="#FeatureTrackData-24"><span class="linenos"> 24</span></a><span class="k">class</span> <span class="nc">FeatureTrackData</span><span class="p">:</span>
</span><span id="FeatureTrackData-25"><a href="#FeatureTrackData-25"><span class="linenos"> 25</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureTrackData-26"><a href="#FeatureTrackData-26"><span class="linenos"> 26</span></a><span class="sd">    Feature track data class. Note: Spatial units are measured in meters.</span>
</span><span id="FeatureTrackData-27"><a href="#FeatureTrackData-27"><span class="linenos"> 27</span></a>
</span><span id="FeatureTrackData-28"><a href="#FeatureTrackData-28"><span class="linenos"> 28</span></a><span class="sd">    Args:</span>
</span><span id="FeatureTrackData-29"><a href="#FeatureTrackData-29"><span class="linenos"> 29</span></a><span class="sd">            observed_keypoints_positions: (T, N, 2) Float Array; 2D points stored as [x, y]</span>
</span><span id="FeatureTrackData-30"><a href="#FeatureTrackData-30"><span class="linenos"> 30</span></a><span class="sd">            keypoint_visibility:          (T, N) Boolean Array</span>
</span><span id="FeatureTrackData-31"><a href="#FeatureTrackData-31"><span class="linenos"> 31</span></a><span class="sd">            camera_intrinsics:            (8,) Float Array of camera intrinsics, see `camera.py`.</span>
</span><span id="FeatureTrackData-32"><a href="#FeatureTrackData-32"><span class="linenos"> 32</span></a><span class="sd">            rgbd_images:                  (T, H, W, 4) Float Array</span>
</span><span id="FeatureTrackData-33"><a href="#FeatureTrackData-33"><span class="linenos"> 33</span></a><span class="sd">            (optional) fps:                          Float</span>
</span><span id="FeatureTrackData-34"><a href="#FeatureTrackData-34"><span class="linenos"> 34</span></a><span class="sd">            (optional) observed_features :           (T, N, F) Float Array OR None</span>
</span><span id="FeatureTrackData-35"><a href="#FeatureTrackData-35"><span class="linenos"> 35</span></a><span class="sd">            (optional) latent_keypoint_positions :   (T, N, 3) Float Array OR None</span>
</span><span id="FeatureTrackData-36"><a href="#FeatureTrackData-36"><span class="linenos"> 36</span></a><span class="sd">            (optional) latent_keypoint_quaternions : (T, N, 4) Float Array OR None</span>
</span><span id="FeatureTrackData-37"><a href="#FeatureTrackData-37"><span class="linenos"> 37</span></a><span class="sd">            (optional) object_assignments:           (N,) Int Array OR None</span>
</span><span id="FeatureTrackData-38"><a href="#FeatureTrackData-38"><span class="linenos"> 38</span></a><span class="sd">            (optional) camera_position:              (T, 3) Float Array OR None</span>
</span><span id="FeatureTrackData-39"><a href="#FeatureTrackData-39"><span class="linenos"> 39</span></a><span class="sd">            (optional) camera_quaternion:            (T, 4) Float Array OR None</span>
</span><span id="FeatureTrackData-40"><a href="#FeatureTrackData-40"><span class="linenos"> 40</span></a>
</span><span id="FeatureTrackData-41"><a href="#FeatureTrackData-41"><span class="linenos"> 41</span></a><span class="sd">    Example:</span>
</span><span id="FeatureTrackData-42"><a href="#FeatureTrackData-42"><span class="linenos"> 42</span></a><span class="sd">    ```</span>
</span><span id="FeatureTrackData-43"><a href="#FeatureTrackData-43"><span class="linenos"> 43</span></a><span class="sd">    # Initialize</span>
</span><span id="FeatureTrackData-44"><a href="#FeatureTrackData-44"><span class="linenos"> 44</span></a><span class="sd">    data = FeatureTrackData(</span>
</span><span id="FeatureTrackData-45"><a href="#FeatureTrackData-45"><span class="linenos"> 45</span></a><span class="sd">        observed_keypoints_positions = uv,</span>
</span><span id="FeatureTrackData-46"><a href="#FeatureTrackData-46"><span class="linenos"> 46</span></a><span class="sd">        keypoint_visibility = vis,</span>
</span><span id="FeatureTrackData-47"><a href="#FeatureTrackData-47"><span class="linenos"> 47</span></a><span class="sd">        camera_intrinsics = intr,</span>
</span><span id="FeatureTrackData-48"><a href="#FeatureTrackData-48"><span class="linenos"> 48</span></a><span class="sd">        rgbd_images = rgb_or_rgbd)</span>
</span><span id="FeatureTrackData-49"><a href="#FeatureTrackData-49"><span class="linenos"> 49</span></a>
</span><span id="FeatureTrackData-50"><a href="#FeatureTrackData-50"><span class="linenos"> 50</span></a><span class="sd">    # Save and load</span>
</span><span id="FeatureTrackData-51"><a href="#FeatureTrackData-51"><span class="linenos"> 51</span></a><span class="sd">    fname = &quot;_temp.npz&quot;</span>
</span><span id="FeatureTrackData-52"><a href="#FeatureTrackData-52"><span class="linenos"> 52</span></a><span class="sd">    data.save(fname)</span>
</span><span id="FeatureTrackData-53"><a href="#FeatureTrackData-53"><span class="linenos"> 53</span></a><span class="sd">    data = FeatureTrackData.load(fname)</span>
</span><span id="FeatureTrackData-54"><a href="#FeatureTrackData-54"><span class="linenos"> 54</span></a>
</span><span id="FeatureTrackData-55"><a href="#FeatureTrackData-55"><span class="linenos"> 55</span></a><span class="sd">    # Quick access</span>
</span><span id="FeatureTrackData-56"><a href="#FeatureTrackData-56"><span class="linenos"> 56</span></a><span class="sd">    uv   = data.uv</span>
</span><span id="FeatureTrackData-57"><a href="#FeatureTrackData-57"><span class="linenos"> 57</span></a><span class="sd">    vis  = data.vis</span>
</span><span id="FeatureTrackData-58"><a href="#FeatureTrackData-58"><span class="linenos"> 58</span></a><span class="sd">    rgb  = data.rgb</span>
</span><span id="FeatureTrackData-59"><a href="#FeatureTrackData-59"><span class="linenos"> 59</span></a><span class="sd">    rgbd = data.rgbd</span>
</span><span id="FeatureTrackData-60"><a href="#FeatureTrackData-60"><span class="linenos"> 60</span></a><span class="sd">    intr = data.intrinsics</span>
</span><span id="FeatureTrackData-61"><a href="#FeatureTrackData-61"><span class="linenos"> 61</span></a><span class="sd">    cams = data.camera_poses</span>
</span><span id="FeatureTrackData-62"><a href="#FeatureTrackData-62"><span class="linenos"> 62</span></a><span class="sd">    ```</span>
</span><span id="FeatureTrackData-63"><a href="#FeatureTrackData-63"><span class="linenos"> 63</span></a>
</span><span id="FeatureTrackData-64"><a href="#FeatureTrackData-64"><span class="linenos"> 64</span></a><span class="sd">    FeatureTrackData.load also supports</span>
</span><span id="FeatureTrackData-65"><a href="#FeatureTrackData-65"><span class="linenos"> 65</span></a><span class="sd">    (1) Loading from npz files with a `rgb_imgs` field instead of `rgbd_images`.</span>
</span><span id="FeatureTrackData-66"><a href="#FeatureTrackData-66"><span class="linenos"> 66</span></a><span class="sd">        In this case, the loader also looks for a `xyz` field to complete the `rgbd_images`;</span>
</span><span id="FeatureTrackData-67"><a href="#FeatureTrackData-67"><span class="linenos"> 67</span></a><span class="sd">        if none is found, the depth channel is set to zeros.</span>
</span><span id="FeatureTrackData-68"><a href="#FeatureTrackData-68"><span class="linenos"> 68</span></a><span class="sd">    (2) Loading from npz files with a `latent_keypoint_visibility` field instead of `keypoint_visibility`.</span>
</span><span id="FeatureTrackData-69"><a href="#FeatureTrackData-69"><span class="linenos"> 69</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FeatureTrackData-70"><a href="#FeatureTrackData-70"><span class="linenos"> 70</span></a>
</span><span id="FeatureTrackData-71"><a href="#FeatureTrackData-71"><span class="linenos"> 71</span></a>    <span class="c1"># Required fields: Observed Data</span>
</span><span id="FeatureTrackData-72"><a href="#FeatureTrackData-72"><span class="linenos"> 72</span></a>    <span class="n">observed_keypoints_positions</span><span class="p">:</span> <span class="n">Array</span>
</span><span id="FeatureTrackData-73"><a href="#FeatureTrackData-73"><span class="linenos"> 73</span></a>    <span class="n">keypoint_visibility</span><span class="p">:</span> <span class="n">Array</span>
</span><span id="FeatureTrackData-74"><a href="#FeatureTrackData-74"><span class="linenos"> 74</span></a>    <span class="n">camera_intrinsics</span><span class="p">:</span> <span class="n">Array</span>
</span><span id="FeatureTrackData-75"><a href="#FeatureTrackData-75"><span class="linenos"> 75</span></a>    <span class="n">rgbd_images</span><span class="p">:</span> <span class="n">Array</span>
</span><span id="FeatureTrackData-76"><a href="#FeatureTrackData-76"><span class="linenos"> 76</span></a>    <span class="c1"># Optional fields: Ground truth data</span>
</span><span id="FeatureTrackData-77"><a href="#FeatureTrackData-77"><span class="linenos"> 77</span></a>    <span class="n">fps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-78"><a href="#FeatureTrackData-78"><span class="linenos"> 78</span></a>    <span class="n">observed_features</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-79"><a href="#FeatureTrackData-79"><span class="linenos"> 79</span></a>    <span class="n">latent_keypoint_positions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-80"><a href="#FeatureTrackData-80"><span class="linenos"> 80</span></a>    <span class="n">latent_keypoint_quaternions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-81"><a href="#FeatureTrackData-81"><span class="linenos"> 81</span></a>    <span class="n">object_assignments</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-82"><a href="#FeatureTrackData-82"><span class="linenos"> 82</span></a>    <span class="n">camera_position</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-83"><a href="#FeatureTrackData-83"><span class="linenos"> 83</span></a>    <span class="n">camera_quaternion</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-84"><a href="#FeatureTrackData-84"><span class="linenos"> 84</span></a>
</span><span id="FeatureTrackData-85"><a href="#FeatureTrackData-85"><span class="linenos"> 85</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="FeatureTrackData-86"><a href="#FeatureTrackData-86"><span class="linenos"> 86</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FeatureTrackData-87"><a href="#FeatureTrackData-87"><span class="linenos"> 87</span></a>        <span class="n">observed_keypoints_positions</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
</span><span id="FeatureTrackData-88"><a href="#FeatureTrackData-88"><span class="linenos"> 88</span></a>        <span class="n">keypoint_visibility</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
</span><span id="FeatureTrackData-89"><a href="#FeatureTrackData-89"><span class="linenos"> 89</span></a>        <span class="n">rgbd_images</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
</span><span id="FeatureTrackData-90"><a href="#FeatureTrackData-90"><span class="linenos"> 90</span></a>        <span class="n">camera_intrinsics</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
</span><span id="FeatureTrackData-91"><a href="#FeatureTrackData-91"><span class="linenos"> 91</span></a>        <span class="n">fps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-92"><a href="#FeatureTrackData-92"><span class="linenos"> 92</span></a>        <span class="n">observed_features</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-93"><a href="#FeatureTrackData-93"><span class="linenos"> 93</span></a>        <span class="n">latent_keypoint_positions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-94"><a href="#FeatureTrackData-94"><span class="linenos"> 94</span></a>        <span class="n">latent_keypoint_quaternions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-95"><a href="#FeatureTrackData-95"><span class="linenos"> 95</span></a>        <span class="n">object_assignments</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-96"><a href="#FeatureTrackData-96"><span class="linenos"> 96</span></a>        <span class="n">camera_position</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-97"><a href="#FeatureTrackData-97"><span class="linenos"> 97</span></a>        <span class="n">camera_quaternion</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-98"><a href="#FeatureTrackData-98"><span class="linenos"> 98</span></a>    <span class="p">):</span>
</span><span id="FeatureTrackData-99"><a href="#FeatureTrackData-99"><span class="linenos"> 99</span></a>        <span class="k">if</span> <span class="n">rgbd_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="FeatureTrackData-100"><a href="#FeatureTrackData-100"><span class="linenos">100</span></a>            <span class="n">rgbd_images</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="FeatureTrackData-101"><a href="#FeatureTrackData-101"><span class="linenos">101</span></a>                <span class="p">[</span><span class="n">rgbd_images</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">rgbd_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span>
</span><span id="FeatureTrackData-102"><a href="#FeatureTrackData-102"><span class="linenos">102</span></a>            <span class="p">)</span>
</span><span id="FeatureTrackData-103"><a href="#FeatureTrackData-103"><span class="linenos">103</span></a>
</span><span id="FeatureTrackData-104"><a href="#FeatureTrackData-104"><span class="linenos">104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fps</span> <span class="o">=</span> <span class="n">fps</span>
</span><span id="FeatureTrackData-105"><a href="#FeatureTrackData-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span> <span class="o">=</span> <span class="n">observed_keypoints_positions</span>
</span><span id="FeatureTrackData-106"><a href="#FeatureTrackData-106"><span class="linenos">106</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span> <span class="o">=</span> <span class="n">observed_features</span>
</span><span id="FeatureTrackData-107"><a href="#FeatureTrackData-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span> <span class="o">=</span> <span class="n">keypoint_visibility</span>
</span><span id="FeatureTrackData-108"><a href="#FeatureTrackData-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics</span> <span class="o">=</span> <span class="n">camera_intrinsics</span>
</span><span id="FeatureTrackData-109"><a href="#FeatureTrackData-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span> <span class="o">=</span> <span class="n">rgbd_images</span>
</span><span id="FeatureTrackData-110"><a href="#FeatureTrackData-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span> <span class="o">=</span> <span class="n">latent_keypoint_positions</span>
</span><span id="FeatureTrackData-111"><a href="#FeatureTrackData-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span> <span class="o">=</span> <span class="n">latent_keypoint_quaternions</span>
</span><span id="FeatureTrackData-112"><a href="#FeatureTrackData-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">object_assignments</span> <span class="o">=</span> <span class="n">object_assignments</span>
</span><span id="FeatureTrackData-113"><a href="#FeatureTrackData-113"><span class="linenos">113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span> <span class="o">=</span> <span class="n">camera_position</span>
</span><span id="FeatureTrackData-114"><a href="#FeatureTrackData-114"><span class="linenos">114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span> <span class="o">=</span> <span class="n">camera_quaternion</span>
</span><span id="FeatureTrackData-115"><a href="#FeatureTrackData-115"><span class="linenos">115</span></a>
</span><span id="FeatureTrackData-116"><a href="#FeatureTrackData-116"><span class="linenos">116</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData-117"><a href="#FeatureTrackData-117"><span class="linenos">117</span></a>    <span class="k">def</span> <span class="nf">num_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData-118"><a href="#FeatureTrackData-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FeatureTrackData-119"><a href="#FeatureTrackData-119"><span class="linenos">119</span></a>
</span><span id="FeatureTrackData-120"><a href="#FeatureTrackData-120"><span class="linenos">120</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData-121"><a href="#FeatureTrackData-121"><span class="linenos">121</span></a>    <span class="k">def</span> <span class="nf">num_keypoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData-122"><a href="#FeatureTrackData-122"><span class="linenos">122</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="FeatureTrackData-123"><a href="#FeatureTrackData-123"><span class="linenos">123</span></a>
</span><span id="FeatureTrackData-124"><a href="#FeatureTrackData-124"><span class="linenos">124</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData-125"><a href="#FeatureTrackData-125"><span class="linenos">125</span></a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData-126"><a href="#FeatureTrackData-126"><span class="linenos">126</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_frames</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_keypoints</span><span class="p">)</span>
</span><span id="FeatureTrackData-127"><a href="#FeatureTrackData-127"><span class="linenos">127</span></a>
</span><span id="FeatureTrackData-128"><a href="#FeatureTrackData-128"><span class="linenos">128</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData-129"><a href="#FeatureTrackData-129"><span class="linenos">129</span></a>    <span class="k">def</span> <span class="nf">uv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData-130"><a href="#FeatureTrackData-130"><span class="linenos">130</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span>
</span><span id="FeatureTrackData-131"><a href="#FeatureTrackData-131"><span class="linenos">131</span></a>
</span><span id="FeatureTrackData-132"><a href="#FeatureTrackData-132"><span class="linenos">132</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData-133"><a href="#FeatureTrackData-133"><span class="linenos">133</span></a>    <span class="k">def</span> <span class="nf">vis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData-134"><a href="#FeatureTrackData-134"><span class="linenos">134</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visibility</span>
</span><span id="FeatureTrackData-135"><a href="#FeatureTrackData-135"><span class="linenos">135</span></a>
</span><span id="FeatureTrackData-136"><a href="#FeatureTrackData-136"><span class="linenos">136</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData-137"><a href="#FeatureTrackData-137"><span class="linenos">137</span></a>    <span class="k">def</span> <span class="nf">rgb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData-138"><a href="#FeatureTrackData-138"><span class="linenos">138</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</span><span id="FeatureTrackData-139"><a href="#FeatureTrackData-139"><span class="linenos">139</span></a>
</span><span id="FeatureTrackData-140"><a href="#FeatureTrackData-140"><span class="linenos">140</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData-141"><a href="#FeatureTrackData-141"><span class="linenos">141</span></a>    <span class="k">def</span> <span class="nf">visibility</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData-142"><a href="#FeatureTrackData-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span>
</span><span id="FeatureTrackData-143"><a href="#FeatureTrackData-143"><span class="linenos">143</span></a>
</span><span id="FeatureTrackData-144"><a href="#FeatureTrackData-144"><span class="linenos">144</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData-145"><a href="#FeatureTrackData-145"><span class="linenos">145</span></a>    <span class="k">def</span> <span class="nf">rgbd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData-146"><a href="#FeatureTrackData-146"><span class="linenos">146</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span>
</span><span id="FeatureTrackData-147"><a href="#FeatureTrackData-147"><span class="linenos">147</span></a>
</span><span id="FeatureTrackData-148"><a href="#FeatureTrackData-148"><span class="linenos">148</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData-149"><a href="#FeatureTrackData-149"><span class="linenos">149</span></a>    <span class="k">def</span> <span class="nf">camera_poses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData-150"><a href="#FeatureTrackData-150"><span class="linenos">150</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span><span class="p">)</span>
</span><span id="FeatureTrackData-151"><a href="#FeatureTrackData-151"><span class="linenos">151</span></a>
</span><span id="FeatureTrackData-152"><a href="#FeatureTrackData-152"><span class="linenos">152</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData-153"><a href="#FeatureTrackData-153"><span class="linenos">153</span></a>    <span class="k">def</span> <span class="nf">intrinsics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData-154"><a href="#FeatureTrackData-154"><span class="linenos">154</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns camera intrinsics as an Intrinsics object&quot;&quot;&quot;</span>
</span><span id="FeatureTrackData-155"><a href="#FeatureTrackData-155"><span class="linenos">155</span></a>        <span class="k">return</span> <span class="n">Intrinsics</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics</span><span class="p">)</span>
</span><span id="FeatureTrackData-156"><a href="#FeatureTrackData-156"><span class="linenos">156</span></a>
</span><span id="FeatureTrackData-157"><a href="#FeatureTrackData-157"><span class="linenos">157</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData-158"><a href="#FeatureTrackData-158"><span class="linenos">158</span></a>        <span class="k">return</span> <span class="n">DESCR</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</span><span id="FeatureTrackData-159"><a href="#FeatureTrackData-159"><span class="linenos">159</span></a>
</span><span id="FeatureTrackData-160"><a href="#FeatureTrackData-160"><span class="linenos">160</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData-161"><a href="#FeatureTrackData-161"><span class="linenos">161</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</span><span id="FeatureTrackData-162"><a href="#FeatureTrackData-162"><span class="linenos">162</span></a>
</span><span id="FeatureTrackData-163"><a href="#FeatureTrackData-163"><span class="linenos">163</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="FeatureTrackData-164"><a href="#FeatureTrackData-164"><span class="linenos">164</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves input to file&quot;&quot;&quot;</span>
</span><span id="FeatureTrackData-165"><a href="#FeatureTrackData-165"><span class="linenos">165</span></a>        <span class="n">to_save</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="FeatureTrackData-166"><a href="#FeatureTrackData-166"><span class="linenos">166</span></a>            <span class="n">latent_keypoint_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span><span class="p">,</span>
</span><span id="FeatureTrackData-167"><a href="#FeatureTrackData-167"><span class="linenos">167</span></a>            <span class="n">latent_keypoint_quaternions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span><span class="p">,</span>
</span><span id="FeatureTrackData-168"><a href="#FeatureTrackData-168"><span class="linenos">168</span></a>            <span class="n">observed_keypoints_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="p">,</span>
</span><span id="FeatureTrackData-169"><a href="#FeatureTrackData-169"><span class="linenos">169</span></a>            <span class="n">observed_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span><span class="p">,</span>
</span><span id="FeatureTrackData-170"><a href="#FeatureTrackData-170"><span class="linenos">170</span></a>            <span class="n">rgbd_images</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span><span class="p">,</span>
</span><span id="FeatureTrackData-171"><a href="#FeatureTrackData-171"><span class="linenos">171</span></a>            <span class="n">fps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="p">,</span>
</span><span id="FeatureTrackData-172"><a href="#FeatureTrackData-172"><span class="linenos">172</span></a>            <span class="n">keypoint_visibility</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span><span class="p">,</span>
</span><span id="FeatureTrackData-173"><a href="#FeatureTrackData-173"><span class="linenos">173</span></a>            <span class="n">object_assignments</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object_assignments</span><span class="p">,</span>
</span><span id="FeatureTrackData-174"><a href="#FeatureTrackData-174"><span class="linenos">174</span></a>            <span class="n">camera_position</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span><span class="p">,</span>
</span><span id="FeatureTrackData-175"><a href="#FeatureTrackData-175"><span class="linenos">175</span></a>            <span class="n">camera_quaternion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span><span class="p">,</span>
</span><span id="FeatureTrackData-176"><a href="#FeatureTrackData-176"><span class="linenos">176</span></a>            <span class="n">camera_intrinsics</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics</span><span class="p">,</span>
</span><span id="FeatureTrackData-177"><a href="#FeatureTrackData-177"><span class="linenos">177</span></a>        <span class="p">)</span>
</span><span id="FeatureTrackData-178"><a href="#FeatureTrackData-178"><span class="linenos">178</span></a>        <span class="n">to_save</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">to_save</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>
</span><span id="FeatureTrackData-179"><a href="#FeatureTrackData-179"><span class="linenos">179</span></a>        <span class="n">jnp</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="o">**</span><span class="n">to_save</span><span class="p">)</span>
</span><span id="FeatureTrackData-180"><a href="#FeatureTrackData-180"><span class="linenos">180</span></a>
</span><span id="FeatureTrackData-181"><a href="#FeatureTrackData-181"><span class="linenos">181</span></a>    <span class="nd">@classmethod</span>
</span><span id="FeatureTrackData-182"><a href="#FeatureTrackData-182"><span class="linenos">182</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="FeatureTrackData-183"><a href="#FeatureTrackData-183"><span class="linenos">183</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads input from file&quot;&quot;&quot;</span>
</span><span id="FeatureTrackData-184"><a href="#FeatureTrackData-184"><span class="linenos">184</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="FeatureTrackData-185"><a href="#FeatureTrackData-185"><span class="linenos">185</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="FeatureTrackData-186"><a href="#FeatureTrackData-186"><span class="linenos">186</span></a>
</span><span id="FeatureTrackData-187"><a href="#FeatureTrackData-187"><span class="linenos">187</span></a>            <span class="k">def</span> <span class="nf">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span><span id="FeatureTrackData-188"><a href="#FeatureTrackData-188"><span class="linenos">188</span></a>                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span><span id="FeatureTrackData-189"><a href="#FeatureTrackData-189"><span class="linenos">189</span></a>                    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="FeatureTrackData-190"><a href="#FeatureTrackData-190"><span class="linenos">190</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="FeatureTrackData-191"><a href="#FeatureTrackData-191"><span class="linenos">191</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-192"><a href="#FeatureTrackData-192"><span class="linenos">192</span></a>
</span><span id="FeatureTrackData-193"><a href="#FeatureTrackData-193"><span class="linenos">193</span></a>            <span class="c1"># Handle loading from either the current `rgbd_images`</span>
</span><span id="FeatureTrackData-194"><a href="#FeatureTrackData-194"><span class="linenos">194</span></a>            <span class="c1"># format, or from the older `rgb_images` + maybe `xyz` format.</span>
</span><span id="FeatureTrackData-195"><a href="#FeatureTrackData-195"><span class="linenos">195</span></a>            <span class="n">rgbd_images</span> <span class="o">=</span> <span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;rgbd_images&quot;</span><span class="p">)</span>
</span><span id="FeatureTrackData-196"><a href="#FeatureTrackData-196"><span class="linenos">196</span></a>            <span class="k">if</span> <span class="n">rgbd_images</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FeatureTrackData-197"><a href="#FeatureTrackData-197"><span class="linenos">197</span></a>                <span class="n">rgb_imgs</span> <span class="o">=</span> <span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;rgb_imgs&quot;</span><span class="p">)</span>
</span><span id="FeatureTrackData-198"><a href="#FeatureTrackData-198"><span class="linenos">198</span></a>                <span class="k">assert</span> <span class="p">(</span>
</span><span id="FeatureTrackData-199"><a href="#FeatureTrackData-199"><span class="linenos">199</span></a>                    <span class="n">rgb_imgs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-200"><a href="#FeatureTrackData-200"><span class="linenos">200</span></a>                <span class="p">),</span> <span class="s2">&quot;One of rgbd_images or rgb_imgs must be provided.&quot;</span>
</span><span id="FeatureTrackData-201"><a href="#FeatureTrackData-201"><span class="linenos">201</span></a>                <span class="n">xyz</span> <span class="o">=</span> <span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;xyz&quot;</span><span class="p">)</span>
</span><span id="FeatureTrackData-202"><a href="#FeatureTrackData-202"><span class="linenos">202</span></a>                <span class="k">if</span> <span class="n">xyz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FeatureTrackData-203"><a href="#FeatureTrackData-203"><span class="linenos">203</span></a>                    <span class="n">rgbd_images</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">rgb_imgs</span><span class="p">,</span> <span class="n">xyz</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">:]],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="FeatureTrackData-204"><a href="#FeatureTrackData-204"><span class="linenos">204</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="FeatureTrackData-205"><a href="#FeatureTrackData-205"><span class="linenos">205</span></a>                    <span class="n">rgbd_images</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="FeatureTrackData-206"><a href="#FeatureTrackData-206"><span class="linenos">206</span></a>                        <span class="p">[</span><span class="n">rgb_imgs</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">rgb_imgs</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span>
</span><span id="FeatureTrackData-207"><a href="#FeatureTrackData-207"><span class="linenos">207</span></a>                    <span class="p">)</span>
</span><span id="FeatureTrackData-208"><a href="#FeatureTrackData-208"><span class="linenos">208</span></a>
</span><span id="FeatureTrackData-209"><a href="#FeatureTrackData-209"><span class="linenos">209</span></a>            <span class="c1"># Also handle loading from either the current `keypoint_visibility`</span>
</span><span id="FeatureTrackData-210"><a href="#FeatureTrackData-210"><span class="linenos">210</span></a>            <span class="c1"># format, or from the older `latent_keypoint_visibility` format.</span>
</span><span id="FeatureTrackData-211"><a href="#FeatureTrackData-211"><span class="linenos">211</span></a>            <span class="n">keypoint_visibility</span> <span class="o">=</span> <span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;keypoint_visibility&quot;</span><span class="p">)</span>
</span><span id="FeatureTrackData-212"><a href="#FeatureTrackData-212"><span class="linenos">212</span></a>            <span class="k">if</span> <span class="n">keypoint_visibility</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FeatureTrackData-213"><a href="#FeatureTrackData-213"><span class="linenos">213</span></a>                <span class="n">keypoint_visibility</span> <span class="o">=</span> <span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;latent_keypoint_visibility&quot;</span><span class="p">)</span>
</span><span id="FeatureTrackData-214"><a href="#FeatureTrackData-214"><span class="linenos">214</span></a>
</span><span id="FeatureTrackData-215"><a href="#FeatureTrackData-215"><span class="linenos">215</span></a>            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="FeatureTrackData-216"><a href="#FeatureTrackData-216"><span class="linenos">216</span></a>                <span class="n">latent_keypoint_positions</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span>
</span><span id="FeatureTrackData-217"><a href="#FeatureTrackData-217"><span class="linenos">217</span></a>                    <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;latent_keypoint_positions&quot;</span>
</span><span id="FeatureTrackData-218"><a href="#FeatureTrackData-218"><span class="linenos">218</span></a>                <span class="p">),</span>
</span><span id="FeatureTrackData-219"><a href="#FeatureTrackData-219"><span class="linenos">219</span></a>                <span class="n">latent_keypoint_quaternions</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span>
</span><span id="FeatureTrackData-220"><a href="#FeatureTrackData-220"><span class="linenos">220</span></a>                    <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;latent_keypoint_quaternions&quot;</span>
</span><span id="FeatureTrackData-221"><a href="#FeatureTrackData-221"><span class="linenos">221</span></a>                <span class="p">),</span>
</span><span id="FeatureTrackData-222"><a href="#FeatureTrackData-222"><span class="linenos">222</span></a>                <span class="n">observed_keypoints_positions</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span>
</span><span id="FeatureTrackData-223"><a href="#FeatureTrackData-223"><span class="linenos">223</span></a>                    <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;observed_keypoints_positions&quot;</span>
</span><span id="FeatureTrackData-224"><a href="#FeatureTrackData-224"><span class="linenos">224</span></a>                <span class="p">),</span>
</span><span id="FeatureTrackData-225"><a href="#FeatureTrackData-225"><span class="linenos">225</span></a>                <span class="n">observed_features</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;observed_features&quot;</span><span class="p">),</span>
</span><span id="FeatureTrackData-226"><a href="#FeatureTrackData-226"><span class="linenos">226</span></a>                <span class="n">rgbd_images</span><span class="o">=</span><span class="n">rgbd_images</span><span class="p">,</span>
</span><span id="FeatureTrackData-227"><a href="#FeatureTrackData-227"><span class="linenos">227</span></a>                <span class="n">keypoint_visibility</span><span class="o">=</span><span class="n">keypoint_visibility</span><span class="p">,</span>
</span><span id="FeatureTrackData-228"><a href="#FeatureTrackData-228"><span class="linenos">228</span></a>                <span class="n">fps</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;fps&quot;</span><span class="p">),</span>
</span><span id="FeatureTrackData-229"><a href="#FeatureTrackData-229"><span class="linenos">229</span></a>                <span class="n">object_assignments</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;object_assignments&quot;</span><span class="p">),</span>
</span><span id="FeatureTrackData-230"><a href="#FeatureTrackData-230"><span class="linenos">230</span></a>                <span class="n">camera_position</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;camera_position&quot;</span><span class="p">),</span>
</span><span id="FeatureTrackData-231"><a href="#FeatureTrackData-231"><span class="linenos">231</span></a>                <span class="n">camera_quaternion</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;camera_quaternion&quot;</span><span class="p">),</span>
</span><span id="FeatureTrackData-232"><a href="#FeatureTrackData-232"><span class="linenos">232</span></a>                <span class="n">camera_intrinsics</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;camera_intrinsics&quot;</span><span class="p">),</span>
</span><span id="FeatureTrackData-233"><a href="#FeatureTrackData-233"><span class="linenos">233</span></a>            <span class="p">)</span>
</span><span id="FeatureTrackData-234"><a href="#FeatureTrackData-234"><span class="linenos">234</span></a>
</span><span id="FeatureTrackData-235"><a href="#FeatureTrackData-235"><span class="linenos">235</span></a>    <span class="k">def</span> <span class="nf">slice_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_frame</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_frame</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="FeatureTrackData-236"><a href="#FeatureTrackData-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Slices data in time.&quot;&quot;&quot;</span>
</span><span id="FeatureTrackData-237"><a href="#FeatureTrackData-237"><span class="linenos">237</span></a>        <span class="k">if</span> <span class="n">start_frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FeatureTrackData-238"><a href="#FeatureTrackData-238"><span class="linenos">238</span></a>            <span class="n">start_frame</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="FeatureTrackData-239"><a href="#FeatureTrackData-239"><span class="linenos">239</span></a>        <span class="k">if</span> <span class="n">end_frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FeatureTrackData-240"><a href="#FeatureTrackData-240"><span class="linenos">240</span></a>            <span class="n">end_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FeatureTrackData-241"><a href="#FeatureTrackData-241"><span class="linenos">241</span></a>        <span class="k">return</span> <span class="n">FeatureTrackData</span><span class="p">(</span>
</span><span id="FeatureTrackData-242"><a href="#FeatureTrackData-242"><span class="linenos">242</span></a>            <span class="n">observed_keypoints_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="p">[</span>
</span><span id="FeatureTrackData-243"><a href="#FeatureTrackData-243"><span class="linenos">243</span></a>                <span class="n">start_frame</span><span class="p">:</span><span class="n">end_frame</span>
</span><span id="FeatureTrackData-244"><a href="#FeatureTrackData-244"><span class="linenos">244</span></a>            <span class="p">],</span>
</span><span id="FeatureTrackData-245"><a href="#FeatureTrackData-245"><span class="linenos">245</span></a>            <span class="n">observed_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span><span class="p">[</span><span class="n">start_frame</span><span class="p">:</span><span class="n">end_frame</span><span class="p">]</span>
</span><span id="FeatureTrackData-246"><a href="#FeatureTrackData-246"><span class="linenos">246</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-247"><a href="#FeatureTrackData-247"><span class="linenos">247</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-248"><a href="#FeatureTrackData-248"><span class="linenos">248</span></a>            <span class="n">keypoint_visibility</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span><span class="p">[</span><span class="n">start_frame</span><span class="p">:</span><span class="n">end_frame</span><span class="p">],</span>
</span><span id="FeatureTrackData-249"><a href="#FeatureTrackData-249"><span class="linenos">249</span></a>            <span class="n">rgbd_images</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span><span class="p">[</span><span class="n">start_frame</span><span class="p">:</span><span class="n">end_frame</span><span class="p">],</span>
</span><span id="FeatureTrackData-250"><a href="#FeatureTrackData-250"><span class="linenos">250</span></a>            <span class="n">latent_keypoint_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span><span class="p">[</span>
</span><span id="FeatureTrackData-251"><a href="#FeatureTrackData-251"><span class="linenos">251</span></a>                <span class="n">start_frame</span><span class="p">:</span><span class="n">end_frame</span>
</span><span id="FeatureTrackData-252"><a href="#FeatureTrackData-252"><span class="linenos">252</span></a>            <span class="p">]</span>
</span><span id="FeatureTrackData-253"><a href="#FeatureTrackData-253"><span class="linenos">253</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-254"><a href="#FeatureTrackData-254"><span class="linenos">254</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-255"><a href="#FeatureTrackData-255"><span class="linenos">255</span></a>            <span class="n">latent_keypoint_quaternions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span><span class="p">[</span>
</span><span id="FeatureTrackData-256"><a href="#FeatureTrackData-256"><span class="linenos">256</span></a>                <span class="n">start_frame</span><span class="p">:</span><span class="n">end_frame</span>
</span><span id="FeatureTrackData-257"><a href="#FeatureTrackData-257"><span class="linenos">257</span></a>            <span class="p">]</span>
</span><span id="FeatureTrackData-258"><a href="#FeatureTrackData-258"><span class="linenos">258</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-259"><a href="#FeatureTrackData-259"><span class="linenos">259</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-260"><a href="#FeatureTrackData-260"><span class="linenos">260</span></a>            <span class="n">object_assignments</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object_assignments</span><span class="p">,</span>
</span><span id="FeatureTrackData-261"><a href="#FeatureTrackData-261"><span class="linenos">261</span></a>            <span class="n">camera_position</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span><span class="p">[</span><span class="n">start_frame</span><span class="p">:</span><span class="n">end_frame</span><span class="p">]</span>
</span><span id="FeatureTrackData-262"><a href="#FeatureTrackData-262"><span class="linenos">262</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-263"><a href="#FeatureTrackData-263"><span class="linenos">263</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-264"><a href="#FeatureTrackData-264"><span class="linenos">264</span></a>            <span class="n">camera_quaternion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span><span class="p">[</span><span class="n">start_frame</span><span class="p">:</span><span class="n">end_frame</span><span class="p">]</span>
</span><span id="FeatureTrackData-265"><a href="#FeatureTrackData-265"><span class="linenos">265</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-266"><a href="#FeatureTrackData-266"><span class="linenos">266</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-267"><a href="#FeatureTrackData-267"><span class="linenos">267</span></a>            <span class="n">camera_intrinsics</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics</span><span class="p">,</span>
</span><span id="FeatureTrackData-268"><a href="#FeatureTrackData-268"><span class="linenos">268</span></a>            <span class="n">fps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="p">,</span>
</span><span id="FeatureTrackData-269"><a href="#FeatureTrackData-269"><span class="linenos">269</span></a>        <span class="p">)</span>
</span><span id="FeatureTrackData-270"><a href="#FeatureTrackData-270"><span class="linenos">270</span></a>
</span><span id="FeatureTrackData-271"><a href="#FeatureTrackData-271"><span class="linenos">271</span></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData-272"><a href="#FeatureTrackData-272"><span class="linenos">272</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FeatureTrackData-273"><a href="#FeatureTrackData-273"><span class="linenos">273</span></a>
</span><span id="FeatureTrackData-274"><a href="#FeatureTrackData-274"><span class="linenos">274</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="FeatureTrackData-275"><a href="#FeatureTrackData-275"><span class="linenos">275</span></a>        <span class="k">return</span> <span class="n">FeatureTrackData</span><span class="p">(</span>
</span><span id="FeatureTrackData-276"><a href="#FeatureTrackData-276"><span class="linenos">276</span></a>            <span class="n">observed_keypoints_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
</span><span id="FeatureTrackData-277"><a href="#FeatureTrackData-277"><span class="linenos">277</span></a>            <span class="n">observed_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span id="FeatureTrackData-278"><a href="#FeatureTrackData-278"><span class="linenos">278</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-279"><a href="#FeatureTrackData-279"><span class="linenos">279</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-280"><a href="#FeatureTrackData-280"><span class="linenos">280</span></a>            <span class="n">keypoint_visibility</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
</span><span id="FeatureTrackData-281"><a href="#FeatureTrackData-281"><span class="linenos">281</span></a>            <span class="n">rgbd_images</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
</span><span id="FeatureTrackData-282"><a href="#FeatureTrackData-282"><span class="linenos">282</span></a>            <span class="n">latent_keypoint_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span id="FeatureTrackData-283"><a href="#FeatureTrackData-283"><span class="linenos">283</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-284"><a href="#FeatureTrackData-284"><span class="linenos">284</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-285"><a href="#FeatureTrackData-285"><span class="linenos">285</span></a>            <span class="n">latent_keypoint_quaternions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span id="FeatureTrackData-286"><a href="#FeatureTrackData-286"><span class="linenos">286</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-287"><a href="#FeatureTrackData-287"><span class="linenos">287</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-288"><a href="#FeatureTrackData-288"><span class="linenos">288</span></a>            <span class="n">object_assignments</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object_assignments</span><span class="p">,</span>
</span><span id="FeatureTrackData-289"><a href="#FeatureTrackData-289"><span class="linenos">289</span></a>            <span class="n">camera_position</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span id="FeatureTrackData-290"><a href="#FeatureTrackData-290"><span class="linenos">290</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-291"><a href="#FeatureTrackData-291"><span class="linenos">291</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-292"><a href="#FeatureTrackData-292"><span class="linenos">292</span></a>            <span class="n">camera_quaternion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span><span id="FeatureTrackData-293"><a href="#FeatureTrackData-293"><span class="linenos">293</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-294"><a href="#FeatureTrackData-294"><span class="linenos">294</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-295"><a href="#FeatureTrackData-295"><span class="linenos">295</span></a>            <span class="n">camera_intrinsics</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics</span><span class="p">,</span>
</span><span id="FeatureTrackData-296"><a href="#FeatureTrackData-296"><span class="linenos">296</span></a>            <span class="n">fps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="p">,</span>
</span><span id="FeatureTrackData-297"><a href="#FeatureTrackData-297"><span class="linenos">297</span></a>        <span class="p">)</span>
</span><span id="FeatureTrackData-298"><a href="#FeatureTrackData-298"><span class="linenos">298</span></a>
</span><span id="FeatureTrackData-299"><a href="#FeatureTrackData-299"><span class="linenos">299</span></a>    <span class="k">def</span> <span class="nf">downscale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
</span><span id="FeatureTrackData-300"><a href="#FeatureTrackData-300"><span class="linenos">300</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Downscales the rgbd images by the given factor.&quot;&quot;&quot;</span>
</span><span id="FeatureTrackData-301"><a href="#FeatureTrackData-301"><span class="linenos">301</span></a>        <span class="k">assert</span> <span class="p">(</span>
</span><span id="FeatureTrackData-302"><a href="#FeatureTrackData-302"><span class="linenos">302</span></a>            <span class="n">factor</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span> <span class="o">==</span> <span class="n">factor</span>
</span><span id="FeatureTrackData-303"><a href="#FeatureTrackData-303"><span class="linenos">303</span></a>        <span class="p">),</span> <span class="s2">&quot;Factor must be an integer greater than or equal to 1.&quot;</span>
</span><span id="FeatureTrackData-304"><a href="#FeatureTrackData-304"><span class="linenos">304</span></a>        <span class="n">factor</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
</span><span id="FeatureTrackData-305"><a href="#FeatureTrackData-305"><span class="linenos">305</span></a>        <span class="k">if</span> <span class="n">factor</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FeatureTrackData-306"><a href="#FeatureTrackData-306"><span class="linenos">306</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FeatureTrackData-307"><a href="#FeatureTrackData-307"><span class="linenos">307</span></a>
</span><span id="FeatureTrackData-308"><a href="#FeatureTrackData-308"><span class="linenos">308</span></a>        <span class="k">return</span> <span class="n">FeatureTrackData</span><span class="p">(</span>
</span><span id="FeatureTrackData-309"><a href="#FeatureTrackData-309"><span class="linenos">309</span></a>            <span class="n">observed_keypoints_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span> <span class="o">/</span> <span class="n">factor</span><span class="p">,</span>
</span><span id="FeatureTrackData-310"><a href="#FeatureTrackData-310"><span class="linenos">310</span></a>            <span class="n">observed_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span><span class="p">,</span>
</span><span id="FeatureTrackData-311"><a href="#FeatureTrackData-311"><span class="linenos">311</span></a>            <span class="n">keypoint_visibility</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span><span class="p">,</span>
</span><span id="FeatureTrackData-312"><a href="#FeatureTrackData-312"><span class="linenos">312</span></a>            <span class="c1"># TODO: Improve the downscaling procedure for the video.</span>
</span><span id="FeatureTrackData-313"><a href="#FeatureTrackData-313"><span class="linenos">313</span></a>            <span class="n">rgbd_images</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span><span class="p">[:,</span> <span class="p">::</span><span class="n">factor</span><span class="p">,</span> <span class="p">::</span><span class="n">factor</span><span class="p">,</span> <span class="p">:],</span>
</span><span id="FeatureTrackData-314"><a href="#FeatureTrackData-314"><span class="linenos">314</span></a>            <span class="n">latent_keypoint_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span><span class="p">,</span>
</span><span id="FeatureTrackData-315"><a href="#FeatureTrackData-315"><span class="linenos">315</span></a>            <span class="n">latent_keypoint_quaternions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span><span class="p">,</span>
</span><span id="FeatureTrackData-316"><a href="#FeatureTrackData-316"><span class="linenos">316</span></a>            <span class="n">object_assignments</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object_assignments</span><span class="p">,</span>
</span><span id="FeatureTrackData-317"><a href="#FeatureTrackData-317"><span class="linenos">317</span></a>            <span class="n">camera_position</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span><span class="p">,</span>
</span><span id="FeatureTrackData-318"><a href="#FeatureTrackData-318"><span class="linenos">318</span></a>            <span class="n">camera_quaternion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span><span class="p">,</span>
</span><span id="FeatureTrackData-319"><a href="#FeatureTrackData-319"><span class="linenos">319</span></a>            <span class="n">camera_intrinsics</span><span class="o">=</span><span class="n">Intrinsics</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">intrinsics</span><span class="p">)</span>
</span><span id="FeatureTrackData-320"><a href="#FeatureTrackData-320"><span class="linenos">320</span></a>            <span class="o">.</span><span class="n">downscale</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
</span><span id="FeatureTrackData-321"><a href="#FeatureTrackData-321"><span class="linenos">321</span></a>            <span class="o">.</span><span class="n">as_array</span><span class="p">(),</span>
</span><span id="FeatureTrackData-322"><a href="#FeatureTrackData-322"><span class="linenos">322</span></a>        <span class="p">)</span>
</span><span id="FeatureTrackData-323"><a href="#FeatureTrackData-323"><span class="linenos">323</span></a>
</span><span id="FeatureTrackData-324"><a href="#FeatureTrackData-324"><span class="linenos">324</span></a>    <span class="k">def</span> <span class="nf">has_depth_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData-325"><a href="#FeatureTrackData-325"><span class="linenos">325</span></a>        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>
</span><span id="FeatureTrackData-326"><a href="#FeatureTrackData-326"><span class="linenos">326</span></a>
</span><span id="FeatureTrackData-327"><a href="#FeatureTrackData-327"><span class="linenos">327</span></a>    <span class="k">def</span> <span class="nf">remove_points_invisible_at_frame0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData-328"><a href="#FeatureTrackData-328"><span class="linenos">328</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureTrackData-329"><a href="#FeatureTrackData-329"><span class="linenos">329</span></a><span class="sd">        Filter this FeatureTrackData to only include keypoints that are visible at frame 0.</span>
</span><span id="FeatureTrackData-330"><a href="#FeatureTrackData-330"><span class="linenos">330</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureTrackData-331"><a href="#FeatureTrackData-331"><span class="linenos">331</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FeatureTrackData-332"><a href="#FeatureTrackData-332"><span class="linenos">332</span></a>        <span class="k">return</span> <span class="n">FeatureTrackData</span><span class="p">(</span>
</span><span id="FeatureTrackData-333"><a href="#FeatureTrackData-333"><span class="linenos">333</span></a>            <span class="n">observed_keypoints_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="p">[:,</span> <span class="n">mask</span><span class="p">],</span>
</span><span id="FeatureTrackData-334"><a href="#FeatureTrackData-334"><span class="linenos">334</span></a>            <span class="n">observed_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span><span class="p">[:,</span> <span class="n">mask</span><span class="p">]</span>
</span><span id="FeatureTrackData-335"><a href="#FeatureTrackData-335"><span class="linenos">335</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-336"><a href="#FeatureTrackData-336"><span class="linenos">336</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-337"><a href="#FeatureTrackData-337"><span class="linenos">337</span></a>            <span class="n">keypoint_visibility</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span><span class="p">[:,</span> <span class="n">mask</span><span class="p">],</span>
</span><span id="FeatureTrackData-338"><a href="#FeatureTrackData-338"><span class="linenos">338</span></a>            <span class="n">rgbd_images</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span><span class="p">,</span>
</span><span id="FeatureTrackData-339"><a href="#FeatureTrackData-339"><span class="linenos">339</span></a>            <span class="n">latent_keypoint_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span><span class="p">[:,</span> <span class="n">mask</span><span class="p">]</span>
</span><span id="FeatureTrackData-340"><a href="#FeatureTrackData-340"><span class="linenos">340</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-341"><a href="#FeatureTrackData-341"><span class="linenos">341</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-342"><a href="#FeatureTrackData-342"><span class="linenos">342</span></a>            <span class="n">latent_keypoint_quaternions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span><span class="p">[:,</span> <span class="n">mask</span><span class="p">]</span>
</span><span id="FeatureTrackData-343"><a href="#FeatureTrackData-343"><span class="linenos">343</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-344"><a href="#FeatureTrackData-344"><span class="linenos">344</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-345"><a href="#FeatureTrackData-345"><span class="linenos">345</span></a>            <span class="n">object_assignments</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object_assignments</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</span><span id="FeatureTrackData-346"><a href="#FeatureTrackData-346"><span class="linenos">346</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_assignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-347"><a href="#FeatureTrackData-347"><span class="linenos">347</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-348"><a href="#FeatureTrackData-348"><span class="linenos">348</span></a>            <span class="n">camera_position</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span><span class="p">,</span>
</span><span id="FeatureTrackData-349"><a href="#FeatureTrackData-349"><span class="linenos">349</span></a>            <span class="n">camera_quaternion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span><span class="p">,</span>
</span><span id="FeatureTrackData-350"><a href="#FeatureTrackData-350"><span class="linenos">350</span></a>            <span class="n">camera_intrinsics</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics</span><span class="p">,</span>
</span><span id="FeatureTrackData-351"><a href="#FeatureTrackData-351"><span class="linenos">351</span></a>        <span class="p">)</span>
</span><span id="FeatureTrackData-352"><a href="#FeatureTrackData-352"><span class="linenos">352</span></a>
</span><span id="FeatureTrackData-353"><a href="#FeatureTrackData-353"><span class="linenos">353</span></a>    <span class="k">def</span> <span class="nf">all_points_visible_at_frame0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData-354"><a href="#FeatureTrackData-354"><span class="linenos">354</span></a>        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="FeatureTrackData-355"><a href="#FeatureTrackData-355"><span class="linenos">355</span></a>
</span><span id="FeatureTrackData-356"><a href="#FeatureTrackData-356"><span class="linenos">356</span></a>    <span class="k">def</span> <span class="nf">sparsify_points_to_minimum_2D_distance_at_frame0</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_2D_distance</span><span class="p">):</span>
</span><span id="FeatureTrackData-357"><a href="#FeatureTrackData-357"><span class="linenos">357</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureTrackData-358"><a href="#FeatureTrackData-358"><span class="linenos">358</span></a><span class="sd">        Filter the keypoints in this FeatureTrackData object, returning a new</span>
</span><span id="FeatureTrackData-359"><a href="#FeatureTrackData-359"><span class="linenos">359</span></a><span class="sd">        FeatureTrackData in which no two observed keypoints</span>
</span><span id="FeatureTrackData-360"><a href="#FeatureTrackData-360"><span class="linenos">360</span></a><span class="sd">        are closer than `min_2D_distance` pixels in the first frame.</span>
</span><span id="FeatureTrackData-361"><a href="#FeatureTrackData-361"><span class="linenos">361</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureTrackData-362"><a href="#FeatureTrackData-362"><span class="linenos">362</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_points_visible_at_frame0</span><span class="p">(),</span> <span class="s2">&quot;In the current implementation, all keypoints must be visible at frame 0 to filter by minimimum 2D distance.&quot;</span>
</span><span id="FeatureTrackData-363"><a href="#FeatureTrackData-363"><span class="linenos">363</span></a>        <span class="n">valid_indices</span> <span class="o">=</span> <span class="n">get_keypoint_filter</span><span class="p">(</span><span class="n">min_2D_distance</span><span class="p">)(</span>
</span><span id="FeatureTrackData-364"><a href="#FeatureTrackData-364"><span class="linenos">364</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FeatureTrackData-365"><a href="#FeatureTrackData-365"><span class="linenos">365</span></a>        <span class="p">)</span>
</span><span id="FeatureTrackData-366"><a href="#FeatureTrackData-366"><span class="linenos">366</span></a>        <span class="k">return</span> <span class="n">FeatureTrackData</span><span class="p">(</span>
</span><span id="FeatureTrackData-367"><a href="#FeatureTrackData-367"><span class="linenos">367</span></a>            <span class="n">observed_keypoints_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="p">[</span>
</span><span id="FeatureTrackData-368"><a href="#FeatureTrackData-368"><span class="linenos">368</span></a>                <span class="p">:,</span> <span class="n">valid_indices</span><span class="p">,</span> <span class="p">:</span>
</span><span id="FeatureTrackData-369"><a href="#FeatureTrackData-369"><span class="linenos">369</span></a>            <span class="p">],</span>
</span><span id="FeatureTrackData-370"><a href="#FeatureTrackData-370"><span class="linenos">370</span></a>            <span class="n">observed_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span><span class="p">[:,</span> <span class="n">valid_indices</span><span class="p">]</span>
</span><span id="FeatureTrackData-371"><a href="#FeatureTrackData-371"><span class="linenos">371</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-372"><a href="#FeatureTrackData-372"><span class="linenos">372</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-373"><a href="#FeatureTrackData-373"><span class="linenos">373</span></a>            <span class="n">keypoint_visibility</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span><span class="p">[:,</span> <span class="n">valid_indices</span><span class="p">],</span>
</span><span id="FeatureTrackData-374"><a href="#FeatureTrackData-374"><span class="linenos">374</span></a>            <span class="n">rgbd_images</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span><span class="p">,</span>
</span><span id="FeatureTrackData-375"><a href="#FeatureTrackData-375"><span class="linenos">375</span></a>            <span class="n">latent_keypoint_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span><span class="p">[:,</span> <span class="n">valid_indices</span><span class="p">]</span>
</span><span id="FeatureTrackData-376"><a href="#FeatureTrackData-376"><span class="linenos">376</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-377"><a href="#FeatureTrackData-377"><span class="linenos">377</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-378"><a href="#FeatureTrackData-378"><span class="linenos">378</span></a>            <span class="n">latent_keypoint_quaternions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span><span class="p">[</span>
</span><span id="FeatureTrackData-379"><a href="#FeatureTrackData-379"><span class="linenos">379</span></a>                <span class="p">:,</span> <span class="n">valid_indices</span>
</span><span id="FeatureTrackData-380"><a href="#FeatureTrackData-380"><span class="linenos">380</span></a>            <span class="p">]</span>
</span><span id="FeatureTrackData-381"><a href="#FeatureTrackData-381"><span class="linenos">381</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-382"><a href="#FeatureTrackData-382"><span class="linenos">382</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-383"><a href="#FeatureTrackData-383"><span class="linenos">383</span></a>            <span class="n">object_assignments</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object_assignments</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">]</span>
</span><span id="FeatureTrackData-384"><a href="#FeatureTrackData-384"><span class="linenos">384</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_assignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData-385"><a href="#FeatureTrackData-385"><span class="linenos">385</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData-386"><a href="#FeatureTrackData-386"><span class="linenos">386</span></a>            <span class="n">camera_position</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span><span class="p">,</span>
</span><span id="FeatureTrackData-387"><a href="#FeatureTrackData-387"><span class="linenos">387</span></a>            <span class="n">camera_quaternion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span><span class="p">,</span>
</span><span id="FeatureTrackData-388"><a href="#FeatureTrackData-388"><span class="linenos">388</span></a>            <span class="n">camera_intrinsics</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics</span><span class="p">,</span>
</span><span id="FeatureTrackData-389"><a href="#FeatureTrackData-389"><span class="linenos">389</span></a>        <span class="p">)</span>
</span><span id="FeatureTrackData-390"><a href="#FeatureTrackData-390"><span class="linenos">390</span></a>
</span><span id="FeatureTrackData-391"><a href="#FeatureTrackData-391"><span class="linenos">391</span></a>    <span class="k">def</span> <span class="nf">min_2D_distance_at_frame0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData-392"><a href="#FeatureTrackData-392"><span class="linenos">392</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureTrackData-393"><a href="#FeatureTrackData-393"><span class="linenos">393</span></a><span class="sd">        Returns the minimum 2D distance between any two keypoints at frame 0.</span>
</span><span id="FeatureTrackData-394"><a href="#FeatureTrackData-394"><span class="linenos">394</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureTrackData-395"><a href="#FeatureTrackData-395"><span class="linenos">395</span></a>        <span class="n">distances</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
</span><span id="FeatureTrackData-396"><a href="#FeatureTrackData-396"><span class="linenos">396</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="FeatureTrackData-397"><a href="#FeatureTrackData-397"><span class="linenos">397</span></a>            <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">],</span>
</span><span id="FeatureTrackData-398"><a href="#FeatureTrackData-398"><span class="linenos">398</span></a>            <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span id="FeatureTrackData-399"><a href="#FeatureTrackData-399"><span class="linenos">399</span></a>        <span class="p">)</span>
</span><span id="FeatureTrackData-400"><a href="#FeatureTrackData-400"><span class="linenos">400</span></a>        <span class="n">distances</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">distances</span><span class="p">)</span>
</span><span id="FeatureTrackData-401"><a href="#FeatureTrackData-401"><span class="linenos">401</span></a>        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span>
</span><span id="FeatureTrackData-402"><a href="#FeatureTrackData-402"><span class="linenos">402</span></a>
</span><span id="FeatureTrackData-403"><a href="#FeatureTrackData-403"><span class="linenos">403</span></a>    <span class="k">def</span> <span class="nf">quick_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">downsize</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="FeatureTrackData-404"><a href="#FeatureTrackData-404"><span class="linenos">404</span></a>        <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FeatureTrackData-405"><a href="#FeatureTrackData-405"><span class="linenos">405</span></a>            <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">figsize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_frames</span><span class="p">,</span> <span class="n">figsize</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FeatureTrackData-406"><a href="#FeatureTrackData-406"><span class="linenos">406</span></a>
</span><span id="FeatureTrackData-407"><a href="#FeatureTrackData-407"><span class="linenos">407</span></a>        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FeatureTrackData-408"><a href="#FeatureTrackData-408"><span class="linenos">408</span></a>            <span class="n">_fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
</span><span id="FeatureTrackData-409"><a href="#FeatureTrackData-409"><span class="linenos">409</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="FeatureTrackData-410"><a href="#FeatureTrackData-410"><span class="linenos">410</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</span><span id="FeatureTrackData-411"><a href="#FeatureTrackData-411"><span class="linenos">411</span></a>
</span><span id="FeatureTrackData-412"><a href="#FeatureTrackData-412"><span class="linenos">412</span></a>        <span class="n">rgb</span> <span class="o">=</span> <span class="n">downsize_images</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="p">,</span> <span class="n">downsize</span><span class="p">)</span>
</span><span id="FeatureTrackData-413"><a href="#FeatureTrackData-413"><span class="linenos">413</span></a>        <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FeatureTrackData-414"><a href="#FeatureTrackData-414"><span class="linenos">414</span></a>            <span class="n">_h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</span><span id="FeatureTrackData-415"><a href="#FeatureTrackData-415"><span class="linenos">415</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">rgb</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span><span id="FeatureTrackData-416"><a href="#FeatureTrackData-416"><span class="linenos">416</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
</span><span id="FeatureTrackData-417"><a href="#FeatureTrackData-417"><span class="linenos">417</span></a>                <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="FeatureTrackData-418"><a href="#FeatureTrackData-418"><span class="linenos">418</span></a>                    <span class="p">[</span>
</span><span id="FeatureTrackData-419"><a href="#FeatureTrackData-419"><span class="linenos">419</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">uv</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vis</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span> <span class="o">/</span> <span class="n">downsize</span>
</span><span id="FeatureTrackData-420"><a href="#FeatureTrackData-420"><span class="linenos">420</span></a>                        <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t</span> <span class="o">*</span> <span class="n">w</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">downsize</span>
</span><span id="FeatureTrackData-421"><a href="#FeatureTrackData-421"><span class="linenos">421</span></a>                        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_frames</span><span class="p">)</span>
</span><span id="FeatureTrackData-422"><a href="#FeatureTrackData-422"><span class="linenos">422</span></a>                    <span class="p">]</span>
</span><span id="FeatureTrackData-423"><a href="#FeatureTrackData-423"><span class="linenos">423</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="FeatureTrackData-424"><a href="#FeatureTrackData-424"><span class="linenos">424</span></a>                <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="FeatureTrackData-425"><a href="#FeatureTrackData-425"><span class="linenos">425</span></a>            <span class="p">)</span>
</span><span id="FeatureTrackData-426"><a href="#FeatureTrackData-426"><span class="linenos">426</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FeatureTrackData-427"><a href="#FeatureTrackData-427"><span class="linenos">427</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">/</span> <span class="mi">255</span><span class="p">)</span>
</span><span id="FeatureTrackData-428"><a href="#FeatureTrackData-428"><span class="linenos">428</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uv</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vis</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span> <span class="o">/</span> <span class="n">downsize</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Feature track data class. Note: Spatial units are measured in meters.</p>

<p>Args:
        observed_keypoints_positions: (T, N, 2) Float Array; 2D points stored as [x, y]
        keypoint_visibility:          (T, N) Boolean Array
        camera_intrinsics:            (8,) Float Array of camera intrinsics, see <code>camera.py</code>.
        rgbd_images:                  (T, H, W, 4) Float Array
        (optional) fps:                          Float
        (optional) observed_features :           (T, N, F) Float Array OR None
        (optional) latent_keypoint_positions :   (T, N, 3) Float Array OR None
        (optional) latent_keypoint_quaternions : (T, N, 4) Float Array OR None
        (optional) object_assignments:           (N,) Int Array OR None
        (optional) camera_position:              (T, 3) Float Array OR None
        (optional) camera_quaternion:            (T, 4) Float Array OR None</p>

<p>Example:</p>

<pre><code># Initialize
data = FeatureTrackData(
    observed_keypoints_positions = uv,
    keypoint_visibility = vis,
    camera_intrinsics = intr,
    rgbd_images = rgb_or_rgbd)

# Save and load
fname = "_temp.npz"
data.save(fname)
data = <a href="#FeatureTrackData.load">FeatureTrackData.load</a>(fname)

# Quick access
uv   = data.uv
vis  = data.vis
rgb  = data.rgb
rgbd = data.rgbd
intr = data.intrinsics
cams = data.camera_poses
</code></pre>

<p><a href="#FeatureTrackData.load">FeatureTrackData.load</a> also supports
(1) Loading from npz files with a <code>rgb_imgs</code> field instead of <code><a href="#FeatureTrackData.rgbd_images">rgbd_images</a></code>.
    In this case, the loader also looks for a <code>xyz</code> field to complete the <code><a href="#FeatureTrackData.rgbd_images">rgbd_images</a></code>;
    if none is found, the depth channel is set to zeros.
(2) Loading from npz files with a <code>latent_keypoint_visibility</code> field instead of <code><a href="#FeatureTrackData.keypoint_visibility">keypoint_visibility</a></code>.</p>
</div>


                            <div id="FeatureTrackData.__init__" class="classattr">
                                        <input id="FeatureTrackData.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="name">FeatureTrackData</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">observed_keypoints_positions</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span>,</span><span class="param">	<span class="n">keypoint_visibility</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span>,</span><span class="param">	<span class="n">rgbd_images</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span>,</span><span class="param">	<span class="n">camera_intrinsics</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span>,</span><span class="param">	<span class="n">fps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">observed_features</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">latent_keypoint_positions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">latent_keypoint_quaternions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">object_assignments</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">camera_position</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">camera_quaternion</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="FeatureTrackData.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.__init__-85"><a href="#FeatureTrackData.__init__-85"><span class="linenos"> 85</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="FeatureTrackData.__init__-86"><a href="#FeatureTrackData.__init__-86"><span class="linenos"> 86</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="FeatureTrackData.__init__-87"><a href="#FeatureTrackData.__init__-87"><span class="linenos"> 87</span></a>        <span class="n">observed_keypoints_positions</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
</span><span id="FeatureTrackData.__init__-88"><a href="#FeatureTrackData.__init__-88"><span class="linenos"> 88</span></a>        <span class="n">keypoint_visibility</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
</span><span id="FeatureTrackData.__init__-89"><a href="#FeatureTrackData.__init__-89"><span class="linenos"> 89</span></a>        <span class="n">rgbd_images</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
</span><span id="FeatureTrackData.__init__-90"><a href="#FeatureTrackData.__init__-90"><span class="linenos"> 90</span></a>        <span class="n">camera_intrinsics</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
</span><span id="FeatureTrackData.__init__-91"><a href="#FeatureTrackData.__init__-91"><span class="linenos"> 91</span></a>        <span class="n">fps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.__init__-92"><a href="#FeatureTrackData.__init__-92"><span class="linenos"> 92</span></a>        <span class="n">observed_features</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.__init__-93"><a href="#FeatureTrackData.__init__-93"><span class="linenos"> 93</span></a>        <span class="n">latent_keypoint_positions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.__init__-94"><a href="#FeatureTrackData.__init__-94"><span class="linenos"> 94</span></a>        <span class="n">latent_keypoint_quaternions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.__init__-95"><a href="#FeatureTrackData.__init__-95"><span class="linenos"> 95</span></a>        <span class="n">object_assignments</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.__init__-96"><a href="#FeatureTrackData.__init__-96"><span class="linenos"> 96</span></a>        <span class="n">camera_position</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.__init__-97"><a href="#FeatureTrackData.__init__-97"><span class="linenos"> 97</span></a>        <span class="n">camera_quaternion</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Array</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.__init__-98"><a href="#FeatureTrackData.__init__-98"><span class="linenos"> 98</span></a>    <span class="p">):</span>
</span><span id="FeatureTrackData.__init__-99"><a href="#FeatureTrackData.__init__-99"><span class="linenos"> 99</span></a>        <span class="k">if</span> <span class="n">rgbd_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="FeatureTrackData.__init__-100"><a href="#FeatureTrackData.__init__-100"><span class="linenos">100</span></a>            <span class="n">rgbd_images</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="FeatureTrackData.__init__-101"><a href="#FeatureTrackData.__init__-101"><span class="linenos">101</span></a>                <span class="p">[</span><span class="n">rgbd_images</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">rgbd_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span>
</span><span id="FeatureTrackData.__init__-102"><a href="#FeatureTrackData.__init__-102"><span class="linenos">102</span></a>            <span class="p">)</span>
</span><span id="FeatureTrackData.__init__-103"><a href="#FeatureTrackData.__init__-103"><span class="linenos">103</span></a>
</span><span id="FeatureTrackData.__init__-104"><a href="#FeatureTrackData.__init__-104"><span class="linenos">104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fps</span> <span class="o">=</span> <span class="n">fps</span>
</span><span id="FeatureTrackData.__init__-105"><a href="#FeatureTrackData.__init__-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span> <span class="o">=</span> <span class="n">observed_keypoints_positions</span>
</span><span id="FeatureTrackData.__init__-106"><a href="#FeatureTrackData.__init__-106"><span class="linenos">106</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span> <span class="o">=</span> <span class="n">observed_features</span>
</span><span id="FeatureTrackData.__init__-107"><a href="#FeatureTrackData.__init__-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span> <span class="o">=</span> <span class="n">keypoint_visibility</span>
</span><span id="FeatureTrackData.__init__-108"><a href="#FeatureTrackData.__init__-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics</span> <span class="o">=</span> <span class="n">camera_intrinsics</span>
</span><span id="FeatureTrackData.__init__-109"><a href="#FeatureTrackData.__init__-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span> <span class="o">=</span> <span class="n">rgbd_images</span>
</span><span id="FeatureTrackData.__init__-110"><a href="#FeatureTrackData.__init__-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span> <span class="o">=</span> <span class="n">latent_keypoint_positions</span>
</span><span id="FeatureTrackData.__init__-111"><a href="#FeatureTrackData.__init__-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span> <span class="o">=</span> <span class="n">latent_keypoint_quaternions</span>
</span><span id="FeatureTrackData.__init__-112"><a href="#FeatureTrackData.__init__-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">object_assignments</span> <span class="o">=</span> <span class="n">object_assignments</span>
</span><span id="FeatureTrackData.__init__-113"><a href="#FeatureTrackData.__init__-113"><span class="linenos">113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span> <span class="o">=</span> <span class="n">camera_position</span>
</span><span id="FeatureTrackData.__init__-114"><a href="#FeatureTrackData.__init__-114"><span class="linenos">114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span> <span class="o">=</span> <span class="n">camera_quaternion</span>
</span></pre></div>




                            </div>
                            <div id="FeatureTrackData.observed_keypoints_positions" class="classattr">
                                <div class="attr variable">
            <span class="name">observed_keypoints_positions</span><span class="annotation">: jax.Array</span>


    </div>
    <a class="headerlink" href="#FeatureTrackData.observed_keypoints_positions"></a>



                            </div>
                            <div id="FeatureTrackData.keypoint_visibility" class="classattr">
                                <div class="attr variable">
            <span class="name">keypoint_visibility</span><span class="annotation">: jax.Array</span>


    </div>
    <a class="headerlink" href="#FeatureTrackData.keypoint_visibility"></a>



                            </div>
                            <div id="FeatureTrackData.camera_intrinsics" class="classattr">
                                <div class="attr variable">
            <span class="name">camera_intrinsics</span><span class="annotation">: jax.Array</span>


    </div>
    <a class="headerlink" href="#FeatureTrackData.camera_intrinsics"></a>



                            </div>
                            <div id="FeatureTrackData.rgbd_images" class="classattr">
                                <div class="attr variable">
            <span class="name">rgbd_images</span><span class="annotation">: jax.Array</span>


    </div>
    <a class="headerlink" href="#FeatureTrackData.rgbd_images"></a>



                            </div>
                            <div id="FeatureTrackData.fps" class="classattr">
                                <div class="attr variable">
            <span class="name">fps</span><span class="annotation">: Optional[jax.Array]</span>        =
<span class="default_value">None</span>


    </div>
    <a class="headerlink" href="#FeatureTrackData.fps"></a>



                            </div>
                            <div id="FeatureTrackData.observed_features" class="classattr">
                                <div class="attr variable">
            <span class="name">observed_features</span><span class="annotation">: Optional[jax.Array]</span>        =
<span class="default_value">None</span>


    </div>
    <a class="headerlink" href="#FeatureTrackData.observed_features"></a>



                            </div>
                            <div id="FeatureTrackData.latent_keypoint_positions" class="classattr">
                                <div class="attr variable">
            <span class="name">latent_keypoint_positions</span><span class="annotation">: Optional[jax.Array]</span>        =
<span class="default_value">None</span>


    </div>
    <a class="headerlink" href="#FeatureTrackData.latent_keypoint_positions"></a>



                            </div>
                            <div id="FeatureTrackData.latent_keypoint_quaternions" class="classattr">
                                <div class="attr variable">
            <span class="name">latent_keypoint_quaternions</span><span class="annotation">: Optional[jax.Array]</span>        =
<span class="default_value">None</span>


    </div>
    <a class="headerlink" href="#FeatureTrackData.latent_keypoint_quaternions"></a>



                            </div>
                            <div id="FeatureTrackData.object_assignments" class="classattr">
                                <div class="attr variable">
            <span class="name">object_assignments</span><span class="annotation">: Optional[jax.Array]</span>        =
<span class="default_value">None</span>


    </div>
    <a class="headerlink" href="#FeatureTrackData.object_assignments"></a>



                            </div>
                            <div id="FeatureTrackData.camera_position" class="classattr">
                                <div class="attr variable">
            <span class="name">camera_position</span><span class="annotation">: Optional[jax.Array]</span>        =
<span class="default_value">None</span>


    </div>
    <a class="headerlink" href="#FeatureTrackData.camera_position"></a>



                            </div>
                            <div id="FeatureTrackData.camera_quaternion" class="classattr">
                                <div class="attr variable">
            <span class="name">camera_quaternion</span><span class="annotation">: Optional[jax.Array]</span>        =
<span class="default_value">None</span>


    </div>
    <a class="headerlink" href="#FeatureTrackData.camera_quaternion"></a>



                            </div>
                            <div id="FeatureTrackData.num_frames" class="classattr">
                                        <input id="FeatureTrackData.num_frames-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">num_frames</span>

                <label class="view-source-button" for="FeatureTrackData.num_frames-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.num_frames"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.num_frames-116"><a href="#FeatureTrackData.num_frames-116"><span class="linenos">116</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData.num_frames-117"><a href="#FeatureTrackData.num_frames-117"><span class="linenos">117</span></a>    <span class="k">def</span> <span class="nf">num_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData.num_frames-118"><a href="#FeatureTrackData.num_frames-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></pre></div>




                            </div>
                            <div id="FeatureTrackData.num_keypoints" class="classattr">
                                        <input id="FeatureTrackData.num_keypoints-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">num_keypoints</span>

                <label class="view-source-button" for="FeatureTrackData.num_keypoints-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.num_keypoints"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.num_keypoints-120"><a href="#FeatureTrackData.num_keypoints-120"><span class="linenos">120</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData.num_keypoints-121"><a href="#FeatureTrackData.num_keypoints-121"><span class="linenos">121</span></a>    <span class="k">def</span> <span class="nf">num_keypoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData.num_keypoints-122"><a href="#FeatureTrackData.num_keypoints-122"><span class="linenos">122</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>




                            </div>
                            <div id="FeatureTrackData.shape" class="classattr">
                                        <input id="FeatureTrackData.shape-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">shape</span>

                <label class="view-source-button" for="FeatureTrackData.shape-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.shape"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.shape-124"><a href="#FeatureTrackData.shape-124"><span class="linenos">124</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData.shape-125"><a href="#FeatureTrackData.shape-125"><span class="linenos">125</span></a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData.shape-126"><a href="#FeatureTrackData.shape-126"><span class="linenos">126</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_frames</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_keypoints</span><span class="p">)</span>
</span></pre></div>




                            </div>
                            <div id="FeatureTrackData.uv" class="classattr">
                                        <input id="FeatureTrackData.uv-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">uv</span>

                <label class="view-source-button" for="FeatureTrackData.uv-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.uv"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.uv-128"><a href="#FeatureTrackData.uv-128"><span class="linenos">128</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData.uv-129"><a href="#FeatureTrackData.uv-129"><span class="linenos">129</span></a>    <span class="k">def</span> <span class="nf">uv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData.uv-130"><a href="#FeatureTrackData.uv-130"><span class="linenos">130</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span>
</span></pre></div>




                            </div>
                            <div id="FeatureTrackData.vis" class="classattr">
                                        <input id="FeatureTrackData.vis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">vis</span>

                <label class="view-source-button" for="FeatureTrackData.vis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.vis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.vis-132"><a href="#FeatureTrackData.vis-132"><span class="linenos">132</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData.vis-133"><a href="#FeatureTrackData.vis-133"><span class="linenos">133</span></a>    <span class="k">def</span> <span class="nf">vis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData.vis-134"><a href="#FeatureTrackData.vis-134"><span class="linenos">134</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">visibility</span>
</span></pre></div>




                            </div>
                            <div id="FeatureTrackData.rgb" class="classattr">
                                        <input id="FeatureTrackData.rgb-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">rgb</span>

                <label class="view-source-button" for="FeatureTrackData.rgb-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.rgb"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.rgb-136"><a href="#FeatureTrackData.rgb-136"><span class="linenos">136</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData.rgb-137"><a href="#FeatureTrackData.rgb-137"><span class="linenos">137</span></a>    <span class="k">def</span> <span class="nf">rgb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData.rgb-138"><a href="#FeatureTrackData.rgb-138"><span class="linenos">138</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</span></pre></div>




                            </div>
                            <div id="FeatureTrackData.visibility" class="classattr">
                                        <input id="FeatureTrackData.visibility-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">visibility</span>

                <label class="view-source-button" for="FeatureTrackData.visibility-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.visibility"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.visibility-140"><a href="#FeatureTrackData.visibility-140"><span class="linenos">140</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData.visibility-141"><a href="#FeatureTrackData.visibility-141"><span class="linenos">141</span></a>    <span class="k">def</span> <span class="nf">visibility</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData.visibility-142"><a href="#FeatureTrackData.visibility-142"><span class="linenos">142</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span>
</span></pre></div>




                            </div>
                            <div id="FeatureTrackData.rgbd" class="classattr">
                                        <input id="FeatureTrackData.rgbd-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">rgbd</span>

                <label class="view-source-button" for="FeatureTrackData.rgbd-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.rgbd"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.rgbd-144"><a href="#FeatureTrackData.rgbd-144"><span class="linenos">144</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData.rgbd-145"><a href="#FeatureTrackData.rgbd-145"><span class="linenos">145</span></a>    <span class="k">def</span> <span class="nf">rgbd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData.rgbd-146"><a href="#FeatureTrackData.rgbd-146"><span class="linenos">146</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span>
</span></pre></div>




                            </div>
                            <div id="FeatureTrackData.camera_poses" class="classattr">
                                        <input id="FeatureTrackData.camera_poses-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">camera_poses</span>

                <label class="view-source-button" for="FeatureTrackData.camera_poses-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.camera_poses"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.camera_poses-148"><a href="#FeatureTrackData.camera_poses-148"><span class="linenos">148</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData.camera_poses-149"><a href="#FeatureTrackData.camera_poses-149"><span class="linenos">149</span></a>    <span class="k">def</span> <span class="nf">camera_poses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData.camera_poses-150"><a href="#FeatureTrackData.camera_poses-150"><span class="linenos">150</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span><span class="p">)</span>
</span></pre></div>




                            </div>
                            <div id="FeatureTrackData.intrinsics" class="classattr">
                                        <input id="FeatureTrackData.intrinsics-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">intrinsics</span>

                <label class="view-source-button" for="FeatureTrackData.intrinsics-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.intrinsics"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.intrinsics-152"><a href="#FeatureTrackData.intrinsics-152"><span class="linenos">152</span></a>    <span class="nd">@property</span>
</span><span id="FeatureTrackData.intrinsics-153"><a href="#FeatureTrackData.intrinsics-153"><span class="linenos">153</span></a>    <span class="k">def</span> <span class="nf">intrinsics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData.intrinsics-154"><a href="#FeatureTrackData.intrinsics-154"><span class="linenos">154</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns camera intrinsics as an Intrinsics object&quot;&quot;&quot;</span>
</span><span id="FeatureTrackData.intrinsics-155"><a href="#FeatureTrackData.intrinsics-155"><span class="linenos">155</span></a>        <span class="k">return</span> <span class="n">Intrinsics</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns camera intrinsics as an Intrinsics object</p>
</div>


                            </div>
                            <div id="FeatureTrackData.save" class="classattr">
                                        <input id="FeatureTrackData.save-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">save</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FeatureTrackData.save-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.save"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.save-163"><a href="#FeatureTrackData.save-163"><span class="linenos">163</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="FeatureTrackData.save-164"><a href="#FeatureTrackData.save-164"><span class="linenos">164</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves input to file&quot;&quot;&quot;</span>
</span><span id="FeatureTrackData.save-165"><a href="#FeatureTrackData.save-165"><span class="linenos">165</span></a>        <span class="n">to_save</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
</span><span id="FeatureTrackData.save-166"><a href="#FeatureTrackData.save-166"><span class="linenos">166</span></a>            <span class="n">latent_keypoint_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span><span class="p">,</span>
</span><span id="FeatureTrackData.save-167"><a href="#FeatureTrackData.save-167"><span class="linenos">167</span></a>            <span class="n">latent_keypoint_quaternions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span><span class="p">,</span>
</span><span id="FeatureTrackData.save-168"><a href="#FeatureTrackData.save-168"><span class="linenos">168</span></a>            <span class="n">observed_keypoints_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="p">,</span>
</span><span id="FeatureTrackData.save-169"><a href="#FeatureTrackData.save-169"><span class="linenos">169</span></a>            <span class="n">observed_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span><span class="p">,</span>
</span><span id="FeatureTrackData.save-170"><a href="#FeatureTrackData.save-170"><span class="linenos">170</span></a>            <span class="n">rgbd_images</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span><span class="p">,</span>
</span><span id="FeatureTrackData.save-171"><a href="#FeatureTrackData.save-171"><span class="linenos">171</span></a>            <span class="n">fps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="p">,</span>
</span><span id="FeatureTrackData.save-172"><a href="#FeatureTrackData.save-172"><span class="linenos">172</span></a>            <span class="n">keypoint_visibility</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span><span class="p">,</span>
</span><span id="FeatureTrackData.save-173"><a href="#FeatureTrackData.save-173"><span class="linenos">173</span></a>            <span class="n">object_assignments</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object_assignments</span><span class="p">,</span>
</span><span id="FeatureTrackData.save-174"><a href="#FeatureTrackData.save-174"><span class="linenos">174</span></a>            <span class="n">camera_position</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span><span class="p">,</span>
</span><span id="FeatureTrackData.save-175"><a href="#FeatureTrackData.save-175"><span class="linenos">175</span></a>            <span class="n">camera_quaternion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span><span class="p">,</span>
</span><span id="FeatureTrackData.save-176"><a href="#FeatureTrackData.save-176"><span class="linenos">176</span></a>            <span class="n">camera_intrinsics</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics</span><span class="p">,</span>
</span><span id="FeatureTrackData.save-177"><a href="#FeatureTrackData.save-177"><span class="linenos">177</span></a>        <span class="p">)</span>
</span><span id="FeatureTrackData.save-178"><a href="#FeatureTrackData.save-178"><span class="linenos">178</span></a>        <span class="n">to_save</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">to_save</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>
</span><span id="FeatureTrackData.save-179"><a href="#FeatureTrackData.save-179"><span class="linenos">179</span></a>        <span class="n">jnp</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="o">**</span><span class="n">to_save</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Saves input to file</p>
</div>


                            </div>
                            <div id="FeatureTrackData.load" class="classattr">
                                        <input id="FeatureTrackData.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FeatureTrackData.load-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.load-181"><a href="#FeatureTrackData.load-181"><span class="linenos">181</span></a>    <span class="nd">@classmethod</span>
</span><span id="FeatureTrackData.load-182"><a href="#FeatureTrackData.load-182"><span class="linenos">182</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="FeatureTrackData.load-183"><a href="#FeatureTrackData.load-183"><span class="linenos">183</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads input from file&quot;&quot;&quot;</span>
</span><span id="FeatureTrackData.load-184"><a href="#FeatureTrackData.load-184"><span class="linenos">184</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="FeatureTrackData.load-185"><a href="#FeatureTrackData.load-185"><span class="linenos">185</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="FeatureTrackData.load-186"><a href="#FeatureTrackData.load-186"><span class="linenos">186</span></a>
</span><span id="FeatureTrackData.load-187"><a href="#FeatureTrackData.load-187"><span class="linenos">187</span></a>            <span class="k">def</span> <span class="nf">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
</span><span id="FeatureTrackData.load-188"><a href="#FeatureTrackData.load-188"><span class="linenos">188</span></a>                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span><span id="FeatureTrackData.load-189"><a href="#FeatureTrackData.load-189"><span class="linenos">189</span></a>                    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="FeatureTrackData.load-190"><a href="#FeatureTrackData.load-190"><span class="linenos">190</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="FeatureTrackData.load-191"><a href="#FeatureTrackData.load-191"><span class="linenos">191</span></a>                    <span class="k">return</span> <span class="kc">None</span>
</span><span id="FeatureTrackData.load-192"><a href="#FeatureTrackData.load-192"><span class="linenos">192</span></a>
</span><span id="FeatureTrackData.load-193"><a href="#FeatureTrackData.load-193"><span class="linenos">193</span></a>            <span class="c1"># Handle loading from either the current `rgbd_images`</span>
</span><span id="FeatureTrackData.load-194"><a href="#FeatureTrackData.load-194"><span class="linenos">194</span></a>            <span class="c1"># format, or from the older `rgb_images` + maybe `xyz` format.</span>
</span><span id="FeatureTrackData.load-195"><a href="#FeatureTrackData.load-195"><span class="linenos">195</span></a>            <span class="n">rgbd_images</span> <span class="o">=</span> <span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;rgbd_images&quot;</span><span class="p">)</span>
</span><span id="FeatureTrackData.load-196"><a href="#FeatureTrackData.load-196"><span class="linenos">196</span></a>            <span class="k">if</span> <span class="n">rgbd_images</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FeatureTrackData.load-197"><a href="#FeatureTrackData.load-197"><span class="linenos">197</span></a>                <span class="n">rgb_imgs</span> <span class="o">=</span> <span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;rgb_imgs&quot;</span><span class="p">)</span>
</span><span id="FeatureTrackData.load-198"><a href="#FeatureTrackData.load-198"><span class="linenos">198</span></a>                <span class="k">assert</span> <span class="p">(</span>
</span><span id="FeatureTrackData.load-199"><a href="#FeatureTrackData.load-199"><span class="linenos">199</span></a>                    <span class="n">rgb_imgs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData.load-200"><a href="#FeatureTrackData.load-200"><span class="linenos">200</span></a>                <span class="p">),</span> <span class="s2">&quot;One of rgbd_images or rgb_imgs must be provided.&quot;</span>
</span><span id="FeatureTrackData.load-201"><a href="#FeatureTrackData.load-201"><span class="linenos">201</span></a>                <span class="n">xyz</span> <span class="o">=</span> <span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;xyz&quot;</span><span class="p">)</span>
</span><span id="FeatureTrackData.load-202"><a href="#FeatureTrackData.load-202"><span class="linenos">202</span></a>                <span class="k">if</span> <span class="n">xyz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FeatureTrackData.load-203"><a href="#FeatureTrackData.load-203"><span class="linenos">203</span></a>                    <span class="n">rgbd_images</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">rgb_imgs</span><span class="p">,</span> <span class="n">xyz</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">:]],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="FeatureTrackData.load-204"><a href="#FeatureTrackData.load-204"><span class="linenos">204</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="FeatureTrackData.load-205"><a href="#FeatureTrackData.load-205"><span class="linenos">205</span></a>                    <span class="n">rgbd_images</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="FeatureTrackData.load-206"><a href="#FeatureTrackData.load-206"><span class="linenos">206</span></a>                        <span class="p">[</span><span class="n">rgb_imgs</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">rgb_imgs</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span>
</span><span id="FeatureTrackData.load-207"><a href="#FeatureTrackData.load-207"><span class="linenos">207</span></a>                    <span class="p">)</span>
</span><span id="FeatureTrackData.load-208"><a href="#FeatureTrackData.load-208"><span class="linenos">208</span></a>
</span><span id="FeatureTrackData.load-209"><a href="#FeatureTrackData.load-209"><span class="linenos">209</span></a>            <span class="c1"># Also handle loading from either the current `keypoint_visibility`</span>
</span><span id="FeatureTrackData.load-210"><a href="#FeatureTrackData.load-210"><span class="linenos">210</span></a>            <span class="c1"># format, or from the older `latent_keypoint_visibility` format.</span>
</span><span id="FeatureTrackData.load-211"><a href="#FeatureTrackData.load-211"><span class="linenos">211</span></a>            <span class="n">keypoint_visibility</span> <span class="o">=</span> <span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;keypoint_visibility&quot;</span><span class="p">)</span>
</span><span id="FeatureTrackData.load-212"><a href="#FeatureTrackData.load-212"><span class="linenos">212</span></a>            <span class="k">if</span> <span class="n">keypoint_visibility</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FeatureTrackData.load-213"><a href="#FeatureTrackData.load-213"><span class="linenos">213</span></a>                <span class="n">keypoint_visibility</span> <span class="o">=</span> <span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;latent_keypoint_visibility&quot;</span><span class="p">)</span>
</span><span id="FeatureTrackData.load-214"><a href="#FeatureTrackData.load-214"><span class="linenos">214</span></a>
</span><span id="FeatureTrackData.load-215"><a href="#FeatureTrackData.load-215"><span class="linenos">215</span></a>            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="FeatureTrackData.load-216"><a href="#FeatureTrackData.load-216"><span class="linenos">216</span></a>                <span class="n">latent_keypoint_positions</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span>
</span><span id="FeatureTrackData.load-217"><a href="#FeatureTrackData.load-217"><span class="linenos">217</span></a>                    <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;latent_keypoint_positions&quot;</span>
</span><span id="FeatureTrackData.load-218"><a href="#FeatureTrackData.load-218"><span class="linenos">218</span></a>                <span class="p">),</span>
</span><span id="FeatureTrackData.load-219"><a href="#FeatureTrackData.load-219"><span class="linenos">219</span></a>                <span class="n">latent_keypoint_quaternions</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span>
</span><span id="FeatureTrackData.load-220"><a href="#FeatureTrackData.load-220"><span class="linenos">220</span></a>                    <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;latent_keypoint_quaternions&quot;</span>
</span><span id="FeatureTrackData.load-221"><a href="#FeatureTrackData.load-221"><span class="linenos">221</span></a>                <span class="p">),</span>
</span><span id="FeatureTrackData.load-222"><a href="#FeatureTrackData.load-222"><span class="linenos">222</span></a>                <span class="n">observed_keypoints_positions</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span>
</span><span id="FeatureTrackData.load-223"><a href="#FeatureTrackData.load-223"><span class="linenos">223</span></a>                    <span class="n">data</span><span class="p">,</span> <span class="s2">&quot;observed_keypoints_positions&quot;</span>
</span><span id="FeatureTrackData.load-224"><a href="#FeatureTrackData.load-224"><span class="linenos">224</span></a>                <span class="p">),</span>
</span><span id="FeatureTrackData.load-225"><a href="#FeatureTrackData.load-225"><span class="linenos">225</span></a>                <span class="n">observed_features</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;observed_features&quot;</span><span class="p">),</span>
</span><span id="FeatureTrackData.load-226"><a href="#FeatureTrackData.load-226"><span class="linenos">226</span></a>                <span class="n">rgbd_images</span><span class="o">=</span><span class="n">rgbd_images</span><span class="p">,</span>
</span><span id="FeatureTrackData.load-227"><a href="#FeatureTrackData.load-227"><span class="linenos">227</span></a>                <span class="n">keypoint_visibility</span><span class="o">=</span><span class="n">keypoint_visibility</span><span class="p">,</span>
</span><span id="FeatureTrackData.load-228"><a href="#FeatureTrackData.load-228"><span class="linenos">228</span></a>                <span class="n">fps</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;fps&quot;</span><span class="p">),</span>
</span><span id="FeatureTrackData.load-229"><a href="#FeatureTrackData.load-229"><span class="linenos">229</span></a>                <span class="n">object_assignments</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;object_assignments&quot;</span><span class="p">),</span>
</span><span id="FeatureTrackData.load-230"><a href="#FeatureTrackData.load-230"><span class="linenos">230</span></a>                <span class="n">camera_position</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;camera_position&quot;</span><span class="p">),</span>
</span><span id="FeatureTrackData.load-231"><a href="#FeatureTrackData.load-231"><span class="linenos">231</span></a>                <span class="n">camera_quaternion</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;camera_quaternion&quot;</span><span class="p">),</span>
</span><span id="FeatureTrackData.load-232"><a href="#FeatureTrackData.load-232"><span class="linenos">232</span></a>                <span class="n">camera_intrinsics</span><span class="o">=</span><span class="n">get_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;camera_intrinsics&quot;</span><span class="p">),</span>
</span><span id="FeatureTrackData.load-233"><a href="#FeatureTrackData.load-233"><span class="linenos">233</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Loads input from file</p>
</div>


                            </div>
                            <div id="FeatureTrackData.slice_time" class="classattr">
                                        <input id="FeatureTrackData.slice_time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">slice_time</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">start_frame</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">end_frame</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FeatureTrackData.slice_time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.slice_time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.slice_time-235"><a href="#FeatureTrackData.slice_time-235"><span class="linenos">235</span></a>    <span class="k">def</span> <span class="nf">slice_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_frame</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end_frame</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="FeatureTrackData.slice_time-236"><a href="#FeatureTrackData.slice_time-236"><span class="linenos">236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Slices data in time.&quot;&quot;&quot;</span>
</span><span id="FeatureTrackData.slice_time-237"><a href="#FeatureTrackData.slice_time-237"><span class="linenos">237</span></a>        <span class="k">if</span> <span class="n">start_frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FeatureTrackData.slice_time-238"><a href="#FeatureTrackData.slice_time-238"><span class="linenos">238</span></a>            <span class="n">start_frame</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="FeatureTrackData.slice_time-239"><a href="#FeatureTrackData.slice_time-239"><span class="linenos">239</span></a>        <span class="k">if</span> <span class="n">end_frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FeatureTrackData.slice_time-240"><a href="#FeatureTrackData.slice_time-240"><span class="linenos">240</span></a>            <span class="n">end_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FeatureTrackData.slice_time-241"><a href="#FeatureTrackData.slice_time-241"><span class="linenos">241</span></a>        <span class="k">return</span> <span class="n">FeatureTrackData</span><span class="p">(</span>
</span><span id="FeatureTrackData.slice_time-242"><a href="#FeatureTrackData.slice_time-242"><span class="linenos">242</span></a>            <span class="n">observed_keypoints_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="p">[</span>
</span><span id="FeatureTrackData.slice_time-243"><a href="#FeatureTrackData.slice_time-243"><span class="linenos">243</span></a>                <span class="n">start_frame</span><span class="p">:</span><span class="n">end_frame</span>
</span><span id="FeatureTrackData.slice_time-244"><a href="#FeatureTrackData.slice_time-244"><span class="linenos">244</span></a>            <span class="p">],</span>
</span><span id="FeatureTrackData.slice_time-245"><a href="#FeatureTrackData.slice_time-245"><span class="linenos">245</span></a>            <span class="n">observed_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span><span class="p">[</span><span class="n">start_frame</span><span class="p">:</span><span class="n">end_frame</span><span class="p">]</span>
</span><span id="FeatureTrackData.slice_time-246"><a href="#FeatureTrackData.slice_time-246"><span class="linenos">246</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData.slice_time-247"><a href="#FeatureTrackData.slice_time-247"><span class="linenos">247</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.slice_time-248"><a href="#FeatureTrackData.slice_time-248"><span class="linenos">248</span></a>            <span class="n">keypoint_visibility</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span><span class="p">[</span><span class="n">start_frame</span><span class="p">:</span><span class="n">end_frame</span><span class="p">],</span>
</span><span id="FeatureTrackData.slice_time-249"><a href="#FeatureTrackData.slice_time-249"><span class="linenos">249</span></a>            <span class="n">rgbd_images</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span><span class="p">[</span><span class="n">start_frame</span><span class="p">:</span><span class="n">end_frame</span><span class="p">],</span>
</span><span id="FeatureTrackData.slice_time-250"><a href="#FeatureTrackData.slice_time-250"><span class="linenos">250</span></a>            <span class="n">latent_keypoint_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span><span class="p">[</span>
</span><span id="FeatureTrackData.slice_time-251"><a href="#FeatureTrackData.slice_time-251"><span class="linenos">251</span></a>                <span class="n">start_frame</span><span class="p">:</span><span class="n">end_frame</span>
</span><span id="FeatureTrackData.slice_time-252"><a href="#FeatureTrackData.slice_time-252"><span class="linenos">252</span></a>            <span class="p">]</span>
</span><span id="FeatureTrackData.slice_time-253"><a href="#FeatureTrackData.slice_time-253"><span class="linenos">253</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData.slice_time-254"><a href="#FeatureTrackData.slice_time-254"><span class="linenos">254</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.slice_time-255"><a href="#FeatureTrackData.slice_time-255"><span class="linenos">255</span></a>            <span class="n">latent_keypoint_quaternions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span><span class="p">[</span>
</span><span id="FeatureTrackData.slice_time-256"><a href="#FeatureTrackData.slice_time-256"><span class="linenos">256</span></a>                <span class="n">start_frame</span><span class="p">:</span><span class="n">end_frame</span>
</span><span id="FeatureTrackData.slice_time-257"><a href="#FeatureTrackData.slice_time-257"><span class="linenos">257</span></a>            <span class="p">]</span>
</span><span id="FeatureTrackData.slice_time-258"><a href="#FeatureTrackData.slice_time-258"><span class="linenos">258</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData.slice_time-259"><a href="#FeatureTrackData.slice_time-259"><span class="linenos">259</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.slice_time-260"><a href="#FeatureTrackData.slice_time-260"><span class="linenos">260</span></a>            <span class="n">object_assignments</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object_assignments</span><span class="p">,</span>
</span><span id="FeatureTrackData.slice_time-261"><a href="#FeatureTrackData.slice_time-261"><span class="linenos">261</span></a>            <span class="n">camera_position</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span><span class="p">[</span><span class="n">start_frame</span><span class="p">:</span><span class="n">end_frame</span><span class="p">]</span>
</span><span id="FeatureTrackData.slice_time-262"><a href="#FeatureTrackData.slice_time-262"><span class="linenos">262</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData.slice_time-263"><a href="#FeatureTrackData.slice_time-263"><span class="linenos">263</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.slice_time-264"><a href="#FeatureTrackData.slice_time-264"><span class="linenos">264</span></a>            <span class="n">camera_quaternion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span><span class="p">[</span><span class="n">start_frame</span><span class="p">:</span><span class="n">end_frame</span><span class="p">]</span>
</span><span id="FeatureTrackData.slice_time-265"><a href="#FeatureTrackData.slice_time-265"><span class="linenos">265</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData.slice_time-266"><a href="#FeatureTrackData.slice_time-266"><span class="linenos">266</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.slice_time-267"><a href="#FeatureTrackData.slice_time-267"><span class="linenos">267</span></a>            <span class="n">camera_intrinsics</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics</span><span class="p">,</span>
</span><span id="FeatureTrackData.slice_time-268"><a href="#FeatureTrackData.slice_time-268"><span class="linenos">268</span></a>            <span class="n">fps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="p">,</span>
</span><span id="FeatureTrackData.slice_time-269"><a href="#FeatureTrackData.slice_time-269"><span class="linenos">269</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Slices data in time.</p>
</div>


                            </div>
                            <div id="FeatureTrackData.downscale" class="classattr">
                                        <input id="FeatureTrackData.downscale-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">downscale</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">factor</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FeatureTrackData.downscale-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.downscale"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.downscale-299"><a href="#FeatureTrackData.downscale-299"><span class="linenos">299</span></a>    <span class="k">def</span> <span class="nf">downscale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
</span><span id="FeatureTrackData.downscale-300"><a href="#FeatureTrackData.downscale-300"><span class="linenos">300</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Downscales the rgbd images by the given factor.&quot;&quot;&quot;</span>
</span><span id="FeatureTrackData.downscale-301"><a href="#FeatureTrackData.downscale-301"><span class="linenos">301</span></a>        <span class="k">assert</span> <span class="p">(</span>
</span><span id="FeatureTrackData.downscale-302"><a href="#FeatureTrackData.downscale-302"><span class="linenos">302</span></a>            <span class="n">factor</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">int</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span> <span class="o">==</span> <span class="n">factor</span>
</span><span id="FeatureTrackData.downscale-303"><a href="#FeatureTrackData.downscale-303"><span class="linenos">303</span></a>        <span class="p">),</span> <span class="s2">&quot;Factor must be an integer greater than or equal to 1.&quot;</span>
</span><span id="FeatureTrackData.downscale-304"><a href="#FeatureTrackData.downscale-304"><span class="linenos">304</span></a>        <span class="n">factor</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
</span><span id="FeatureTrackData.downscale-305"><a href="#FeatureTrackData.downscale-305"><span class="linenos">305</span></a>        <span class="k">if</span> <span class="n">factor</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="FeatureTrackData.downscale-306"><a href="#FeatureTrackData.downscale-306"><span class="linenos">306</span></a>            <span class="k">return</span> <span class="bp">self</span>
</span><span id="FeatureTrackData.downscale-307"><a href="#FeatureTrackData.downscale-307"><span class="linenos">307</span></a>
</span><span id="FeatureTrackData.downscale-308"><a href="#FeatureTrackData.downscale-308"><span class="linenos">308</span></a>        <span class="k">return</span> <span class="n">FeatureTrackData</span><span class="p">(</span>
</span><span id="FeatureTrackData.downscale-309"><a href="#FeatureTrackData.downscale-309"><span class="linenos">309</span></a>            <span class="n">observed_keypoints_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span> <span class="o">/</span> <span class="n">factor</span><span class="p">,</span>
</span><span id="FeatureTrackData.downscale-310"><a href="#FeatureTrackData.downscale-310"><span class="linenos">310</span></a>            <span class="n">observed_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span><span class="p">,</span>
</span><span id="FeatureTrackData.downscale-311"><a href="#FeatureTrackData.downscale-311"><span class="linenos">311</span></a>            <span class="n">keypoint_visibility</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span><span class="p">,</span>
</span><span id="FeatureTrackData.downscale-312"><a href="#FeatureTrackData.downscale-312"><span class="linenos">312</span></a>            <span class="c1"># TODO: Improve the downscaling procedure for the video.</span>
</span><span id="FeatureTrackData.downscale-313"><a href="#FeatureTrackData.downscale-313"><span class="linenos">313</span></a>            <span class="n">rgbd_images</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span><span class="p">[:,</span> <span class="p">::</span><span class="n">factor</span><span class="p">,</span> <span class="p">::</span><span class="n">factor</span><span class="p">,</span> <span class="p">:],</span>
</span><span id="FeatureTrackData.downscale-314"><a href="#FeatureTrackData.downscale-314"><span class="linenos">314</span></a>            <span class="n">latent_keypoint_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span><span class="p">,</span>
</span><span id="FeatureTrackData.downscale-315"><a href="#FeatureTrackData.downscale-315"><span class="linenos">315</span></a>            <span class="n">latent_keypoint_quaternions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span><span class="p">,</span>
</span><span id="FeatureTrackData.downscale-316"><a href="#FeatureTrackData.downscale-316"><span class="linenos">316</span></a>            <span class="n">object_assignments</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object_assignments</span><span class="p">,</span>
</span><span id="FeatureTrackData.downscale-317"><a href="#FeatureTrackData.downscale-317"><span class="linenos">317</span></a>            <span class="n">camera_position</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span><span class="p">,</span>
</span><span id="FeatureTrackData.downscale-318"><a href="#FeatureTrackData.downscale-318"><span class="linenos">318</span></a>            <span class="n">camera_quaternion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span><span class="p">,</span>
</span><span id="FeatureTrackData.downscale-319"><a href="#FeatureTrackData.downscale-319"><span class="linenos">319</span></a>            <span class="n">camera_intrinsics</span><span class="o">=</span><span class="n">Intrinsics</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">intrinsics</span><span class="p">)</span>
</span><span id="FeatureTrackData.downscale-320"><a href="#FeatureTrackData.downscale-320"><span class="linenos">320</span></a>            <span class="o">.</span><span class="n">downscale</span><span class="p">(</span><span class="n">factor</span><span class="p">)</span>
</span><span id="FeatureTrackData.downscale-321"><a href="#FeatureTrackData.downscale-321"><span class="linenos">321</span></a>            <span class="o">.</span><span class="n">as_array</span><span class="p">(),</span>
</span><span id="FeatureTrackData.downscale-322"><a href="#FeatureTrackData.downscale-322"><span class="linenos">322</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Downscales the rgbd images by the given factor.</p>
</div>


                            </div>
                            <div id="FeatureTrackData.has_depth_channel" class="classattr">
                                        <input id="FeatureTrackData.has_depth_channel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">has_depth_channel</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FeatureTrackData.has_depth_channel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.has_depth_channel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.has_depth_channel-324"><a href="#FeatureTrackData.has_depth_channel-324"><span class="linenos">324</span></a>    <span class="k">def</span> <span class="nf">has_depth_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData.has_depth_channel-325"><a href="#FeatureTrackData.has_depth_channel-325"><span class="linenos">325</span></a>        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>
</span></pre></div>




                            </div>
                            <div id="FeatureTrackData.remove_points_invisible_at_frame0" class="classattr">
                                        <input id="FeatureTrackData.remove_points_invisible_at_frame0-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">remove_points_invisible_at_frame0</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FeatureTrackData.remove_points_invisible_at_frame0-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.remove_points_invisible_at_frame0"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.remove_points_invisible_at_frame0-327"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-327"><span class="linenos">327</span></a>    <span class="k">def</span> <span class="nf">remove_points_invisible_at_frame0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-328"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-328"><span class="linenos">328</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-329"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-329"><span class="linenos">329</span></a><span class="sd">        Filter this FeatureTrackData to only include keypoints that are visible at frame 0.</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-330"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-330"><span class="linenos">330</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-331"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-331"><span class="linenos">331</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-332"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-332"><span class="linenos">332</span></a>        <span class="k">return</span> <span class="n">FeatureTrackData</span><span class="p">(</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-333"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-333"><span class="linenos">333</span></a>            <span class="n">observed_keypoints_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="p">[:,</span> <span class="n">mask</span><span class="p">],</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-334"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-334"><span class="linenos">334</span></a>            <span class="n">observed_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span><span class="p">[:,</span> <span class="n">mask</span><span class="p">]</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-335"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-335"><span class="linenos">335</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-336"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-336"><span class="linenos">336</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-337"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-337"><span class="linenos">337</span></a>            <span class="n">keypoint_visibility</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span><span class="p">[:,</span> <span class="n">mask</span><span class="p">],</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-338"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-338"><span class="linenos">338</span></a>            <span class="n">rgbd_images</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span><span class="p">,</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-339"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-339"><span class="linenos">339</span></a>            <span class="n">latent_keypoint_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span><span class="p">[:,</span> <span class="n">mask</span><span class="p">]</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-340"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-340"><span class="linenos">340</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-341"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-341"><span class="linenos">341</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-342"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-342"><span class="linenos">342</span></a>            <span class="n">latent_keypoint_quaternions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span><span class="p">[:,</span> <span class="n">mask</span><span class="p">]</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-343"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-343"><span class="linenos">343</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-344"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-344"><span class="linenos">344</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-345"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-345"><span class="linenos">345</span></a>            <span class="n">object_assignments</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object_assignments</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-346"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-346"><span class="linenos">346</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_assignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-347"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-347"><span class="linenos">347</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-348"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-348"><span class="linenos">348</span></a>            <span class="n">camera_position</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span><span class="p">,</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-349"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-349"><span class="linenos">349</span></a>            <span class="n">camera_quaternion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span><span class="p">,</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-350"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-350"><span class="linenos">350</span></a>            <span class="n">camera_intrinsics</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics</span><span class="p">,</span>
</span><span id="FeatureTrackData.remove_points_invisible_at_frame0-351"><a href="#FeatureTrackData.remove_points_invisible_at_frame0-351"><span class="linenos">351</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Filter this FeatureTrackData to only include keypoints that are visible at frame 0.</p>
</div>


                            </div>
                            <div id="FeatureTrackData.all_points_visible_at_frame0" class="classattr">
                                        <input id="FeatureTrackData.all_points_visible_at_frame0-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">all_points_visible_at_frame0</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FeatureTrackData.all_points_visible_at_frame0-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.all_points_visible_at_frame0"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.all_points_visible_at_frame0-353"><a href="#FeatureTrackData.all_points_visible_at_frame0-353"><span class="linenos">353</span></a>    <span class="k">def</span> <span class="nf">all_points_visible_at_frame0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData.all_points_visible_at_frame0-354"><a href="#FeatureTrackData.all_points_visible_at_frame0-354"><span class="linenos">354</span></a>        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></pre></div>




                            </div>
                            <div id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0" class="classattr">
                                        <input id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">sparsify_points_to_minimum_2D_distance_at_frame0</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">min_2D_distance</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-356"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-356"><span class="linenos">356</span></a>    <span class="k">def</span> <span class="nf">sparsify_points_to_minimum_2D_distance_at_frame0</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_2D_distance</span><span class="p">):</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-357"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-357"><span class="linenos">357</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-358"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-358"><span class="linenos">358</span></a><span class="sd">        Filter the keypoints in this FeatureTrackData object, returning a new</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-359"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-359"><span class="linenos">359</span></a><span class="sd">        FeatureTrackData in which no two observed keypoints</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-360"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-360"><span class="linenos">360</span></a><span class="sd">        are closer than `min_2D_distance` pixels in the first frame.</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-361"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-361"><span class="linenos">361</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-362"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-362"><span class="linenos">362</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_points_visible_at_frame0</span><span class="p">(),</span> <span class="s2">&quot;In the current implementation, all keypoints must be visible at frame 0 to filter by minimimum 2D distance.&quot;</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-363"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-363"><span class="linenos">363</span></a>        <span class="n">valid_indices</span> <span class="o">=</span> <span class="n">get_keypoint_filter</span><span class="p">(</span><span class="n">min_2D_distance</span><span class="p">)(</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-364"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-364"><span class="linenos">364</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-365"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-365"><span class="linenos">365</span></a>        <span class="p">)</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-366"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-366"><span class="linenos">366</span></a>        <span class="k">return</span> <span class="n">FeatureTrackData</span><span class="p">(</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-367"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-367"><span class="linenos">367</span></a>            <span class="n">observed_keypoints_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="p">[</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-368"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-368"><span class="linenos">368</span></a>                <span class="p">:,</span> <span class="n">valid_indices</span><span class="p">,</span> <span class="p">:</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-369"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-369"><span class="linenos">369</span></a>            <span class="p">],</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-370"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-370"><span class="linenos">370</span></a>            <span class="n">observed_features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span><span class="p">[:,</span> <span class="n">valid_indices</span><span class="p">]</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-371"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-371"><span class="linenos">371</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">observed_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-372"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-372"><span class="linenos">372</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-373"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-373"><span class="linenos">373</span></a>            <span class="n">keypoint_visibility</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">keypoint_visibility</span><span class="p">[:,</span> <span class="n">valid_indices</span><span class="p">],</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-374"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-374"><span class="linenos">374</span></a>            <span class="n">rgbd_images</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rgbd_images</span><span class="p">,</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-375"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-375"><span class="linenos">375</span></a>            <span class="n">latent_keypoint_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span><span class="p">[:,</span> <span class="n">valid_indices</span><span class="p">]</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-376"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-376"><span class="linenos">376</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_positions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-377"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-377"><span class="linenos">377</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-378"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-378"><span class="linenos">378</span></a>            <span class="n">latent_keypoint_quaternions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span><span class="p">[</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-379"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-379"><span class="linenos">379</span></a>                <span class="p">:,</span> <span class="n">valid_indices</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-380"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-380"><span class="linenos">380</span></a>            <span class="p">]</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-381"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-381"><span class="linenos">381</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_keypoint_quaternions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-382"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-382"><span class="linenos">382</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-383"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-383"><span class="linenos">383</span></a>            <span class="n">object_assignments</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object_assignments</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">]</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-384"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-384"><span class="linenos">384</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_assignments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-385"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-385"><span class="linenos">385</span></a>            <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-386"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-386"><span class="linenos">386</span></a>            <span class="n">camera_position</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_position</span><span class="p">,</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-387"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-387"><span class="linenos">387</span></a>            <span class="n">camera_quaternion</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternion</span><span class="p">,</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-388"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-388"><span class="linenos">388</span></a>            <span class="n">camera_intrinsics</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics</span><span class="p">,</span>
</span><span id="FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-389"><a href="#FeatureTrackData.sparsify_points_to_minimum_2D_distance_at_frame0-389"><span class="linenos">389</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Filter the keypoints in this FeatureTrackData object, returning a new
FeatureTrackData in which no two observed keypoints
are closer than <code>min_2D_distance</code> pixels in the first frame.</p>
</div>


                            </div>
                            <div id="FeatureTrackData.min_2D_distance_at_frame0" class="classattr">
                                        <input id="FeatureTrackData.min_2D_distance_at_frame0-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">min_2D_distance_at_frame0</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FeatureTrackData.min_2D_distance_at_frame0-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.min_2D_distance_at_frame0"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.min_2D_distance_at_frame0-391"><a href="#FeatureTrackData.min_2D_distance_at_frame0-391"><span class="linenos">391</span></a>    <span class="k">def</span> <span class="nf">min_2D_distance_at_frame0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureTrackData.min_2D_distance_at_frame0-392"><a href="#FeatureTrackData.min_2D_distance_at_frame0-392"><span class="linenos">392</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureTrackData.min_2D_distance_at_frame0-393"><a href="#FeatureTrackData.min_2D_distance_at_frame0-393"><span class="linenos">393</span></a><span class="sd">        Returns the minimum 2D distance between any two keypoints at frame 0.</span>
</span><span id="FeatureTrackData.min_2D_distance_at_frame0-394"><a href="#FeatureTrackData.min_2D_distance_at_frame0-394"><span class="linenos">394</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureTrackData.min_2D_distance_at_frame0-395"><a href="#FeatureTrackData.min_2D_distance_at_frame0-395"><span class="linenos">395</span></a>        <span class="n">distances</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
</span><span id="FeatureTrackData.min_2D_distance_at_frame0-396"><a href="#FeatureTrackData.min_2D_distance_at_frame0-396"><span class="linenos">396</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</span><span id="FeatureTrackData.min_2D_distance_at_frame0-397"><a href="#FeatureTrackData.min_2D_distance_at_frame0-397"><span class="linenos">397</span></a>            <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">observed_keypoints_positions</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">],</span>
</span><span id="FeatureTrackData.min_2D_distance_at_frame0-398"><a href="#FeatureTrackData.min_2D_distance_at_frame0-398"><span class="linenos">398</span></a>            <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span id="FeatureTrackData.min_2D_distance_at_frame0-399"><a href="#FeatureTrackData.min_2D_distance_at_frame0-399"><span class="linenos">399</span></a>        <span class="p">)</span>
</span><span id="FeatureTrackData.min_2D_distance_at_frame0-400"><a href="#FeatureTrackData.min_2D_distance_at_frame0-400"><span class="linenos">400</span></a>        <span class="n">distances</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">distances</span><span class="p">)</span>
</span><span id="FeatureTrackData.min_2D_distance_at_frame0-401"><a href="#FeatureTrackData.min_2D_distance_at_frame0-401"><span class="linenos">401</span></a>        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the minimum 2D distance between any two keypoints at frame 0.</p>
</div>


                            </div>
                            <div id="FeatureTrackData.quick_plot" class="classattr">
                                        <input id="FeatureTrackData.quick_plot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">quick_plot</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">t</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">fname</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">ax</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>, </span><span class="param"><span class="n">downsize</span><span class="o">=</span><span class="mi">10</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FeatureTrackData.quick_plot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureTrackData.quick_plot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureTrackData.quick_plot-403"><a href="#FeatureTrackData.quick_plot-403"><span class="linenos">403</span></a>    <span class="k">def</span> <span class="nf">quick_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">downsize</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
</span><span id="FeatureTrackData.quick_plot-404"><a href="#FeatureTrackData.quick_plot-404"><span class="linenos">404</span></a>        <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FeatureTrackData.quick_plot-405"><a href="#FeatureTrackData.quick_plot-405"><span class="linenos">405</span></a>            <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">figsize</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_frames</span><span class="p">,</span> <span class="n">figsize</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FeatureTrackData.quick_plot-406"><a href="#FeatureTrackData.quick_plot-406"><span class="linenos">406</span></a>
</span><span id="FeatureTrackData.quick_plot-407"><a href="#FeatureTrackData.quick_plot-407"><span class="linenos">407</span></a>        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FeatureTrackData.quick_plot-408"><a href="#FeatureTrackData.quick_plot-408"><span class="linenos">408</span></a>            <span class="n">_fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
</span><span id="FeatureTrackData.quick_plot-409"><a href="#FeatureTrackData.quick_plot-409"><span class="linenos">409</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="FeatureTrackData.quick_plot-410"><a href="#FeatureTrackData.quick_plot-410"><span class="linenos">410</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</span><span id="FeatureTrackData.quick_plot-411"><a href="#FeatureTrackData.quick_plot-411"><span class="linenos">411</span></a>
</span><span id="FeatureTrackData.quick_plot-412"><a href="#FeatureTrackData.quick_plot-412"><span class="linenos">412</span></a>        <span class="n">rgb</span> <span class="o">=</span> <span class="n">downsize_images</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="p">,</span> <span class="n">downsize</span><span class="p">)</span>
</span><span id="FeatureTrackData.quick_plot-413"><a href="#FeatureTrackData.quick_plot-413"><span class="linenos">413</span></a>        <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FeatureTrackData.quick_plot-414"><a href="#FeatureTrackData.quick_plot-414"><span class="linenos">414</span></a>            <span class="n">_h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</span><span id="FeatureTrackData.quick_plot-415"><a href="#FeatureTrackData.quick_plot-415"><span class="linenos">415</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">rgb</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</span><span id="FeatureTrackData.quick_plot-416"><a href="#FeatureTrackData.quick_plot-416"><span class="linenos">416</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
</span><span id="FeatureTrackData.quick_plot-417"><a href="#FeatureTrackData.quick_plot-417"><span class="linenos">417</span></a>                <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="FeatureTrackData.quick_plot-418"><a href="#FeatureTrackData.quick_plot-418"><span class="linenos">418</span></a>                    <span class="p">[</span>
</span><span id="FeatureTrackData.quick_plot-419"><a href="#FeatureTrackData.quick_plot-419"><span class="linenos">419</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">uv</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vis</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span> <span class="o">/</span> <span class="n">downsize</span>
</span><span id="FeatureTrackData.quick_plot-420"><a href="#FeatureTrackData.quick_plot-420"><span class="linenos">420</span></a>                        <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">t</span> <span class="o">*</span> <span class="n">w</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">downsize</span>
</span><span id="FeatureTrackData.quick_plot-421"><a href="#FeatureTrackData.quick_plot-421"><span class="linenos">421</span></a>                        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_frames</span><span class="p">)</span>
</span><span id="FeatureTrackData.quick_plot-422"><a href="#FeatureTrackData.quick_plot-422"><span class="linenos">422</span></a>                    <span class="p">]</span>
</span><span id="FeatureTrackData.quick_plot-423"><a href="#FeatureTrackData.quick_plot-423"><span class="linenos">423</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="FeatureTrackData.quick_plot-424"><a href="#FeatureTrackData.quick_plot-424"><span class="linenos">424</span></a>                <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="FeatureTrackData.quick_plot-425"><a href="#FeatureTrackData.quick_plot-425"><span class="linenos">425</span></a>            <span class="p">)</span>
</span><span id="FeatureTrackData.quick_plot-426"><a href="#FeatureTrackData.quick_plot-426"><span class="linenos">426</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="FeatureTrackData.quick_plot-427"><a href="#FeatureTrackData.quick_plot-427"><span class="linenos">427</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rgb</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">/</span> <span class="mi">255</span><span class="p">)</span>
</span><span id="FeatureTrackData.quick_plot-428"><a href="#FeatureTrackData.quick_plot-428"><span class="linenos">428</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uv</span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vis</span><span class="p">[</span><span class="n">t</span><span class="p">]]</span> <span class="o">/</span> <span class="n">downsize</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>




                            </div>
                </section>
                <section id="VideoInput">
                            <input id="VideoInput-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">VideoInput</span>:

                <label class="view-source-button" for="VideoInput-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VideoInput"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VideoInput-9"><a href="#VideoInput-9"><span class="linenos">  9</span></a><span class="nd">@dataclass</span>
</span><span id="VideoInput-10"><a href="#VideoInput-10"><span class="linenos"> 10</span></a><span class="k">class</span> <span class="nc">VideoInput</span><span class="p">:</span>
</span><span id="VideoInput-11"><a href="#VideoInput-11"><span class="linenos"> 11</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="VideoInput-12"><a href="#VideoInput-12"><span class="linenos"> 12</span></a><span class="sd">    Video data input. Note: Spatial units are measured in meters.</span>
</span><span id="VideoInput-13"><a href="#VideoInput-13"><span class="linenos"> 13</span></a>
</span><span id="VideoInput-14"><a href="#VideoInput-14"><span class="linenos"> 14</span></a><span class="sd">    World Coordinates. The floor is x,y and up is z.</span>
</span><span id="VideoInput-15"><a href="#VideoInput-15"><span class="linenos"> 15</span></a><span class="sd">    Camera Pose. The camera pose should be interpretted as the z-axis pointing out of the camera,</span>
</span><span id="VideoInput-16"><a href="#VideoInput-16"><span class="linenos"> 16</span></a><span class="sd">        x-axis pointing to the right, and y-axis pointing down. This is the OpenCV convention.</span>
</span><span id="VideoInput-17"><a href="#VideoInput-17"><span class="linenos"> 17</span></a><span class="sd">    Quaternions. We follow scipy.spatial.transform.Rotation.from_quat which uses scalar-last (x, y, z, w)</span>
</span><span id="VideoInput-18"><a href="#VideoInput-18"><span class="linenos"> 18</span></a><span class="sd">    Camera Intrinsics. We store it as an array of shape (8,) containing width, height, fx, fy, cx, cy, near, far.</span>
</span><span id="VideoInput-19"><a href="#VideoInput-19"><span class="linenos"> 19</span></a><span class="sd">        The camera matrix is given by: $$ K = \\begin{bmatrix} f_x &amp; 0 &amp; c_x \\ 0 &amp; f_y &amp; c_y \\ 0 &amp; 0 &amp; 1 \\end{bmatrix} $$</span>
</span><span id="VideoInput-20"><a href="#VideoInput-20"><span class="linenos"> 20</span></a><span class="sd">    Spatial units. Spatial units are measured in meters (if not indicated otherwise).</span>
</span><span id="VideoInput-21"><a href="#VideoInput-21"><span class="linenos"> 21</span></a>
</span><span id="VideoInput-22"><a href="#VideoInput-22"><span class="linenos"> 22</span></a><span class="sd">    **Attributes:**</span>
</span><span id="VideoInput-23"><a href="#VideoInput-23"><span class="linenos"> 23</span></a><span class="sd">    - rgb</span>
</span><span id="VideoInput-24"><a href="#VideoInput-24"><span class="linenos"> 24</span></a><span class="sd">        video_input[&#39;rgb&#39;][t,i,j] contains RGB values in the interval [0,255] of pixel i,j at time t.</span>
</span><span id="VideoInput-25"><a href="#VideoInput-25"><span class="linenos"> 25</span></a><span class="sd">        Shape: (T,H,W,3) -- Note this might be different from the width and height of xyz</span>
</span><span id="VideoInput-26"><a href="#VideoInput-26"><span class="linenos"> 26</span></a><span class="sd">        Type: uint8, in [0,255]</span>
</span><span id="VideoInput-27"><a href="#VideoInput-27"><span class="linenos"> 27</span></a><span class="sd">    - xyz</span>
</span><span id="VideoInput-28"><a href="#VideoInput-28"><span class="linenos"> 28</span></a><span class="sd">        video_input[&#39;xyz&#39;][t,i,j] is the 3d point associated with pixel i,j at time t in camera coordinates</span>
</span><span id="VideoInput-29"><a href="#VideoInput-29"><span class="linenos"> 29</span></a><span class="sd">        Shape: (T, H&#39;, W&#39;, 3) -- Note this might be different from the width and height of rgb</span>
</span><span id="VideoInput-30"><a href="#VideoInput-30"><span class="linenos"> 30</span></a><span class="sd">        Type: Float</span>
</span><span id="VideoInput-31"><a href="#VideoInput-31"><span class="linenos"> 31</span></a><span class="sd">    - camera_positions</span>
</span><span id="VideoInput-32"><a href="#VideoInput-32"><span class="linenos"> 32</span></a><span class="sd">        video_input[&#39;camera_positions&#39;][t] is the position of the camera at time t</span>
</span><span id="VideoInput-33"><a href="#VideoInput-33"><span class="linenos"> 33</span></a><span class="sd">        Shape: (T, 3)</span>
</span><span id="VideoInput-34"><a href="#VideoInput-34"><span class="linenos"> 34</span></a><span class="sd">        Type: Float</span>
</span><span id="VideoInput-35"><a href="#VideoInput-35"><span class="linenos"> 35</span></a><span class="sd">    - camera_quaternions</span>
</span><span id="VideoInput-36"><a href="#VideoInput-36"><span class="linenos"> 36</span></a><span class="sd">        video_input[&#39;camera_quaternions&#39;][t] is the quaternion (in xyzw format) representing the orientation of the camera at time t</span>
</span><span id="VideoInput-37"><a href="#VideoInput-37"><span class="linenos"> 37</span></a><span class="sd">        Shape: (T, 4)</span>
</span><span id="VideoInput-38"><a href="#VideoInput-38"><span class="linenos"> 38</span></a><span class="sd">        Type: Float</span>
</span><span id="VideoInput-39"><a href="#VideoInput-39"><span class="linenos"> 39</span></a><span class="sd">    - camera_intrinsics_rgb</span>
</span><span id="VideoInput-40"><a href="#VideoInput-40"><span class="linenos"> 40</span></a><span class="sd">        video_input[&#39;camera_intrinsics_rgb&#39;][:] contains width, height, fx, fy, cx, cy, near, far. Width and height determine the shape of rgb above</span>
</span><span id="VideoInput-41"><a href="#VideoInput-41"><span class="linenos"> 41</span></a><span class="sd">        Shape: (8,)</span>
</span><span id="VideoInput-42"><a href="#VideoInput-42"><span class="linenos"> 42</span></a><span class="sd">        Type: Float</span>
</span><span id="VideoInput-43"><a href="#VideoInput-43"><span class="linenos"> 43</span></a><span class="sd">    - camera_intrinsics_depth</span>
</span><span id="VideoInput-44"><a href="#VideoInput-44"><span class="linenos"> 44</span></a><span class="sd">        video_input[&#39;camera_intrinsics_depth&#39;][:] contains width, height, fx, fy, cx, cy, near, far. Width and height determine the shape of xyz above</span>
</span><span id="VideoInput-45"><a href="#VideoInput-45"><span class="linenos"> 45</span></a><span class="sd">        Shape: (8,)</span>
</span><span id="VideoInput-46"><a href="#VideoInput-46"><span class="linenos"> 46</span></a><span class="sd">        Type: Float</span>
</span><span id="VideoInput-47"><a href="#VideoInput-47"><span class="linenos"> 47</span></a><span class="sd">    - fps</span>
</span><span id="VideoInput-48"><a href="#VideoInput-48"><span class="linenos"> 48</span></a><span class="sd">        Frames per second of the video</span>
</span><span id="VideoInput-49"><a href="#VideoInput-49"><span class="linenos"> 49</span></a><span class="sd">        Type: Float</span>
</span><span id="VideoInput-50"><a href="#VideoInput-50"><span class="linenos"> 50</span></a>
</span><span id="VideoInput-51"><a href="#VideoInput-51"><span class="linenos"> 51</span></a><span class="sd">    **Note:**</span>
</span><span id="VideoInput-52"><a href="#VideoInput-52"><span class="linenos"> 52</span></a><span class="sd">    For compactness, rgb values are saved as uint8 values, however</span>
</span><span id="VideoInput-53"><a href="#VideoInput-53"><span class="linenos"> 53</span></a><span class="sd">    the output of the renderer is a float between 0 and 1. VideoInput</span>
</span><span id="VideoInput-54"><a href="#VideoInput-54"><span class="linenos"> 54</span></a><span class="sd">    stores uint8 colors, so please use the rgb_float property for</span>
</span><span id="VideoInput-55"><a href="#VideoInput-55"><span class="linenos"> 55</span></a><span class="sd">    compatibility.</span>
</span><span id="VideoInput-56"><a href="#VideoInput-56"><span class="linenos"> 56</span></a>
</span><span id="VideoInput-57"><a href="#VideoInput-57"><span class="linenos"> 57</span></a><span class="sd">    **Note:**</span>
</span><span id="VideoInput-58"><a href="#VideoInput-58"><span class="linenos"> 58</span></a><span class="sd">    The width and height of the `rgb` and `xyz` arrays may differ.</span>
</span><span id="VideoInput-59"><a href="#VideoInput-59"><span class="linenos"> 59</span></a><span class="sd">    Their shapes match the entries in `camera_intrinsics_rgb` and</span>
</span><span id="VideoInput-60"><a href="#VideoInput-60"><span class="linenos"> 60</span></a><span class="sd">    `camera_intrinsics_depth`, respectively. The latter was used</span>
</span><span id="VideoInput-61"><a href="#VideoInput-61"><span class="linenos"> 61</span></a><span class="sd">    to project the `depth` arrays to `xyz`.</span>
</span><span id="VideoInput-62"><a href="#VideoInput-62"><span class="linenos"> 62</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="VideoInput-63"><a href="#VideoInput-63"><span class="linenos"> 63</span></a>
</span><span id="VideoInput-64"><a href="#VideoInput-64"><span class="linenos"> 64</span></a>    <span class="n">rgb</span><span class="p">:</span> <span class="n">Array</span>  <span class="c1"># [num_frames, height_rgb, width_rgb, 3]</span>
</span><span id="VideoInput-65"><a href="#VideoInput-65"><span class="linenos"> 65</span></a>    <span class="n">xyz</span><span class="p">:</span> <span class="n">Array</span>  <span class="c1"># [num_frames, height_depth, width_depth, 3]</span>
</span><span id="VideoInput-66"><a href="#VideoInput-66"><span class="linenos"> 66</span></a>    <span class="n">camera_positions</span><span class="p">:</span> <span class="n">Array</span>  <span class="c1"># [num_frames, 3]</span>
</span><span id="VideoInput-67"><a href="#VideoInput-67"><span class="linenos"> 67</span></a>    <span class="n">camera_quaternions</span><span class="p">:</span> <span class="n">Array</span>  <span class="c1"># [num_frames, 4]</span>
</span><span id="VideoInput-68"><a href="#VideoInput-68"><span class="linenos"> 68</span></a>    <span class="n">camera_intrinsics_rgb</span><span class="p">:</span> <span class="p">(</span>
</span><span id="VideoInput-69"><a href="#VideoInput-69"><span class="linenos"> 69</span></a>        <span class="n">Array</span>  <span class="c1"># [8,] (width_rgb, height_rgb, fx, fy, cx, cy, near, far)</span>
</span><span id="VideoInput-70"><a href="#VideoInput-70"><span class="linenos"> 70</span></a>    <span class="p">)</span>
</span><span id="VideoInput-71"><a href="#VideoInput-71"><span class="linenos"> 71</span></a>    <span class="n">camera_intrinsics_depth</span><span class="p">:</span> <span class="p">(</span>
</span><span id="VideoInput-72"><a href="#VideoInput-72"><span class="linenos"> 72</span></a>        <span class="n">Array</span>  <span class="c1"># [8,] (width_depth, height_depth, fx, fy, cx, cy, near, far)</span>
</span><span id="VideoInput-73"><a href="#VideoInput-73"><span class="linenos"> 73</span></a>    <span class="p">)</span>
</span><span id="VideoInput-74"><a href="#VideoInput-74"><span class="linenos"> 74</span></a>
</span><span id="VideoInput-75"><a href="#VideoInput-75"><span class="linenos"> 75</span></a>    <span class="nd">@property</span>
</span><span id="VideoInput-76"><a href="#VideoInput-76"><span class="linenos"> 76</span></a>    <span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VideoInput-77"><a href="#VideoInput-77"><span class="linenos"> 77</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="VideoInput-78"><a href="#VideoInput-78"><span class="linenos"> 78</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
</span><span id="VideoInput-79"><a href="#VideoInput-79"><span class="linenos"> 79</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="VideoInput-80"><a href="#VideoInput-80"><span class="linenos"> 80</span></a>            <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
</span><span id="VideoInput-81"><a href="#VideoInput-81"><span class="linenos"> 81</span></a>
</span><span id="VideoInput-82"><a href="#VideoInput-82"><span class="linenos"> 82</span></a>    <span class="nd">@property</span>
</span><span id="VideoInput-83"><a href="#VideoInput-83"><span class="linenos"> 83</span></a>    <span class="k">def</span> <span class="nf">depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VideoInput-84"><a href="#VideoInput-84"><span class="linenos"> 84</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span>
</span><span id="VideoInput-85"><a href="#VideoInput-85"><span class="linenos"> 85</span></a>
</span><span id="VideoInput-86"><a href="#VideoInput-86"><span class="linenos"> 86</span></a>    <span class="nd">@property</span>
</span><span id="VideoInput-87"><a href="#VideoInput-87"><span class="linenos"> 87</span></a>    <span class="k">def</span> <span class="nf">rgbd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VideoInput-88"><a href="#VideoInput-88"><span class="linenos"> 88</span></a>        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="VideoInput-89"><a href="#VideoInput-89"><span class="linenos"> 89</span></a>
</span><span id="VideoInput-90"><a href="#VideoInput-90"><span class="linenos"> 90</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="VideoInput-91"><a href="#VideoInput-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="VideoInput-92"><a href="#VideoInput-92"><span class="linenos"> 92</span></a>        <span class="n">rgb</span><span class="p">,</span>
</span><span id="VideoInput-93"><a href="#VideoInput-93"><span class="linenos"> 93</span></a>        <span class="n">xyz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="VideoInput-94"><a href="#VideoInput-94"><span class="linenos"> 94</span></a>        <span class="n">camera_positions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="VideoInput-95"><a href="#VideoInput-95"><span class="linenos"> 95</span></a>        <span class="n">camera_quaternions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="VideoInput-96"><a href="#VideoInput-96"><span class="linenos"> 96</span></a>        <span class="n">camera_intrinsics_rgb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="VideoInput-97"><a href="#VideoInput-97"><span class="linenos"> 97</span></a>        <span class="n">camera_intrinsics_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="VideoInput-98"><a href="#VideoInput-98"><span class="linenos"> 98</span></a>        <span class="n">fps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="VideoInput-99"><a href="#VideoInput-99"><span class="linenos"> 99</span></a>    <span class="p">):</span>
</span><span id="VideoInput-100"><a href="#VideoInput-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">rgb</span>
</span><span id="VideoInput-101"><a href="#VideoInput-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span> <span class="o">=</span> <span class="n">xyz</span>
</span><span id="VideoInput-102"><a href="#VideoInput-102"><span class="linenos">102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_positions</span> <span class="o">=</span> <span class="n">camera_positions</span>
</span><span id="VideoInput-103"><a href="#VideoInput-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternions</span> <span class="o">=</span> <span class="n">camera_quaternions</span>
</span><span id="VideoInput-104"><a href="#VideoInput-104"><span class="linenos">104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_rgb</span> <span class="o">=</span> <span class="n">camera_intrinsics_rgb</span>
</span><span id="VideoInput-105"><a href="#VideoInput-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_depth</span> <span class="o">=</span> <span class="n">camera_intrinsics_depth</span>
</span><span id="VideoInput-106"><a href="#VideoInput-106"><span class="linenos">106</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fps</span> <span class="o">=</span> <span class="n">fps</span>
</span><span id="VideoInput-107"><a href="#VideoInput-107"><span class="linenos">107</span></a>
</span><span id="VideoInput-108"><a href="#VideoInput-108"><span class="linenos">108</span></a>    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VideoInput-109"><a href="#VideoInput-109"><span class="linenos">109</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span id="VideoInput-110"><a href="#VideoInput-110"><span class="linenos">110</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="VideoInput-111"><a href="#VideoInput-111"><span class="linenos">111</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="VideoInput-112"><a href="#VideoInput-112"><span class="linenos">112</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="VideoInput-113"><a href="#VideoInput-113"><span class="linenos">113</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">jnp</span><span class="o">.</span><span class="n">uint8</span>
</span><span id="VideoInput-114"><a href="#VideoInput-114"><span class="linenos">114</span></a>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span>
</span><span id="VideoInput-115"><a href="#VideoInput-115"><span class="linenos">115</span></a>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span>
</span><span id="VideoInput-116"><a href="#VideoInput-116"><span class="linenos">116</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
</span><span id="VideoInput-117"><a href="#VideoInput-117"><span class="linenos">117</span></a>        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span>
</span><span id="VideoInput-118"><a href="#VideoInput-118"><span class="linenos">118</span></a>
</span><span id="VideoInput-119"><a href="#VideoInput-119"><span class="linenos">119</span></a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VideoInput-120"><a href="#VideoInput-120"><span class="linenos">120</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="VideoInput-121"><a href="#VideoInput-121"><span class="linenos">121</span></a>            <span class="s2">&quot;rgb&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="p">,</span>
</span><span id="VideoInput-122"><a href="#VideoInput-122"><span class="linenos">122</span></a>            <span class="s2">&quot;xyz&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="p">,</span>
</span><span id="VideoInput-123"><a href="#VideoInput-123"><span class="linenos">123</span></a>            <span class="s2">&quot;camera_positions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_positions</span><span class="p">,</span>
</span><span id="VideoInput-124"><a href="#VideoInput-124"><span class="linenos">124</span></a>            <span class="s2">&quot;camera_quaternions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternions</span><span class="p">,</span>
</span><span id="VideoInput-125"><a href="#VideoInput-125"><span class="linenos">125</span></a>            <span class="s2">&quot;camera_intrinsics_rgb&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_rgb</span><span class="p">,</span>
</span><span id="VideoInput-126"><a href="#VideoInput-126"><span class="linenos">126</span></a>            <span class="s2">&quot;camera_intrinsics_depth&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_depth</span><span class="p">,</span>
</span><span id="VideoInput-127"><a href="#VideoInput-127"><span class="linenos">127</span></a>            <span class="s2">&quot;fps&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="p">,</span>
</span><span id="VideoInput-128"><a href="#VideoInput-128"><span class="linenos">128</span></a>        <span class="p">}</span>
</span><span id="VideoInput-129"><a href="#VideoInput-129"><span class="linenos">129</span></a>
</span><span id="VideoInput-130"><a href="#VideoInput-130"><span class="linenos">130</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="VideoInput-131"><a href="#VideoInput-131"><span class="linenos">131</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves VideoInput to file&quot;&quot;&quot;</span>
</span><span id="VideoInput-132"><a href="#VideoInput-132"><span class="linenos">132</span></a>        <span class="n">jnp</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span>
</span><span id="VideoInput-133"><a href="#VideoInput-133"><span class="linenos">133</span></a>            <span class="n">filepath</span><span class="p">,</span>
</span><span id="VideoInput-134"><a href="#VideoInput-134"><span class="linenos">134</span></a>            <span class="n">rgb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="p">,</span>
</span><span id="VideoInput-135"><a href="#VideoInput-135"><span class="linenos">135</span></a>            <span class="n">xyz</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="p">,</span>
</span><span id="VideoInput-136"><a href="#VideoInput-136"><span class="linenos">136</span></a>            <span class="n">camera_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_positions</span><span class="p">,</span>
</span><span id="VideoInput-137"><a href="#VideoInput-137"><span class="linenos">137</span></a>            <span class="n">camera_quaternions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternions</span><span class="p">,</span>
</span><span id="VideoInput-138"><a href="#VideoInput-138"><span class="linenos">138</span></a>            <span class="n">camera_intrinsics_rgb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_rgb</span><span class="p">,</span>
</span><span id="VideoInput-139"><a href="#VideoInput-139"><span class="linenos">139</span></a>            <span class="n">camera_intrinsics_depth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_depth</span><span class="p">,</span>
</span><span id="VideoInput-140"><a href="#VideoInput-140"><span class="linenos">140</span></a>            <span class="n">fps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="p">,</span>
</span><span id="VideoInput-141"><a href="#VideoInput-141"><span class="linenos">141</span></a>        <span class="p">)</span>
</span><span id="VideoInput-142"><a href="#VideoInput-142"><span class="linenos">142</span></a>
</span><span id="VideoInput-143"><a href="#VideoInput-143"><span class="linenos">143</span></a>    <span class="k">def</span> <span class="nf">save_in_timeframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">start_t</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_t</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="VideoInput-144"><a href="#VideoInput-144"><span class="linenos">144</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves new VideoInput containing data</span>
</span><span id="VideoInput-145"><a href="#VideoInput-145"><span class="linenos">145</span></a><span class="sd">        between a timeframe into file&quot;&quot;&quot;</span>
</span><span id="VideoInput-146"><a href="#VideoInput-146"><span class="linenos">146</span></a>        <span class="n">jnp</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span>
</span><span id="VideoInput-147"><a href="#VideoInput-147"><span class="linenos">147</span></a>            <span class="n">filepath</span><span class="p">,</span>
</span><span id="VideoInput-148"><a href="#VideoInput-148"><span class="linenos">148</span></a>            <span class="n">rgb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="p">[</span><span class="n">start_t</span><span class="p">:</span><span class="n">end_t</span><span class="p">],</span>
</span><span id="VideoInput-149"><a href="#VideoInput-149"><span class="linenos">149</span></a>            <span class="n">xyz</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="n">start_t</span><span class="p">:</span><span class="n">end_t</span><span class="p">],</span>
</span><span id="VideoInput-150"><a href="#VideoInput-150"><span class="linenos">150</span></a>            <span class="n">camera_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_positions</span><span class="p">[</span><span class="n">start_t</span><span class="p">:</span><span class="n">end_t</span><span class="p">],</span>
</span><span id="VideoInput-151"><a href="#VideoInput-151"><span class="linenos">151</span></a>            <span class="n">camera_quaternions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternions</span><span class="p">[</span><span class="n">start_t</span><span class="p">:</span><span class="n">end_t</span><span class="p">],</span>
</span><span id="VideoInput-152"><a href="#VideoInput-152"><span class="linenos">152</span></a>            <span class="n">camera_intrinsics_rgb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_rgb</span><span class="p">,</span>
</span><span id="VideoInput-153"><a href="#VideoInput-153"><span class="linenos">153</span></a>            <span class="n">camera_intrinsics_depth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_depth</span><span class="p">,</span>
</span><span id="VideoInput-154"><a href="#VideoInput-154"><span class="linenos">154</span></a>            <span class="n">fps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="p">,</span>
</span><span id="VideoInput-155"><a href="#VideoInput-155"><span class="linenos">155</span></a>        <span class="p">)</span>
</span><span id="VideoInput-156"><a href="#VideoInput-156"><span class="linenos">156</span></a>
</span><span id="VideoInput-157"><a href="#VideoInput-157"><span class="linenos">157</span></a>    <span class="nd">@classmethod</span>
</span><span id="VideoInput-158"><a href="#VideoInput-158"><span class="linenos">158</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="VideoInput-159"><a href="#VideoInput-159"><span class="linenos">159</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads VideoInput from file&quot;&quot;&quot;</span>
</span><span id="VideoInput-160"><a href="#VideoInput-160"><span class="linenos">160</span></a>
</span><span id="VideoInput-161"><a href="#VideoInput-161"><span class="linenos">161</span></a>        <span class="k">def</span> <span class="nf">jnp_array_or_none</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="VideoInput-162"><a href="#VideoInput-162"><span class="linenos">162</span></a>            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">x</span><span class="p">[()]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="VideoInput-163"><a href="#VideoInput-163"><span class="linenos">163</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="VideoInput-164"><a href="#VideoInput-164"><span class="linenos">164</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="VideoInput-165"><a href="#VideoInput-165"><span class="linenos">165</span></a>                <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="VideoInput-166"><a href="#VideoInput-166"><span class="linenos">166</span></a>
</span><span id="VideoInput-167"><a href="#VideoInput-167"><span class="linenos">167</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="VideoInput-168"><a href="#VideoInput-168"><span class="linenos">168</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="VideoInput-169"><a href="#VideoInput-169"><span class="linenos">169</span></a>
</span><span id="VideoInput-170"><a href="#VideoInput-170"><span class="linenos">170</span></a>            <span class="n">fps</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fps&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;fps&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="VideoInput-171"><a href="#VideoInput-171"><span class="linenos">171</span></a>
</span><span id="VideoInput-172"><a href="#VideoInput-172"><span class="linenos">172</span></a>            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="VideoInput-173"><a href="#VideoInput-173"><span class="linenos">173</span></a>                <span class="n">rgb</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;rgb&quot;</span><span class="p">]),</span>
</span><span id="VideoInput-174"><a href="#VideoInput-174"><span class="linenos">174</span></a>                <span class="n">xyz</span><span class="o">=</span><span class="n">jnp_array_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;xyz&quot;</span><span class="p">]),</span>
</span><span id="VideoInput-175"><a href="#VideoInput-175"><span class="linenos">175</span></a>                <span class="n">camera_positions</span><span class="o">=</span><span class="n">jnp_array_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;camera_positions&quot;</span><span class="p">]),</span>
</span><span id="VideoInput-176"><a href="#VideoInput-176"><span class="linenos">176</span></a>                <span class="n">camera_quaternions</span><span class="o">=</span><span class="n">jnp_array_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;camera_quaternions&quot;</span><span class="p">]),</span>
</span><span id="VideoInput-177"><a href="#VideoInput-177"><span class="linenos">177</span></a>                <span class="n">camera_intrinsics_rgb</span><span class="o">=</span><span class="n">jnp_array_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;camera_intrinsics_rgb&quot;</span><span class="p">]),</span>
</span><span id="VideoInput-178"><a href="#VideoInput-178"><span class="linenos">178</span></a>                <span class="n">camera_intrinsics_depth</span><span class="o">=</span><span class="n">jnp_array_or_none</span><span class="p">(</span>
</span><span id="VideoInput-179"><a href="#VideoInput-179"><span class="linenos">179</span></a>                    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;camera_intrinsics_depth&quot;</span><span class="p">]</span>
</span><span id="VideoInput-180"><a href="#VideoInput-180"><span class="linenos">180</span></a>                <span class="p">),</span>
</span><span id="VideoInput-181"><a href="#VideoInput-181"><span class="linenos">181</span></a>                <span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">,</span>
</span><span id="VideoInput-182"><a href="#VideoInput-182"><span class="linenos">182</span></a>            <span class="p">)</span>
</span><span id="VideoInput-183"><a href="#VideoInput-183"><span class="linenos">183</span></a>
</span><span id="VideoInput-184"><a href="#VideoInput-184"><span class="linenos">184</span></a>    <span class="nd">@property</span>
</span><span id="VideoInput-185"><a href="#VideoInput-185"><span class="linenos">185</span></a>    <span class="k">def</span> <span class="nf">rgb_float</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VideoInput-186"><a href="#VideoInput-186"><span class="linenos">186</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">jnp</span><span class="o">.</span><span class="n">uint8</span><span class="p">:</span>
</span><span id="VideoInput-187"><a href="#VideoInput-187"><span class="linenos">187</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">/</span> <span class="mf">255.0</span>
</span><span id="VideoInput-188"><a href="#VideoInput-188"><span class="linenos">188</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="VideoInput-189"><a href="#VideoInput-189"><span class="linenos">189</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span>
</span></pre></div>


            <div class="docstring"><p>Video data input. Note: Spatial units are measured in meters.</p>

<p>World Coordinates. The floor is x,y and up is z.
Camera Pose. The camera pose should be interpretted as the z-axis pointing out of the camera,
    x-axis pointing to the right, and y-axis pointing down. This is the OpenCV convention.
Quaternions. We follow scipy.spatial.transform.Rotation.from_quat which uses scalar-last (x, y, z, w)
Camera Intrinsics. We store it as an array of shape (8,) containing width, height, fx, fy, cx, cy, near, far.
    The camera matrix is given by: $$ K = \begin{bmatrix} f_x &amp; 0 &amp; c_x \ 0 &amp; f_y &amp; c_y \ 0 &amp; 0 &amp; 1 \end{bmatrix} $$
Spatial units. Spatial units are measured in meters (if not indicated otherwise).</p>

<p><strong>Attributes:</strong></p>

<ul>
<li>rgb
video_input['rgb'][t,i,j] contains RGB values in the interval [0,255] of pixel i,j at time t.
Shape: (T,H,W,3) -- Note this might be different from the width and height of xyz
Type: uint8, in [0,255]</li>
<li>xyz
video_input['xyz'][t,i,j] is the 3d point associated with pixel i,j at time t in camera coordinates
Shape: (T, H', W', 3) -- Note this might be different from the width and height of rgb
Type: Float</li>
<li>camera_positions
video_input['camera_positions'][t] is the position of the camera at time t
Shape: (T, 3)
Type: Float</li>
<li>camera_quaternions
video_input['camera_quaternions'][t] is the quaternion (in xyzw format) representing the orientation of the camera at time t
Shape: (T, 4)
Type: Float</li>
<li>camera_intrinsics_rgb
video_input['camera_intrinsics_rgb'][:] contains width, height, fx, fy, cx, cy, near, far. Width and height determine the shape of rgb above
Shape: (8,)
Type: Float</li>
<li>camera_intrinsics_depth
video_input['camera_intrinsics_depth'][:] contains width, height, fx, fy, cx, cy, near, far. Width and height determine the shape of xyz above
Shape: (8,)
Type: Float</li>
<li>fps
Frames per second of the video
Type: Float</li>
</ul>

<p><strong>Note:</strong>
For compactness, rgb values are saved as uint8 values, however
the output of the renderer is a float between 0 and 1. VideoInput
stores uint8 colors, so please use the rgb_float property for
compatibility.</p>

<p><strong>Note:</strong>
The width and height of the <code><a href="#VideoInput.rgb">rgb</a></code> and <code><a href="#VideoInput.xyz">xyz</a></code> arrays may differ.
Their shapes match the entries in <code><a href="#VideoInput.camera_intrinsics_rgb">camera_intrinsics_rgb</a></code> and
<code><a href="#VideoInput.camera_intrinsics_depth">camera_intrinsics_depth</a></code>, respectively. The latter was used
to project the <code><a href="#VideoInput.depth">depth</a></code> arrays to <code><a href="#VideoInput.xyz">xyz</a></code>.</p>
</div>


                            <div id="VideoInput.__init__" class="classattr">
                                        <input id="VideoInput.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="name">VideoInput</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">rgb</span>,</span><span class="param">	<span class="n">xyz</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">camera_positions</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">camera_quaternions</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">camera_intrinsics_rgb</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">camera_intrinsics_depth</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">fps</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="VideoInput.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VideoInput.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VideoInput.__init__-90"><a href="#VideoInput.__init__-90"><span class="linenos"> 90</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="VideoInput.__init__-91"><a href="#VideoInput.__init__-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="VideoInput.__init__-92"><a href="#VideoInput.__init__-92"><span class="linenos"> 92</span></a>        <span class="n">rgb</span><span class="p">,</span>
</span><span id="VideoInput.__init__-93"><a href="#VideoInput.__init__-93"><span class="linenos"> 93</span></a>        <span class="n">xyz</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="VideoInput.__init__-94"><a href="#VideoInput.__init__-94"><span class="linenos"> 94</span></a>        <span class="n">camera_positions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="VideoInput.__init__-95"><a href="#VideoInput.__init__-95"><span class="linenos"> 95</span></a>        <span class="n">camera_quaternions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="VideoInput.__init__-96"><a href="#VideoInput.__init__-96"><span class="linenos"> 96</span></a>        <span class="n">camera_intrinsics_rgb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="VideoInput.__init__-97"><a href="#VideoInput.__init__-97"><span class="linenos"> 97</span></a>        <span class="n">camera_intrinsics_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="VideoInput.__init__-98"><a href="#VideoInput.__init__-98"><span class="linenos"> 98</span></a>        <span class="n">fps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="VideoInput.__init__-99"><a href="#VideoInput.__init__-99"><span class="linenos"> 99</span></a>    <span class="p">):</span>
</span><span id="VideoInput.__init__-100"><a href="#VideoInput.__init__-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">rgb</span>
</span><span id="VideoInput.__init__-101"><a href="#VideoInput.__init__-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span> <span class="o">=</span> <span class="n">xyz</span>
</span><span id="VideoInput.__init__-102"><a href="#VideoInput.__init__-102"><span class="linenos">102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_positions</span> <span class="o">=</span> <span class="n">camera_positions</span>
</span><span id="VideoInput.__init__-103"><a href="#VideoInput.__init__-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternions</span> <span class="o">=</span> <span class="n">camera_quaternions</span>
</span><span id="VideoInput.__init__-104"><a href="#VideoInput.__init__-104"><span class="linenos">104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_rgb</span> <span class="o">=</span> <span class="n">camera_intrinsics_rgb</span>
</span><span id="VideoInput.__init__-105"><a href="#VideoInput.__init__-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_depth</span> <span class="o">=</span> <span class="n">camera_intrinsics_depth</span>
</span><span id="VideoInput.__init__-106"><a href="#VideoInput.__init__-106"><span class="linenos">106</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fps</span> <span class="o">=</span> <span class="n">fps</span>
</span></pre></div>




                            </div>
                            <div id="VideoInput.rgb" class="classattr">
                                <div class="attr variable">
            <span class="name">rgb</span><span class="annotation">: jax.Array</span>


    </div>
    <a class="headerlink" href="#VideoInput.rgb"></a>



                            </div>
                            <div id="VideoInput.xyz" class="classattr">
                                <div class="attr variable">
            <span class="name">xyz</span><span class="annotation">: jax.Array</span>


    </div>
    <a class="headerlink" href="#VideoInput.xyz"></a>



                            </div>
                            <div id="VideoInput.camera_positions" class="classattr">
                                <div class="attr variable">
            <span class="name">camera_positions</span><span class="annotation">: jax.Array</span>


    </div>
    <a class="headerlink" href="#VideoInput.camera_positions"></a>



                            </div>
                            <div id="VideoInput.camera_quaternions" class="classattr">
                                <div class="attr variable">
            <span class="name">camera_quaternions</span><span class="annotation">: jax.Array</span>


    </div>
    <a class="headerlink" href="#VideoInput.camera_quaternions"></a>



                            </div>
                            <div id="VideoInput.camera_intrinsics_rgb" class="classattr">
                                <div class="attr variable">
            <span class="name">camera_intrinsics_rgb</span><span class="annotation">: jax.Array</span>


    </div>
    <a class="headerlink" href="#VideoInput.camera_intrinsics_rgb"></a>



                            </div>
                            <div id="VideoInput.camera_intrinsics_depth" class="classattr">
                                <div class="attr variable">
            <span class="name">camera_intrinsics_depth</span><span class="annotation">: jax.Array</span>


    </div>
    <a class="headerlink" href="#VideoInput.camera_intrinsics_depth"></a>



                            </div>
                            <div id="VideoInput.z" class="classattr">
                                        <input id="VideoInput.z-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">z</span>

                <label class="view-source-button" for="VideoInput.z-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VideoInput.z"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VideoInput.z-75"><a href="#VideoInput.z-75"><span class="linenos">75</span></a>    <span class="nd">@property</span>
</span><span id="VideoInput.z-76"><a href="#VideoInput.z-76"><span class="linenos">76</span></a>    <span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VideoInput.z-77"><a href="#VideoInput.z-77"><span class="linenos">77</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="VideoInput.z-78"><a href="#VideoInput.z-78"><span class="linenos">78</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
</span><span id="VideoInput.z-79"><a href="#VideoInput.z-79"><span class="linenos">79</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="VideoInput.z-80"><a href="#VideoInput.z-80"><span class="linenos">80</span></a>            <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
</span></pre></div>




                            </div>
                            <div id="VideoInput.depth" class="classattr">
                                        <input id="VideoInput.depth-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">depth</span>

                <label class="view-source-button" for="VideoInput.depth-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VideoInput.depth"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VideoInput.depth-82"><a href="#VideoInput.depth-82"><span class="linenos">82</span></a>    <span class="nd">@property</span>
</span><span id="VideoInput.depth-83"><a href="#VideoInput.depth-83"><span class="linenos">83</span></a>    <span class="k">def</span> <span class="nf">depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VideoInput.depth-84"><a href="#VideoInput.depth-84"><span class="linenos">84</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span>
</span></pre></div>




                            </div>
                            <div id="VideoInput.rgbd" class="classattr">
                                        <input id="VideoInput.rgbd-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">rgbd</span>

                <label class="view-source-button" for="VideoInput.rgbd-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VideoInput.rgbd"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VideoInput.rgbd-86"><a href="#VideoInput.rgbd-86"><span class="linenos">86</span></a>    <span class="nd">@property</span>
</span><span id="VideoInput.rgbd-87"><a href="#VideoInput.rgbd-87"><span class="linenos">87</span></a>    <span class="k">def</span> <span class="nf">rgbd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VideoInput.rgbd-88"><a href="#VideoInput.rgbd-88"><span class="linenos">88</span></a>        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>




                            </div>
                            <div id="VideoInput.fps" class="classattr">
                                <div class="attr variable">
            <span class="name">fps</span>


    </div>
    <a class="headerlink" href="#VideoInput.fps"></a>



                            </div>
                            <div id="VideoInput.to_dict" class="classattr">
                                        <input id="VideoInput.to_dict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">to_dict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="VideoInput.to_dict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VideoInput.to_dict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VideoInput.to_dict-119"><a href="#VideoInput.to_dict-119"><span class="linenos">119</span></a>    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VideoInput.to_dict-120"><a href="#VideoInput.to_dict-120"><span class="linenos">120</span></a>        <span class="k">return</span> <span class="p">{</span>
</span><span id="VideoInput.to_dict-121"><a href="#VideoInput.to_dict-121"><span class="linenos">121</span></a>            <span class="s2">&quot;rgb&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="p">,</span>
</span><span id="VideoInput.to_dict-122"><a href="#VideoInput.to_dict-122"><span class="linenos">122</span></a>            <span class="s2">&quot;xyz&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="p">,</span>
</span><span id="VideoInput.to_dict-123"><a href="#VideoInput.to_dict-123"><span class="linenos">123</span></a>            <span class="s2">&quot;camera_positions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_positions</span><span class="p">,</span>
</span><span id="VideoInput.to_dict-124"><a href="#VideoInput.to_dict-124"><span class="linenos">124</span></a>            <span class="s2">&quot;camera_quaternions&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternions</span><span class="p">,</span>
</span><span id="VideoInput.to_dict-125"><a href="#VideoInput.to_dict-125"><span class="linenos">125</span></a>            <span class="s2">&quot;camera_intrinsics_rgb&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_rgb</span><span class="p">,</span>
</span><span id="VideoInput.to_dict-126"><a href="#VideoInput.to_dict-126"><span class="linenos">126</span></a>            <span class="s2">&quot;camera_intrinsics_depth&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_depth</span><span class="p">,</span>
</span><span id="VideoInput.to_dict-127"><a href="#VideoInput.to_dict-127"><span class="linenos">127</span></a>            <span class="s2">&quot;fps&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="p">,</span>
</span><span id="VideoInput.to_dict-128"><a href="#VideoInput.to_dict-128"><span class="linenos">128</span></a>        <span class="p">}</span>
</span></pre></div>




                            </div>
                            <div id="VideoInput.save" class="classattr">
                                        <input id="VideoInput.save-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">save</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="VideoInput.save-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VideoInput.save"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VideoInput.save-130"><a href="#VideoInput.save-130"><span class="linenos">130</span></a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="VideoInput.save-131"><a href="#VideoInput.save-131"><span class="linenos">131</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves VideoInput to file&quot;&quot;&quot;</span>
</span><span id="VideoInput.save-132"><a href="#VideoInput.save-132"><span class="linenos">132</span></a>        <span class="n">jnp</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span>
</span><span id="VideoInput.save-133"><a href="#VideoInput.save-133"><span class="linenos">133</span></a>            <span class="n">filepath</span><span class="p">,</span>
</span><span id="VideoInput.save-134"><a href="#VideoInput.save-134"><span class="linenos">134</span></a>            <span class="n">rgb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="p">,</span>
</span><span id="VideoInput.save-135"><a href="#VideoInput.save-135"><span class="linenos">135</span></a>            <span class="n">xyz</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="p">,</span>
</span><span id="VideoInput.save-136"><a href="#VideoInput.save-136"><span class="linenos">136</span></a>            <span class="n">camera_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_positions</span><span class="p">,</span>
</span><span id="VideoInput.save-137"><a href="#VideoInput.save-137"><span class="linenos">137</span></a>            <span class="n">camera_quaternions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternions</span><span class="p">,</span>
</span><span id="VideoInput.save-138"><a href="#VideoInput.save-138"><span class="linenos">138</span></a>            <span class="n">camera_intrinsics_rgb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_rgb</span><span class="p">,</span>
</span><span id="VideoInput.save-139"><a href="#VideoInput.save-139"><span class="linenos">139</span></a>            <span class="n">camera_intrinsics_depth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_depth</span><span class="p">,</span>
</span><span id="VideoInput.save-140"><a href="#VideoInput.save-140"><span class="linenos">140</span></a>            <span class="n">fps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="p">,</span>
</span><span id="VideoInput.save-141"><a href="#VideoInput.save-141"><span class="linenos">141</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Saves VideoInput to file</p>
</div>


                            </div>
                            <div id="VideoInput.save_in_timeframe" class="classattr">
                                        <input id="VideoInput.save_in_timeframe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">save_in_timeframe</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">start_t</span><span class="p">:</span> <span class="nb">int</span>, </span><span class="param"><span class="n">end_t</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="VideoInput.save_in_timeframe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VideoInput.save_in_timeframe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VideoInput.save_in_timeframe-143"><a href="#VideoInput.save_in_timeframe-143"><span class="linenos">143</span></a>    <span class="k">def</span> <span class="nf">save_in_timeframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">start_t</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_t</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="VideoInput.save_in_timeframe-144"><a href="#VideoInput.save_in_timeframe-144"><span class="linenos">144</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves new VideoInput containing data</span>
</span><span id="VideoInput.save_in_timeframe-145"><a href="#VideoInput.save_in_timeframe-145"><span class="linenos">145</span></a><span class="sd">        between a timeframe into file&quot;&quot;&quot;</span>
</span><span id="VideoInput.save_in_timeframe-146"><a href="#VideoInput.save_in_timeframe-146"><span class="linenos">146</span></a>        <span class="n">jnp</span><span class="o">.</span><span class="n">savez</span><span class="p">(</span>
</span><span id="VideoInput.save_in_timeframe-147"><a href="#VideoInput.save_in_timeframe-147"><span class="linenos">147</span></a>            <span class="n">filepath</span><span class="p">,</span>
</span><span id="VideoInput.save_in_timeframe-148"><a href="#VideoInput.save_in_timeframe-148"><span class="linenos">148</span></a>            <span class="n">rgb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="p">[</span><span class="n">start_t</span><span class="p">:</span><span class="n">end_t</span><span class="p">],</span>
</span><span id="VideoInput.save_in_timeframe-149"><a href="#VideoInput.save_in_timeframe-149"><span class="linenos">149</span></a>            <span class="n">xyz</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="n">start_t</span><span class="p">:</span><span class="n">end_t</span><span class="p">],</span>
</span><span id="VideoInput.save_in_timeframe-150"><a href="#VideoInput.save_in_timeframe-150"><span class="linenos">150</span></a>            <span class="n">camera_positions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_positions</span><span class="p">[</span><span class="n">start_t</span><span class="p">:</span><span class="n">end_t</span><span class="p">],</span>
</span><span id="VideoInput.save_in_timeframe-151"><a href="#VideoInput.save_in_timeframe-151"><span class="linenos">151</span></a>            <span class="n">camera_quaternions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_quaternions</span><span class="p">[</span><span class="n">start_t</span><span class="p">:</span><span class="n">end_t</span><span class="p">],</span>
</span><span id="VideoInput.save_in_timeframe-152"><a href="#VideoInput.save_in_timeframe-152"><span class="linenos">152</span></a>            <span class="n">camera_intrinsics_rgb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_rgb</span><span class="p">,</span>
</span><span id="VideoInput.save_in_timeframe-153"><a href="#VideoInput.save_in_timeframe-153"><span class="linenos">153</span></a>            <span class="n">camera_intrinsics_depth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">camera_intrinsics_depth</span><span class="p">,</span>
</span><span id="VideoInput.save_in_timeframe-154"><a href="#VideoInput.save_in_timeframe-154"><span class="linenos">154</span></a>            <span class="n">fps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fps</span><span class="p">,</span>
</span><span id="VideoInput.save_in_timeframe-155"><a href="#VideoInput.save_in_timeframe-155"><span class="linenos">155</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Saves new VideoInput containing data
between a timeframe into file</p>
</div>


                            </div>
                            <div id="VideoInput.load" class="classattr">
                                        <input id="VideoInput.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="VideoInput.load-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VideoInput.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VideoInput.load-157"><a href="#VideoInput.load-157"><span class="linenos">157</span></a>    <span class="nd">@classmethod</span>
</span><span id="VideoInput.load-158"><a href="#VideoInput.load-158"><span class="linenos">158</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filepath</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="VideoInput.load-159"><a href="#VideoInput.load-159"><span class="linenos">159</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads VideoInput from file&quot;&quot;&quot;</span>
</span><span id="VideoInput.load-160"><a href="#VideoInput.load-160"><span class="linenos">160</span></a>
</span><span id="VideoInput.load-161"><a href="#VideoInput.load-161"><span class="linenos">161</span></a>        <span class="k">def</span> <span class="nf">jnp_array_or_none</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="VideoInput.load-162"><a href="#VideoInput.load-162"><span class="linenos">162</span></a>            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">x</span><span class="p">[()]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="VideoInput.load-163"><a href="#VideoInput.load-163"><span class="linenos">163</span></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="VideoInput.load-164"><a href="#VideoInput.load-164"><span class="linenos">164</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="VideoInput.load-165"><a href="#VideoInput.load-165"><span class="linenos">165</span></a>                <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="VideoInput.load-166"><a href="#VideoInput.load-166"><span class="linenos">166</span></a>
</span><span id="VideoInput.load-167"><a href="#VideoInput.load-167"><span class="linenos">167</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="VideoInput.load-168"><a href="#VideoInput.load-168"><span class="linenos">168</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="VideoInput.load-169"><a href="#VideoInput.load-169"><span class="linenos">169</span></a>
</span><span id="VideoInput.load-170"><a href="#VideoInput.load-170"><span class="linenos">170</span></a>            <span class="n">fps</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;fps&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;fps&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="VideoInput.load-171"><a href="#VideoInput.load-171"><span class="linenos">171</span></a>
</span><span id="VideoInput.load-172"><a href="#VideoInput.load-172"><span class="linenos">172</span></a>            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
</span><span id="VideoInput.load-173"><a href="#VideoInput.load-173"><span class="linenos">173</span></a>                <span class="n">rgb</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;rgb&quot;</span><span class="p">]),</span>
</span><span id="VideoInput.load-174"><a href="#VideoInput.load-174"><span class="linenos">174</span></a>                <span class="n">xyz</span><span class="o">=</span><span class="n">jnp_array_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;xyz&quot;</span><span class="p">]),</span>
</span><span id="VideoInput.load-175"><a href="#VideoInput.load-175"><span class="linenos">175</span></a>                <span class="n">camera_positions</span><span class="o">=</span><span class="n">jnp_array_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;camera_positions&quot;</span><span class="p">]),</span>
</span><span id="VideoInput.load-176"><a href="#VideoInput.load-176"><span class="linenos">176</span></a>                <span class="n">camera_quaternions</span><span class="o">=</span><span class="n">jnp_array_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;camera_quaternions&quot;</span><span class="p">]),</span>
</span><span id="VideoInput.load-177"><a href="#VideoInput.load-177"><span class="linenos">177</span></a>                <span class="n">camera_intrinsics_rgb</span><span class="o">=</span><span class="n">jnp_array_or_none</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;camera_intrinsics_rgb&quot;</span><span class="p">]),</span>
</span><span id="VideoInput.load-178"><a href="#VideoInput.load-178"><span class="linenos">178</span></a>                <span class="n">camera_intrinsics_depth</span><span class="o">=</span><span class="n">jnp_array_or_none</span><span class="p">(</span>
</span><span id="VideoInput.load-179"><a href="#VideoInput.load-179"><span class="linenos">179</span></a>                    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;camera_intrinsics_depth&quot;</span><span class="p">]</span>
</span><span id="VideoInput.load-180"><a href="#VideoInput.load-180"><span class="linenos">180</span></a>                <span class="p">),</span>
</span><span id="VideoInput.load-181"><a href="#VideoInput.load-181"><span class="linenos">181</span></a>                <span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">,</span>
</span><span id="VideoInput.load-182"><a href="#VideoInput.load-182"><span class="linenos">182</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Loads VideoInput from file</p>
</div>


                            </div>
                            <div id="VideoInput.rgb_float" class="classattr">
                                        <input id="VideoInput.rgb_float-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">rgb_float</span>

                <label class="view-source-button" for="VideoInput.rgb_float-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VideoInput.rgb_float"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VideoInput.rgb_float-184"><a href="#VideoInput.rgb_float-184"><span class="linenos">184</span></a>    <span class="nd">@property</span>
</span><span id="VideoInput.rgb_float-185"><a href="#VideoInput.rgb_float-185"><span class="linenos">185</span></a>    <span class="k">def</span> <span class="nf">rgb_float</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="VideoInput.rgb_float-186"><a href="#VideoInput.rgb_float-186"><span class="linenos">186</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">jnp</span><span class="o">.</span><span class="n">uint8</span><span class="p">:</span>
</span><span id="VideoInput.rgb_float-187"><a href="#VideoInput.rgb_float-187"><span class="linenos">187</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span> <span class="o">/</span> <span class="mf">255.0</span>
</span><span id="VideoInput.rgb_float-188"><a href="#VideoInput.rgb_float-188"><span class="linenos">188</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="VideoInput.rgb_float-189"><a href="#VideoInput.rgb_float-189"><span class="linenos">189</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rgb</span>
</span></pre></div>




                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>
