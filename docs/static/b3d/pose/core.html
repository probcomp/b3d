<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.4.0"/>
    <title>b3d.pose.core API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
    }
</style><style>
    .pdoc .mermaid-pre {
        border: none;
        background: none;
    }
</style>
<script type="module" defer>
    import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";

    /* Re-invoke Mermaid when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => mermaid.run()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../pose.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;b3d.pose</a>

            <img src="https://github.com/probcomp/b3d/assets/66085644/50bc2fc3-c9cd-4139-bed6-9c6d53933622" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Array">Array</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#Array.dtype">dtype</a>
                        </li>
                        <li>
                                <a class="variable" href="#Array.ndim">ndim</a>
                        </li>
                        <li>
                                <a class="variable" href="#Array.size">size</a>
                        </li>
                        <li>
                                <a class="variable" href="#Array.shape">shape</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.addressable_data">addressable_data</a>
                        </li>
                        <li>
                                <a class="variable" href="#Array.addressable_shards">addressable_shards</a>
                        </li>
                        <li>
                                <a class="variable" href="#Array.global_shards">global_shards</a>
                        </li>
                        <li>
                                <a class="variable" href="#Array.is_fully_addressable">is_fully_addressable</a>
                        </li>
                        <li>
                                <a class="variable" href="#Array.is_fully_replicated">is_fully_replicated</a>
                        </li>
                        <li>
                                <a class="variable" href="#Array.sharding">sharding</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.all">all</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.any">any</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.argmax">argmax</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.argmin">argmin</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.argpartition">argpartition</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.argsort">argsort</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.astype">astype</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.choose">choose</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.clip">clip</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.conj">conj</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.conjugate">conjugate</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.compress">compress</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.copy">copy</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.cumprod">cumprod</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.cumsum">cumsum</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.diagonal">diagonal</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.dot">dot</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.flatten">flatten</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.item">item</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.max">max</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.mean">mean</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.min">min</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.nonzero">nonzero</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.prod">prod</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.ptp">ptp</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.ravel">ravel</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.repeat">repeat</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.reshape">reshape</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.round">round</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.searchsorted">searchsorted</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.sort">sort</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.squeeze">squeeze</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.std">std</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.sum">sum</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.swapaxes">swapaxes</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.take">take</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.trace">trace</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.transpose">transpose</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.var">var</a>
                        </li>
                        <li>
                                <a class="function" href="#Array.view">view</a>
                        </li>
                        <li>
                                <a class="variable" href="#Array.flat">flat</a>
                        </li>
                        <li>
                                <a class="variable" href="#Array.T">T</a>
                        </li>
                        <li>
                                <a class="variable" href="#Array.mT">mT</a>
                        </li>
                        <li>
                                <a class="variable" href="#Array.real">real</a>
                        </li>
                        <li>
                                <a class="variable" href="#Array.imag">imag</a>
                        </li>
                        <li>
                                <a class="variable" href="#Array.nbytes">nbytes</a>
                        </li>
                        <li>
                                <a class="variable" href="#Array.itemsize">itemsize</a>
                        </li>
                        <li>
                                <a class="variable" href="#Array.at">at</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#Float">Float</a>
            </li>
            <li>
                    <a class="variable" href="#Int">Int</a>
            </li>
            <li>
                    <a class="variable" href="#Quaternion">Quaternion</a>
            </li>
            <li>
                    <a class="function" href="#multiply_quats">multiply_quats</a>
            </li>
            <li>
                    <a class="function" href="#multiply_quat_and_vec">multiply_quat_and_vec</a>
            </li>
            <li>
                    <a class="function" href="#choose_good_quat">choose_good_quat</a>
            </li>
            <li>
                    <a class="function" href="#sample_uniform_pose">sample_uniform_pose</a>
            </li>
            <li>
                    <a class="function" href="#logpdf_uniform_pose">logpdf_uniform_pose</a>
            </li>
            <li>
                    <a class="function" href="#sample_gaussian_vmf_pose">sample_gaussian_vmf_pose</a>
            </li>
            <li>
                    <a class="function" href="#logpdf_gaussian_vmf_pose">logpdf_gaussian_vmf_pose</a>
            </li>
            <li>
                    <a class="function" href="#camera_from_position_and_target">camera_from_position_and_target</a>
            </li>
            <li>
                    <a class="class" href="#Pose">Pose</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Pose.__init__">Pose</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.identity_quaternion">identity_quaternion</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.unit_quaternion">unit_quaternion</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.pos">pos</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.position">position</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.xyzw">xyzw</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.quat">quat</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.quaternion">quaternion</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.wxyz">wxyz</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.rot">rot</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.normalize">normalize</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.quat_in_upper_hemisphere">quat_in_upper_hemisphere</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.canonical">canonical</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.flatten">flatten</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.tree_flatten">tree_flatten</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.tree_unflatten">tree_unflatten</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.copy">copy</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.flat">flat</a>
                        </li>
                        <li>
                                <a class="variable" href="#Pose.shape">shape</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.reshape">reshape</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.slice">slice</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.as_matrix">as_matrix</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.identity">identity</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.eye">eye</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.id">id</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.apply">apply</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.compose">compose</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.scale">scale</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.concatenate_poses">concatenate_poses</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.concat">concat</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.stack_poses">stack_poses</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.split">split</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.inv">inv</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.inverse">inverse</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.from_matrix">from_matrix</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.from_xyzw">from_xyzw</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.from_quat">from_quat</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.from_pos">from_pos</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.from_translation">from_translation</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.from_vec">from_vec</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.from_pos_matrix">from_pos_matrix</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.from_position_and_target">from_position_and_target</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.sample_uniform_pose">sample_uniform_pose</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.sample_uniform_pose_vmap">sample_uniform_pose_vmap</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.sample_gaussian_vmf_pose">sample_gaussian_vmf_pose</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.sample_gaussian_vmf_pose_jit">sample_gaussian_vmf_pose_jit</a>
                        </li>
                        <li>
                                <a class="function" href="#Pose.sample_gaussian_vmf_pose_vmap">sample_gaussian_vmf_pose_vmap</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../b3d.html">b3d</a><wbr>.<a href="./../pose.html">pose</a><wbr>.core    </h1>


                        <input id="mod-core-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-core-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TypeAlias</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">import</span> <span class="nn">jax</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">from</span> <span class="nn">jax.scipy.spatial.transform</span> <span class="kn">import</span> <span class="n">Rotation</span> <span class="k">as</span> <span class="n">Rot</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">from</span> <span class="nn">jax.tree_util</span> <span class="kn">import</span> <span class="n">register_pytree_node_class</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">from</span> <span class="nn">tensorflow_probability.substrates</span> <span class="kn">import</span> <span class="n">jax</span> <span class="k">as</span> <span class="n">tfp</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="n">Array</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="n">Float</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="n">Array</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="n">Int</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="n">Array</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="n">Quaternion</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="n">Array</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="k">def</span> <span class="nf">multiply_quats</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">):</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span> <span class="o">*</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="n">q2</span><span class="p">))</span><span class="o">.</span><span class="n">as_quat</span><span class="p">()</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="k">def</span> <span class="nf">multiply_quat_and_vec</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">vs</span><span class="p">):</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>    <span class="k">return</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">vs</span><span class="p">)</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="k">def</span> <span class="nf">choose_good_quat</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">    If the real part of the quaternion is negative, return the antipodal quaternion,</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">    which represents the same rotation. If the real part is zero, there is still ambiguity,</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">    so we&#39;ll iteratively resolve that as well.</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">    Recall that SO(3) is isomorphic to  S^3/x~-x and</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">    also to D^3/~ where x~-x for x in S^2 = \\partial D^3.</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>        <span class="n">q</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>        <span class="n">jnp</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]])</span> <span class="o">*</span> <span class="n">q</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>        <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>            <span class="n">q</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">*</span> <span class="n">q</span><span class="p">,</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>                <span class="n">q</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="o">*</span> <span class="n">q</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])</span> <span class="o">*</span> <span class="n">q</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>            <span class="p">),</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>        <span class="p">),</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>    <span class="p">)</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="k">def</span> <span class="nf">sample_uniform_pose</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">):</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>    <span class="n">keys</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>    <span class="n">pos</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="mi">3</span><span class="p">,))</span> <span class="o">*</span> <span class="p">(</span><span class="n">high</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span> <span class="o">+</span> <span class="n">low</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>    <span class="n">quat</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">4</span><span class="p">,))</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>    <span class="n">quat</span> <span class="o">=</span> <span class="n">quat</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">quat</span><span class="p">)</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>    <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">quat</span><span class="p">)</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="k">def</span> <span class="nf">logpdf_uniform_pose</span><span class="p">(</span><span class="n">pose</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">):</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>    <span class="n">position</span> <span class="o">=</span> <span class="n">pose</span><span class="o">.</span><span class="n">pos</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>    <span class="n">valid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">&lt;=</span> <span class="n">position</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">position</span> <span class="o">&lt;=</span> <span class="n">high</span><span class="p">)</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>    <span class="n">position_score</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">valid</span> <span class="o">*</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">position</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">high</span> <span class="o">-</span> <span class="n">low</span><span class="p">)))</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>    <span class="k">return</span> <span class="n">position_score</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="k">def</span> <span class="nf">sample_gaussian_vmf_pose</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">mean_pose</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">concentration</span><span class="p">):</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">    Samples poses from the product of a diagonal normal distribution (for position) and</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">    a generalized von Mises-Fisher distribution (for quaternion).</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">    Note:</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">    One can view the von MisesFisher distribution over the n-sphere</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">    as the restriction of the normal distribution on R^{n+1}</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">    to the n-sphere. From this viewpoint the concentration is</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">    approximateley the inverse of the variance.</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">    See:</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">    &gt; https://en.wikipedia.org/wiki/Von_Mises%E2%80%93Fisher_distribution#Relation_to_normal_distribution</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>    <span class="kn">from</span> <span class="nn">b3d.utils</span> <span class="kn">import</span> <span class="n">keysplit</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>    <span class="n">_</span><span class="p">,</span> <span class="n">keys</span> <span class="o">=</span> <span class="n">keysplit</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>    <span class="n">var</span> <span class="o">=</span> <span class="n">std</span><span class="o">**</span><span class="mi">2</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mean_pose</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">var</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>    <span class="n">q</span> <span class="o">=</span> <span class="n">tfp</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">VonMisesFisher</span><span class="p">(</span><span class="n">mean_pose</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">concentration</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>        <span class="n">seed</span><span class="o">=</span><span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>    <span class="p">)</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>    <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="k">def</span> <span class="nf">logpdf_gaussian_vmf_pose</span><span class="p">(</span><span class="n">pose</span><span class="p">,</span> <span class="n">mean_pose</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">concentration</span><span class="p">):</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>    <span class="n">translation_score</span> <span class="o">=</span> <span class="n">tfp</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">MultivariateNormalDiag</span><span class="p">(</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>        <span class="n">mean_pose</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">std</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>    <span class="p">)</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">pose</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>    <span class="n">quaternion_score</span> <span class="o">=</span> <span class="n">tfp</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">VonMisesFisher</span><span class="p">(</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>        <span class="n">mean_pose</span><span class="o">.</span><span class="n">quat</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">mean_pose</span><span class="o">.</span><span class="n">quat</span><span class="p">),</span> <span class="n">concentration</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>    <span class="p">)</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">pose</span><span class="o">.</span><span class="n">quat</span><span class="p">)</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>    <span class="k">return</span> <span class="n">translation_score</span> <span class="o">+</span> <span class="n">quaternion_score</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="k">def</span> <span class="nf">camera_from_position_and_target</span><span class="p">(</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>    <span class="n">position</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">up</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="p">):</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">    Create a camera pose at `position` with the camera-z-axis pointint at `target`.</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">    Recall that in world coordinates we assume z-axis is up.</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">    Args:</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">        `position`: 3D position vector of the camera</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">        `target`: 3D position vector of the point to look at</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">        `up`: 3D vector pointing up.</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>    <span class="n">z</span> <span class="o">=</span> <span class="n">target</span> <span class="o">-</span> <span class="n">position</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>    <span class="n">z</span> <span class="o">=</span> <span class="n">z</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">up</span><span class="p">)</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>    <span class="n">rotation_matrix</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">z</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>    <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">rotation_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">as_quat</span><span class="p">())</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="nd">@register_pytree_node_class</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="k">class</span> <span class="nc">Pose</span><span class="p">:</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Pose class with positions and quaternions representing rotation.&quot;&quot;&quot;</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">quaternion</span><span class="p">):</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">        3D rigid transformation</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">        position: 3D translation vector</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">        quaternion: 4D quaternion in xyzw</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">=</span> <span class="n">position</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_quaternion</span> <span class="o">=</span> <span class="n">quaternion</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>    <span class="n">identity_quaternion</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>    <span class="nd">@property</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>    <span class="k">def</span> <span class="nf">unit_quaternion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>        <span class="k">raise</span> <span class="ne">Warning</span><span class="p">(</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>            <span class="s2">&quot;Use `identity_quaternion` instead, a unit quaternion is any quat with norm 1!&quot;</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>        <span class="p">)</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">identity_quaternion</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>    <span class="nd">@property</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>    <span class="k">def</span> <span class="nf">pos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>    <span class="n">position</span> <span class="o">=</span> <span class="n">pos</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>    <span class="nd">@property</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>    <span class="k">def</span> <span class="nf">xyzw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quaternion</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>    <span class="n">quat</span> <span class="o">=</span> <span class="n">xyzw</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>    <span class="n">quaternion</span> <span class="o">=</span> <span class="n">xyzw</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>    <span class="nd">@property</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>    <span class="k">def</span> <span class="nf">wxyz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">quaternion</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">quaternion</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>        <span class="p">)</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>    <span class="nd">@property</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>    <span class="k">def</span> <span class="nf">rot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>        <span class="k">return</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>        <span class="n">quat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">quat</span><span class="p">)</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>    <span class="k">def</span> <span class="nf">quat_in_upper_hemisphere</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>        <span class="n">quat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>        <span class="n">quat</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">quat</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]])</span> <span class="o">*</span> <span class="n">quat</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">quat</span><span class="p">)</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>    <span class="k">def</span> <span class="nf">canonical</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a><span class="sd">        Chooses a canonical representative for the quaternion of the pose, i.e.</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a><span class="sd">        chooses from {q, -q} s.t. q[3] &gt;= 0. Note that if q[3]==0 there is still ambiguity.</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a><span class="sd">        Recall that SO(3) is isomorphic to  S^3/x~-x and</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a><span class="sd">        also to D^3/~ where x~-x for x in S^2 = \\partial D^3.</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>        <span class="n">quat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">choose_good_quat</span><span class="p">(</span><span class="n">quat</span><span class="p">))</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>    <span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>    <span class="k">def</span> <span class="nf">tree_flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>        <span class="k">return</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>    <span class="k">def</span> <span class="nf">tree_unflatten</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span> <span class="n">children</span><span class="p">):</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">*</span><span class="n">children</span><span class="p">)</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">))</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>    <span class="nd">@property</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>    <span class="k">def</span> <span class="nf">flat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>    <span class="nd">@property</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>    <span class="k">def</span> <span class="nf">reshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>        <span class="n">shape</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span> <span class="o">+</span> <span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span> <span class="o">+</span> <span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        <span class="k">raise</span> <span class="ne">StopIteration</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>    <span class="k">def</span> <span class="nf">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>    <span class="k">def</span> <span class="nf">as_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a 4x4 pose matrix.&quot;&quot;&quot;</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>        <span class="n">pose_matrix</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>        <span class="n">pose_matrix</span> <span class="o">=</span> <span class="n">pose_matrix</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>            <span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">)</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>        <span class="p">)</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>        <span class="n">pose_matrix</span> <span class="o">=</span> <span class="n">pose_matrix</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>        <span class="n">pose_matrix</span> <span class="o">=</span> <span class="n">pose_matrix</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>        <span class="k">return</span> <span class="n">pose_matrix</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>    <span class="k">def</span> <span class="nf">identity</span><span class="p">():</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the identity transformation.&quot;&quot;&quot;</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>    <span class="n">eye</span> <span class="o">=</span> <span class="n">identity</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>    <span class="nb">id</span> <span class="o">=</span> <span class="n">identity</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vec</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply pose to vectors.&quot;&quot;&quot;</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>        <span class="k">return</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vec</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply pose to vectors.&quot;&quot;&quot;</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>    <span class="k">def</span> <span class="nf">compose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compose with other pose.&quot;&quot;&quot;</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pose</span><span class="o">.</span><span class="n">pos</span><span class="p">),</span> <span class="n">multiply_quats</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">pose</span><span class="o">.</span><span class="n">xyzw</span><span class="p">))</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>        <span class="c1"># NOTE: this is useful for gradient updates.</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+</span> <span class="n">pose</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span> <span class="o">+</span> <span class="n">pose</span><span class="o">.</span><span class="n">quat</span><span class="p">)</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>        <span class="c1"># NOTE: this is useful for gradient updates.</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">-</span> <span class="n">pose</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span> <span class="o">-</span> <span class="n">pose</span><span class="o">.</span><span class="n">quat</span><span class="p">)</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="n">Float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>        <span class="c1"># NOTE: this is useful for gradient updates.</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="n">Float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>    <span class="k">def</span> <span class="fm">__matmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compose with other poses.&quot;&quot;&quot;</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>        <span class="c1"># TODO: Add test, in particular to lock in matmul vs mul.</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>    <span class="k">def</span> <span class="nf">concatenate_poses</span><span class="p">(</span><span class="n">pose_list</span><span class="p">):</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">pose</span><span class="o">.</span><span class="n">pos</span> <span class="k">for</span> <span class="n">pose</span> <span class="ow">in</span> <span class="n">pose_list</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">pose</span><span class="o">.</span><span class="n">quat</span> <span class="k">for</span> <span class="n">pose</span> <span class="ow">in</span> <span class="n">pose_list</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>        <span class="p">)</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>    <span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poses</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">poses</span><span class="o">.</span><span class="n">pos</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">),</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">poses</span><span class="o">.</span><span class="n">quat</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">),</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>        <span class="p">)</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>    <span class="k">def</span> <span class="nf">stack_poses</span><span class="p">(</span><span class="n">pose_list</span><span class="p">):</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">pose</span><span class="o">.</span><span class="n">pos</span> <span class="k">for</span> <span class="n">pose</span> <span class="ow">in</span> <span class="n">pose_list</span><span class="p">]),</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">pose</span><span class="o">.</span><span class="n">quat</span> <span class="k">for</span> <span class="n">pose</span> <span class="ow">in</span> <span class="n">pose_list</span><span class="p">]),</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>        <span class="p">)</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>            <span class="n">Pose</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">qs</span><span class="p">)</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>            <span class="k">for</span> <span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">qs</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>                <span class="n">jnp</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>            <span class="p">)</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>        <span class="p">]</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>    <span class="k">def</span> <span class="nf">inv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a><span class="sd">        Inverse of pose.</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a><span class="sd">        Note that for rotation matrix R and</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a><span class="sd">        translation vector x we have</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a><span class="sd">        ```</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="sd">            [[ R x ]  [[ R&#39; -R&#39;x ]  = [[ I  0 ]</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a><span class="sd">             [ 0 1 ]]  [ 0    1  ]]      0  1 ]]</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a><span class="sd">        ```</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a><span class="sd">        where R&#39; is the transpose of R.</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>        <span class="n">R_inv</span> <span class="o">=</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">)</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="o">-</span><span class="n">R_inv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">),</span> <span class="n">R_inv</span><span class="o">.</span><span class="n">as_quat</span><span class="p">())</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>    <span class="n">inverse</span> <span class="o">=</span> <span class="n">inv</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Pose(position=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span><span class="si">}</span><span class="s2">, quaternion=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>    <span class="k">def</span> <span class="nf">from_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an Pose from a 4x4 matrix.&quot;&quot;&quot;</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">as_quat</span><span class="p">())</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>    <span class="k">def</span> <span class="nf">from_xyzw</span><span class="p">(</span><span class="n">xyzw</span><span class="p">):</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pose from a quaternion. With zero translation.&quot;&quot;&quot;</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="o">*</span><span class="n">xyzw</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">xyzw</span><span class="p">)</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>    <span class="n">from_quat</span> <span class="o">=</span> <span class="n">from_xyzw</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>    <span class="k">def</span> <span class="nf">from_pos</span><span class="p">(</span><span class="n">position_vec</span><span class="p">):</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pose from a vector. With the identity rotation.&quot;&quot;&quot;</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>            <span class="n">position_vec</span><span class="p">,</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span> <span class="p">(</span><span class="o">*</span><span class="n">position_vec</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)),</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>        <span class="p">)</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>    <span class="n">from_translation</span> <span class="o">=</span> <span class="n">from_pos</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>    <span class="k">def</span> <span class="nf">from_vec</span><span class="p">(</span><span class="n">posxyzw</span><span class="p">):</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a><span class="sd">        Creates a Pose from a 7-vector [p_x, p_y, p_z, q_x, q_y, q_z, q_w]</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a><span class="sd">        where p is the position and q is the quaternion for the rotation.</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a><span class="sd">        Args:</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a><span class="sd">            posxyzw: Jax array with shape (7,)</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">posxyzw</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">posxyzw</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>    <span class="k">def</span> <span class="nf">from_pos_matrix</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">matrix</span><span class="p">):</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an Pose from a position and a 3x3 matrix.&quot;&quot;&quot;</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">as_quat</span><span class="p">())</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>    <span class="c1"># TODO: Should we keep that on the Pose class?</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>    <span class="n">from_position_and_target</span> <span class="o">=</span> <span class="n">camera_from_position_and_target</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>    <span class="n">sample_uniform_pose</span> <span class="o">=</span> <span class="n">sample_uniform_pose</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>    <span class="n">sample_uniform_pose_vmap</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>        <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">sample_uniform_pose</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>    <span class="p">)</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>    <span class="n">sample_gaussian_vmf_pose</span> <span class="o">=</span> <span class="n">sample_gaussian_vmf_pose</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>    <span class="n">sample_gaussian_vmf_pose_jit</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">sample_gaussian_vmf_pose</span><span class="p">)</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>    <span class="n">sample_gaussian_vmf_pose_vmap</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>        <span class="n">sample_gaussian_vmf_pose</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>    <span class="p">)</span>
</span></pre></div>


            </section>
                <section id="Array">
                    <div class="attr class">

    <span class="def">class</span>
    <span class="name">Array</span><wbr>(<span class="base">abc.ABC</span>):


    </div>
    <a class="headerlink" href="#Array"></a>

            <div class="docstring"><p>Array base class for JAX</p>

<p><code><a href="#Array">Array</a></code> is the public interface for instance checks and type annotation
of JAX arrays and tracers. Its main applications are in instance checks and
type annotations; for example::</p>

<p>x = jnp.arange(5)
  isinstance(x, <a href="#Array">Array</a>)  # returns True both inside and outside traced functions.</p>

<p>def f(x: Array) -> Array:  # type annotations are valid for traced and non-traced types.
    return x</p>

<p><code><a href="#Array">Array</a></code> should not be used directly for creation of arrays; instead you
should use array creation routines offered in <code>jax.numpy</code>, such as
<code>jax.numpy.array()</code>, <code>jax.numpy.zeros()</code>, <code>jax.numpy.ones()</code>,
<code>jax.numpy.full()</code>, <code>jax.numpy.arange()</code>, etc.</p>
</div>


                            <div id="Array.dtype" class="classattr">
                                        <input id="Array.dtype-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">dtype</span><span class="annotation">: numpy.dtype</span>

                <label class="view-source-button" for="Array.dtype-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.dtype"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.dtype-57"><a href="#Array.dtype-57"><span class="linenos">57</span></a>  <span class="nd">@property</span>
</span><span id="Array.dtype-58"><a href="#Array.dtype-58"><span class="linenos">58</span></a>  <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="Array.dtype-59"><a href="#Array.dtype-59"><span class="linenos">59</span></a>  <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
</span><span id="Array.dtype-60"><a href="#Array.dtype-60"><span class="linenos">60</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The data type (:class:`numpy.dtype`) of the array.&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>The data type (<code>numpy.dtype</code>) of the array.</p>
</div>


                            </div>
                            <div id="Array.ndim" class="classattr">
                                        <input id="Array.ndim-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">ndim</span><span class="annotation">: int</span>

                <label class="view-source-button" for="Array.ndim-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.ndim"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.ndim-62"><a href="#Array.ndim-62"><span class="linenos">62</span></a>  <span class="nd">@property</span>
</span><span id="Array.ndim-63"><a href="#Array.ndim-63"><span class="linenos">63</span></a>  <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="Array.ndim-64"><a href="#Array.ndim-64"><span class="linenos">64</span></a>  <span class="k">def</span> <span class="nf">ndim</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Array.ndim-65"><a href="#Array.ndim-65"><span class="linenos">65</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The number of dimensions in the array.&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>The number of dimensions in the array.</p>
</div>


                            </div>
                            <div id="Array.size" class="classattr">
                                        <input id="Array.size-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">size</span><span class="annotation">: int</span>

                <label class="view-source-button" for="Array.size-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.size"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.size-67"><a href="#Array.size-67"><span class="linenos">67</span></a>  <span class="nd">@property</span>
</span><span id="Array.size-68"><a href="#Array.size-68"><span class="linenos">68</span></a>  <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="Array.size-69"><a href="#Array.size-69"><span class="linenos">69</span></a>  <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Array.size-70"><a href="#Array.size-70"><span class="linenos">70</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The total number of elements in the array.&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>The total number of elements in the array.</p>
</div>


                            </div>
                            <div id="Array.shape" class="classattr">
                                        <input id="Array.shape-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">shape</span><span class="annotation">: tuple[int, ...]</span>

                <label class="view-source-button" for="Array.shape-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.shape"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.shape-72"><a href="#Array.shape-72"><span class="linenos">72</span></a>  <span class="nd">@property</span>
</span><span id="Array.shape-73"><a href="#Array.shape-73"><span class="linenos">73</span></a>  <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="Array.shape-74"><a href="#Array.shape-74"><span class="linenos">74</span></a>  <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
</span><span id="Array.shape-75"><a href="#Array.shape-75"><span class="linenos">75</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The shape of the array.&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>The shape of the array.</p>
</div>


                            </div>
                            <div id="Array.addressable_data" class="classattr">
                                        <input id="Array.addressable_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@abc.abstractmethod</div>

        <span class="def">def</span>
        <span class="name">addressable_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">index</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.addressable_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.addressable_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.addressable_data-78"><a href="#Array.addressable_data-78"><span class="linenos">78</span></a>  <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="Array.addressable_data-79"><a href="#Array.addressable_data-79"><span class="linenos">79</span></a>  <span class="k">def</span> <span class="nf">addressable_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.addressable_data-80"><a href="#Array.addressable_data-80"><span class="linenos">80</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an array of the addressable data at a particular index.&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Return an array of the addressable data at a particular index.</p>
</div>


                            </div>
                            <div id="Array.addressable_shards" class="classattr">
                                        <input id="Array.addressable_shards-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">addressable_shards</span><span class="annotation">: collections.abc.Sequence[typing.Any]</span>

                <label class="view-source-button" for="Array.addressable_shards-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.addressable_shards"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.addressable_shards-82"><a href="#Array.addressable_shards-82"><span class="linenos">82</span></a>  <span class="nd">@property</span>
</span><span id="Array.addressable_shards-83"><a href="#Array.addressable_shards-83"><span class="linenos">83</span></a>  <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="Array.addressable_shards-84"><a href="#Array.addressable_shards-84"><span class="linenos">84</span></a>  <span class="k">def</span> <span class="nf">addressable_shards</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Shard</span><span class="p">]:</span>
</span><span id="Array.addressable_shards-85"><a href="#Array.addressable_shards-85"><span class="linenos">85</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;List of addressable shards.&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>List of addressable shards.</p>
</div>


                            </div>
                            <div id="Array.global_shards" class="classattr">
                                        <input id="Array.global_shards-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">global_shards</span><span class="annotation">: collections.abc.Sequence[typing.Any]</span>

                <label class="view-source-button" for="Array.global_shards-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.global_shards"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.global_shards-87"><a href="#Array.global_shards-87"><span class="linenos">87</span></a>  <span class="nd">@property</span>
</span><span id="Array.global_shards-88"><a href="#Array.global_shards-88"><span class="linenos">88</span></a>  <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="Array.global_shards-89"><a href="#Array.global_shards-89"><span class="linenos">89</span></a>  <span class="k">def</span> <span class="nf">global_shards</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Shard</span><span class="p">]:</span>
</span><span id="Array.global_shards-90"><a href="#Array.global_shards-90"><span class="linenos">90</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;List of global shards.&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>List of global shards.</p>
</div>


                            </div>
                            <div id="Array.is_fully_addressable" class="classattr">
                                        <input id="Array.is_fully_addressable-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">is_fully_addressable</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="Array.is_fully_addressable-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.is_fully_addressable"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.is_fully_addressable-92"><a href="#Array.is_fully_addressable-92"><span class="linenos"> 92</span></a>  <span class="nd">@property</span>
</span><span id="Array.is_fully_addressable-93"><a href="#Array.is_fully_addressable-93"><span class="linenos"> 93</span></a>  <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="Array.is_fully_addressable-94"><a href="#Array.is_fully_addressable-94"><span class="linenos"> 94</span></a>  <span class="k">def</span> <span class="nf">is_fully_addressable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Array.is_fully_addressable-95"><a href="#Array.is_fully_addressable-95"><span class="linenos"> 95</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Is this Array fully addressable?</span>
</span><span id="Array.is_fully_addressable-96"><a href="#Array.is_fully_addressable-96"><span class="linenos"> 96</span></a>
</span><span id="Array.is_fully_addressable-97"><a href="#Array.is_fully_addressable-97"><span class="linenos"> 97</span></a><span class="sd">    A jax.Array is fully addressable if the current process can address all of</span>
</span><span id="Array.is_fully_addressable-98"><a href="#Array.is_fully_addressable-98"><span class="linenos"> 98</span></a><span class="sd">    the devices named in the :class:`Sharding`. ``is_fully_addressable`` is</span>
</span><span id="Array.is_fully_addressable-99"><a href="#Array.is_fully_addressable-99"><span class="linenos"> 99</span></a><span class="sd">    equivalent to &quot;is_local&quot; in multi-process JAX.</span>
</span><span id="Array.is_fully_addressable-100"><a href="#Array.is_fully_addressable-100"><span class="linenos">100</span></a>
</span><span id="Array.is_fully_addressable-101"><a href="#Array.is_fully_addressable-101"><span class="linenos">101</span></a><span class="sd">    Note that fully replicated is not equal to fully addressable i.e.</span>
</span><span id="Array.is_fully_addressable-102"><a href="#Array.is_fully_addressable-102"><span class="linenos">102</span></a><span class="sd">    a jax.Array which is fully replicated can span across multiple hosts and is</span>
</span><span id="Array.is_fully_addressable-103"><a href="#Array.is_fully_addressable-103"><span class="linenos">103</span></a><span class="sd">    not fully addressable.</span>
</span><span id="Array.is_fully_addressable-104"><a href="#Array.is_fully_addressable-104"><span class="linenos">104</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Is this Array fully addressable?</p>

<p>A <a href="#Array">Array</a> is fully addressable if the current process can address all of
the devices named in the <code>Sharding</code>. <code><a href="#Array.is_fully_addressable">is_fully_addressable</a></code> is
equivalent to "is_local" in multi-process JAX.</p>

<p>Note that fully replicated is not equal to fully addressable i.e.
a <a href="#Array">Array</a> which is fully replicated can span across multiple hosts and is
not fully addressable.</p>
</div>


                            </div>
                            <div id="Array.is_fully_replicated" class="classattr">
                                        <input id="Array.is_fully_replicated-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">is_fully_replicated</span><span class="annotation">: bool</span>

                <label class="view-source-button" for="Array.is_fully_replicated-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.is_fully_replicated"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.is_fully_replicated-106"><a href="#Array.is_fully_replicated-106"><span class="linenos">106</span></a>  <span class="nd">@property</span>
</span><span id="Array.is_fully_replicated-107"><a href="#Array.is_fully_replicated-107"><span class="linenos">107</span></a>  <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="Array.is_fully_replicated-108"><a href="#Array.is_fully_replicated-108"><span class="linenos">108</span></a>  <span class="k">def</span> <span class="nf">is_fully_replicated</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Array.is_fully_replicated-109"><a href="#Array.is_fully_replicated-109"><span class="linenos">109</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Is this Array fully replicated?&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Is this Array fully replicated?</p>
</div>


                            </div>
                            <div id="Array.sharding" class="classattr">
                                        <input id="Array.sharding-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">sharding</span><span class="annotation">: Any</span>

                <label class="view-source-button" for="Array.sharding-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.sharding"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.sharding-111"><a href="#Array.sharding-111"><span class="linenos">111</span></a>  <span class="nd">@property</span>
</span><span id="Array.sharding-112"><a href="#Array.sharding-112"><span class="linenos">112</span></a>  <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
</span><span id="Array.sharding-113"><a href="#Array.sharding-113"><span class="linenos">113</span></a>  <span class="k">def</span> <span class="nf">sharding</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sharding</span><span class="p">:</span>
</span><span id="Array.sharding-114"><a href="#Array.sharding-114"><span class="linenos">114</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;The sharding for the array.&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>The sharding for the array.</p>
</div>


                            </div>
                            <div id="Array.all" class="classattr">
                                        <input id="Array.all-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@implements(np.all, skip_params=[&#39;out&#39;])</div>

        <span class="def">def</span>
        <span class="name">all</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.all-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.all"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.all-293"><a href="#Array.all-293"><span class="linenos">293</span></a><span class="nd">@implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">])</span>
</span><span id="Array.all-294"><a href="#Array.all-294"><span class="linenos">294</span></a><span class="k">def</span> <span class="nf">all</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.all-295"><a href="#Array.all-295"><span class="linenos">295</span></a>        <span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">where</span><span class="p">:</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.all-296"><a href="#Array.all-296"><span class="linenos">296</span></a>  <span class="k">return</span> <span class="n">_reduce_all</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">_ensure_optional_axes</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span>
</span><span id="Array.all-297"><a href="#Array.all-297"><span class="linenos">297</span></a>                     <span class="n">keepdims</span><span class="o">=</span><span class="n">keepdims</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Test whether all array elements along a given axis evaluate to True.</p>

<p>LAX-backend implementation of <code>numpy.all()</code>.</p>

<p><em>Original docstring below.</em></p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Input array or object that can be converted to an array.
axis : None or int or tuple of ints, optional
    Axis or axes along which a logical AND reduction is performed.
    The default (<code>axis=None</code>) is to perform a logical AND over all
    the dimensions of the input array. <code>axis</code> may be negative, in
    which case it counts from the last to the first axis.
keepdims : bool, optional
    If this is set to True, the axes which are reduced are left
    in the result as dimensions with size one. With this option,
    the result will broadcast correctly against the input array.</p>

<pre><code>If the default value is passed, then `keepdims` will not be
passed through to the `all` method of sub-classes of
`ndarray`, however any non-default value will be.  If the
sub-class' method does not implement `keepdims` any
exceptions will be raised.
</code></pre>

<p>where : array_like of bool, optional
    Elements to include in checking for all <code>True</code> values.
    See <code>~numpy.ufunc.reduce</code> for details.</p>

<h2 id="returns">Returns</h2>

<p>all : ndarray, bool
    A new boolean or array is returned unless <code>out</code> is specified,
    in which case a reference to <code>out</code> is returned.</p>
</div>


                            </div>
                            <div id="Array.any" class="classattr">
                                        <input id="Array.any-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@implements(np.any, skip_params=[&#39;out&#39;])</div>

        <span class="def">def</span>
        <span class="name">any</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.any-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.any"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.any-305"><a href="#Array.any-305"><span class="linenos">305</span></a><span class="nd">@implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">])</span>
</span><span id="Array.any-306"><a href="#Array.any-306"><span class="linenos">306</span></a><span class="k">def</span> <span class="nf">any</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.any-307"><a href="#Array.any-307"><span class="linenos">307</span></a>        <span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">where</span><span class="p">:</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.any-308"><a href="#Array.any-308"><span class="linenos">308</span></a>  <span class="k">return</span> <span class="n">_reduce_any</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">_ensure_optional_axes</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span>
</span><span id="Array.any-309"><a href="#Array.any-309"><span class="linenos">309</span></a>                     <span class="n">keepdims</span><span class="o">=</span><span class="n">keepdims</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Test whether any array element along a given axis evaluates to True.</p>

<p>LAX-backend implementation of <code>numpy.any()</code>.</p>

<p><em>Original docstring below.</em></p>

<p>Returns single boolean if <code>axis</code> is <code>None</code></p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Input array or object that can be converted to an array.
axis : None or int or tuple of ints, optional
    Axis or axes along which a logical OR reduction is performed.
    The default (<code>axis=None</code>) is to perform a logical OR over all
    the dimensions of the input array. <code>axis</code> may be negative, in
    which case it counts from the last to the first axis.
keepdims : bool, optional
    If this is set to True, the axes which are reduced are left
    in the result as dimensions with size one. With this option,
    the result will broadcast correctly against the input array.</p>

<pre><code>If the default value is passed, then `keepdims` will not be
passed through to the `any` method of sub-classes of
`ndarray`, however any non-default value will be.  If the
sub-class' method does not implement `keepdims` any
exceptions will be raised.
</code></pre>

<p>where : array_like of bool, optional
    Elements to include in checking for any <code>True</code> values.
    See <code>~numpy.ufunc.reduce</code> for details.</p>

<h2 id="returns">Returns</h2>

<p>any : bool or ndarray
    A new boolean or <code>ndarray</code> is returned unless <code>out</code> is specified,
    in which case a reference to <code>out</code> is returned.</p>
</div>


                            </div>
                            <div id="Array.argmax" class="classattr">
                                        <input id="Array.argmax-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@util.implements(np.argmax, skip_params=[&#39;out&#39;])</div>

        <span class="def">def</span>
        <span class="name">argmax</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.argmax-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.argmax"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.argmax-4896"><a href="#Array.argmax-4896"><span class="linenos">4896</span></a><span class="nd">@util</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">])</span>
</span><span id="Array.argmax-4897"><a href="#Array.argmax-4897"><span class="linenos">4897</span></a><span class="k">def</span> <span class="nf">argmax</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.argmax-4898"><a href="#Array.argmax-4898"><span class="linenos">4898</span></a>           <span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.argmax-4899"><a href="#Array.argmax-4899"><span class="linenos">4899</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;argmax&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Array.argmax-4900"><a href="#Array.argmax-4900"><span class="linenos">4900</span></a>  <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.argmax-4901"><a href="#Array.argmax-4901"><span class="linenos">4901</span></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;The &#39;out&#39; argument to jnp.argmax is not supported.&quot;</span><span class="p">)</span>
</span><span id="Array.argmax-4902"><a href="#Array.argmax-4902"><span class="linenos">4902</span></a>  <span class="k">return</span> <span class="n">_argmax</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">operator</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span>
</span><span id="Array.argmax-4903"><a href="#Array.argmax-4903"><span class="linenos">4903</span></a>                 <span class="n">keepdims</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="n">keepdims</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Returns the indices of the maximum values along an axis.</p>

<p>LAX-backend implementation of <code>numpy.argmax()</code>.</p>

<p><em>Original docstring below.</em></p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Input array.
axis : int, optional
    By default, the index is into the flattened array, otherwise
    along the specified axis.
keepdims : bool, optional
    If this is set to True, the axes which are reduced are left
    in the result as dimensions with size one. With this option,
    the result will broadcast correctly against the array.</p>

<h2 id="returns">Returns</h2>

<p>index_array : ndarray of ints
    Array of indices into the array. It has the same shape as <code>a.shape</code>
    with the dimension along <code>axis</code> removed. If <code>keepdims</code> is set to True,
    then the size of <code>axis</code> will be 1 with the resulting array having same
    shape as <code>a.shape</code>.</p>
</div>


                            </div>
                            <div id="Array.argmin" class="classattr">
                                        <input id="Array.argmin-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@util.implements(np.argmin, skip_params=[&#39;out&#39;])</div>

        <span class="def">def</span>
        <span class="name">argmin</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.argmin-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.argmin"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.argmin-4918"><a href="#Array.argmin-4918"><span class="linenos">4918</span></a><span class="nd">@util</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">])</span>
</span><span id="Array.argmin-4919"><a href="#Array.argmin-4919"><span class="linenos">4919</span></a><span class="k">def</span> <span class="nf">argmin</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.argmin-4920"><a href="#Array.argmin-4920"><span class="linenos">4920</span></a>           <span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.argmin-4921"><a href="#Array.argmin-4921"><span class="linenos">4921</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;argmin&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Array.argmin-4922"><a href="#Array.argmin-4922"><span class="linenos">4922</span></a>  <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.argmin-4923"><a href="#Array.argmin-4923"><span class="linenos">4923</span></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;The &#39;out&#39; argument to jnp.argmin is not supported.&quot;</span><span class="p">)</span>
</span><span id="Array.argmin-4924"><a href="#Array.argmin-4924"><span class="linenos">4924</span></a>  <span class="k">return</span> <span class="n">_argmin</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">operator</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span>
</span><span id="Array.argmin-4925"><a href="#Array.argmin-4925"><span class="linenos">4925</span></a>                 <span class="n">keepdims</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="n">keepdims</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Returns the indices of the minimum values along an axis.</p>

<p>LAX-backend implementation of <code>numpy.argmin()</code>.</p>

<p><em>Original docstring below.</em></p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Input array.
axis : int, optional
    By default, the index is into the flattened array, otherwise
    along the specified axis.
keepdims : bool, optional
    If this is set to True, the axes which are reduced are left
    in the result as dimensions with size one. With this option,
    the result will broadcast correctly against the array.</p>

<h2 id="returns">Returns</h2>

<p>index_array : ndarray of ints
    Array of indices into the array. It has the same shape as <code>a.shape</code>
    with the dimension along <code>axis</code> removed. If <code>keepdims</code> is set to True,
    then the size of <code>axis</code> will be 1 with the resulting array having same
    shape as <code>a.shape</code>.</p>
</div>


                            </div>
                            <div id="Array.argpartition" class="classattr">
                                        <input id="Array.argpartition-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@util.implements(np.argpartition, lax_description=&#34;\nThe JAX version requires the ``kth`` argument to be a static integer rather than\na general array. This is implemented via two calls to :func:`jax.lax.top_k`. If\nyou&#39;re only accessing the top or bottom k values of the output, it may be more\nefficient to call :func:`jax.lax.top_k` directly.\n\nThe JAX version differs from the NumPy version in the treatment of NaN entries;\nNaNs which have the negative bit set are sorted to the beginning of the array.\n&#34;)</div>
        <div class="decorator">@partial(jit, static_argnames=[&#39;kth&#39;, &#39;axis&#39;])</div>

        <span class="def">def</span>
        <span class="name">argpartition</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">kth</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.argpartition-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.argpartition"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.argpartition-5121"><a href="#Array.argpartition-5121"><span class="linenos">5121</span></a><span class="nd">@util</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argpartition</span><span class="p">,</span> <span class="n">lax_description</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="Array.argpartition-5122"><a href="#Array.argpartition-5122"><span class="linenos">5122</span></a><span class="s2">The JAX version requires the ``kth`` argument to be a static integer rather than</span>
</span><span id="Array.argpartition-5123"><a href="#Array.argpartition-5123"><span class="linenos">5123</span></a><span class="s2">a general array. This is implemented via two calls to :func:`jax.lax.top_k`. If</span>
</span><span id="Array.argpartition-5124"><a href="#Array.argpartition-5124"><span class="linenos">5124</span></a><span class="s2">you&#39;re only accessing the top or bottom k values of the output, it may be more</span>
</span><span id="Array.argpartition-5125"><a href="#Array.argpartition-5125"><span class="linenos">5125</span></a><span class="s2">efficient to call :func:`jax.lax.top_k` directly.</span>
</span><span id="Array.argpartition-5126"><a href="#Array.argpartition-5126"><span class="linenos">5126</span></a>
</span><span id="Array.argpartition-5127"><a href="#Array.argpartition-5127"><span class="linenos">5127</span></a><span class="s2">The JAX version differs from the NumPy version in the treatment of NaN entries;</span>
</span><span id="Array.argpartition-5128"><a href="#Array.argpartition-5128"><span class="linenos">5128</span></a><span class="s2">NaNs which have the negative bit set are sorted to the beginning of the array.</span>
</span><span id="Array.argpartition-5129"><a href="#Array.argpartition-5129"><span class="linenos">5129</span></a><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</span><span id="Array.argpartition-5130"><a href="#Array.argpartition-5130"><span class="linenos">5130</span></a><span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;kth&#39;</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">])</span>
</span><span id="Array.argpartition-5131"><a href="#Array.argpartition-5131"><span class="linenos">5131</span></a><span class="k">def</span> <span class="nf">argpartition</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">kth</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.argpartition-5132"><a href="#Array.argpartition-5132"><span class="linenos">5132</span></a>  <span class="c1"># TODO(jakevdp): handle NaN values like numpy.</span>
</span><span id="Array.argpartition-5133"><a href="#Array.argpartition-5133"><span class="linenos">5133</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;partition&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Array.argpartition-5134"><a href="#Array.argpartition-5134"><span class="linenos">5134</span></a>  <span class="n">arr</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="Array.argpartition-5135"><a href="#Array.argpartition-5135"><span class="linenos">5135</span></a>  <span class="k">if</span> <span class="n">issubdtype</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">complexfloating</span><span class="p">):</span>
</span><span id="Array.argpartition-5136"><a href="#Array.argpartition-5136"><span class="linenos">5136</span></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;jnp.argpartition for complex dtype is not implemented.&quot;</span><span class="p">)</span>
</span><span id="Array.argpartition-5137"><a href="#Array.argpartition-5137"><span class="linenos">5137</span></a>  <span class="n">axis</span> <span class="o">=</span> <span class="n">_canonicalize_axis</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
</span><span id="Array.argpartition-5138"><a href="#Array.argpartition-5138"><span class="linenos">5138</span></a>  <span class="n">kth</span> <span class="o">=</span> <span class="n">_canonicalize_axis</span><span class="p">(</span><span class="n">kth</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">])</span>
</span><span id="Array.argpartition-5139"><a href="#Array.argpartition-5139"><span class="linenos">5139</span></a>
</span><span id="Array.argpartition-5140"><a href="#Array.argpartition-5140"><span class="linenos">5140</span></a>  <span class="n">arr</span> <span class="o">=</span> <span class="n">swapaxes</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Array.argpartition-5141"><a href="#Array.argpartition-5141"><span class="linenos">5141</span></a>  <span class="n">bottom_ind</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">top_k</span><span class="p">(</span><span class="o">-</span><span class="n">arr</span><span class="p">,</span> <span class="n">kth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Array.argpartition-5142"><a href="#Array.argpartition-5142"><span class="linenos">5142</span></a>
</span><span id="Array.argpartition-5143"><a href="#Array.argpartition-5143"><span class="linenos">5143</span></a>  <span class="c1"># To avoid issues with duplicate values, we compute the top indices via a proxy</span>
</span><span id="Array.argpartition-5144"><a href="#Array.argpartition-5144"><span class="linenos">5144</span></a>  <span class="n">set_to_zero</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Array.argpartition-5145"><a href="#Array.argpartition-5145"><span class="linenos">5145</span></a>  <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="Array.argpartition-5146"><a href="#Array.argpartition-5146"><span class="linenos">5146</span></a>    <span class="n">set_to_zero</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">set_to_zero</span><span class="p">)</span>
</span><span id="Array.argpartition-5147"><a href="#Array.argpartition-5147"><span class="linenos">5147</span></a>  <span class="n">proxy</span> <span class="o">=</span> <span class="n">set_to_zero</span><span class="p">(</span><span class="n">ones</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">bottom_ind</span><span class="p">)</span>
</span><span id="Array.argpartition-5148"><a href="#Array.argpartition-5148"><span class="linenos">5148</span></a>  <span class="n">top_ind</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">top_k</span><span class="p">(</span><span class="n">proxy</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">kth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Array.argpartition-5149"><a href="#Array.argpartition-5149"><span class="linenos">5149</span></a>  <span class="n">out</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">bottom_ind</span><span class="p">,</span> <span class="n">top_ind</span><span class="p">],</span> <span class="n">dimension</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Array.argpartition-5150"><a href="#Array.argpartition-5150"><span class="linenos">5150</span></a>  <span class="k">return</span> <span class="n">swapaxes</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Perform an indirect partition along the given axis using the</p>

<p>LAX-backend implementation of <code>numpy.argpartition()</code>.</p>

<p>The JAX version requires the <code>kth</code> argument to be a static integer rather than
a general array. This is implemented via two calls to <code>jax.lax.top_k()</code>. If
you're only accessing the top or bottom k values of the output, it may be more
efficient to call <code>jax.lax.top_k()</code> directly.</p>

<p>The JAX version differs from the NumPy version in the treatment of NaN entries;
NaNs which have the negative bit set are sorted to the beginning of the array.</p>

<p><em>Original docstring below.</em></p>

<p>algorithm specified by the <code>kind</code> keyword. It returns an array of
indices of the same shape as <code>a</code> that index data along the given
axis in partitioned order.</p>

<p><em>New in version 1.8.0.</em></p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Array to sort.
kth : int or sequence of ints
    Element index to partition by. The k-th element will be in its
    final sorted position and all smaller elements will be moved
    before it and all larger elements behind it. The order of all
    elements in the partitions is undefined. If provided with a
    sequence of k-th it will partition all of them into their sorted
    position at once.</p>

<pre><code>*Deprecated since version 1.22.0:*
Passing booleans as index is deprecated.
</code></pre>

<p>axis : int or None, optional
    Axis along which to sort. The default is -1 (the last axis). If
    None, the flattened array is used.</p>

<h2 id="returns">Returns</h2>

<p>index_array : ndarray, int
    Array of indices that partition <code>a</code> along the specified axis.
    If <code>a</code> is one-dimensional, <code>a[index_array]</code> yields a partitioned <code>a</code>.
    More generally, <code>np.take_along_axis(a, index_array, axis=axis)</code>
    always yields the partitioned <code>a</code>, irrespective of dimensionality.</p>
</div>


                            </div>
                            <div id="Array.argsort" class="classattr">
                                        <input id="Array.argsort-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@util.implements(np.argsort, extra_params=&#39;\nstable : bool, default=True\n    Specify whether to use a stable sort.\ndescending : bool, default=False\n    Specify whether to do a descending sort.\nkind : deprecated; specify sort algorithm using stable=True or stable=False\norder : not supported\n    &#39;)</div>
        <div class="decorator">@partial(jit, static_argnames=(&#39;axis&#39;, &#39;kind&#39;, &#39;order&#39;, &#39;stable&#39;, &#39;descending&#39;))</div>

        <span class="def">def</span>
        <span class="name">argsort</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">kind</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">order</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">stable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">descending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.argsort-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.argsort"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.argsort-5052"><a href="#Array.argsort-5052"><span class="linenos">5052</span></a><span class="nd">@util</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">,</span> <span class="n">extra_params</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="Array.argsort-5053"><a href="#Array.argsort-5053"><span class="linenos">5053</span></a><span class="s2">stable : bool, default=True</span>
</span><span id="Array.argsort-5054"><a href="#Array.argsort-5054"><span class="linenos">5054</span></a><span class="s2">    Specify whether to use a stable sort.</span>
</span><span id="Array.argsort-5055"><a href="#Array.argsort-5055"><span class="linenos">5055</span></a><span class="s2">descending : bool, default=False</span>
</span><span id="Array.argsort-5056"><a href="#Array.argsort-5056"><span class="linenos">5056</span></a><span class="s2">    Specify whether to do a descending sort.</span>
</span><span id="Array.argsort-5057"><a href="#Array.argsort-5057"><span class="linenos">5057</span></a><span class="s2">kind : deprecated; specify sort algorithm using stable=True or stable=False</span>
</span><span id="Array.argsort-5058"><a href="#Array.argsort-5058"><span class="linenos">5058</span></a><span class="s2">order : not supported</span>
</span><span id="Array.argsort-5059"><a href="#Array.argsort-5059"><span class="linenos">5059</span></a><span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
</span><span id="Array.argsort-5060"><a href="#Array.argsort-5060"><span class="linenos">5060</span></a><span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnames</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;axis&#39;</span><span class="p">,</span> <span class="s1">&#39;kind&#39;</span><span class="p">,</span> <span class="s1">&#39;order&#39;</span><span class="p">,</span> <span class="s1">&#39;stable&#39;</span><span class="p">,</span> <span class="s1">&#39;descending&#39;</span><span class="p">))</span>
</span><span id="Array.argsort-5061"><a href="#Array.argsort-5061"><span class="linenos">5061</span></a><span class="k">def</span> <span class="nf">argsort</span><span class="p">(</span>
</span><span id="Array.argsort-5062"><a href="#Array.argsort-5062"><span class="linenos">5062</span></a>    <span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
</span><span id="Array.argsort-5063"><a href="#Array.argsort-5063"><span class="linenos">5063</span></a>    <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Array.argsort-5064"><a href="#Array.argsort-5064"><span class="linenos">5064</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="Array.argsort-5065"><a href="#Array.argsort-5065"><span class="linenos">5065</span></a>    <span class="n">kind</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.argsort-5066"><a href="#Array.argsort-5066"><span class="linenos">5066</span></a>    <span class="n">order</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.argsort-5067"><a href="#Array.argsort-5067"><span class="linenos">5067</span></a>    <span class="n">stable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Array.argsort-5068"><a href="#Array.argsort-5068"><span class="linenos">5068</span></a>    <span class="n">descending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Array.argsort-5069"><a href="#Array.argsort-5069"><span class="linenos">5069</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.argsort-5070"><a href="#Array.argsort-5070"><span class="linenos">5070</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;argsort&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Array.argsort-5071"><a href="#Array.argsort-5071"><span class="linenos">5071</span></a>  <span class="n">arr</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="Array.argsort-5072"><a href="#Array.argsort-5072"><span class="linenos">5072</span></a>  <span class="k">if</span> <span class="n">kind</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.argsort-5073"><a href="#Array.argsort-5073"><span class="linenos">5073</span></a>    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;kind&#39; argument to argsort is not supported. Use&quot;</span>
</span><span id="Array.argsort-5074"><a href="#Array.argsort-5074"><span class="linenos">5074</span></a>                    <span class="s2">&quot; stable=True or stable=False to specify sort stability.&quot;</span><span class="p">)</span>
</span><span id="Array.argsort-5075"><a href="#Array.argsort-5075"><span class="linenos">5075</span></a>  <span class="k">if</span> <span class="n">order</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.argsort-5076"><a href="#Array.argsort-5076"><span class="linenos">5076</span></a>    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;order&#39; argument to argsort is not supported.&quot;</span><span class="p">)</span>
</span><span id="Array.argsort-5077"><a href="#Array.argsort-5077"><span class="linenos">5077</span></a>  <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.argsort-5078"><a href="#Array.argsort-5078"><span class="linenos">5078</span></a>    <span class="n">arr</span> <span class="o">=</span> <span class="n">ravel</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
</span><span id="Array.argsort-5079"><a href="#Array.argsort-5079"><span class="linenos">5079</span></a>    <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Array.argsort-5080"><a href="#Array.argsort-5080"><span class="linenos">5080</span></a>  <span class="k">else</span><span class="p">:</span>
</span><span id="Array.argsort-5081"><a href="#Array.argsort-5081"><span class="linenos">5081</span></a>    <span class="n">arr</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="Array.argsort-5082"><a href="#Array.argsort-5082"><span class="linenos">5082</span></a>  <span class="n">dimension</span> <span class="o">=</span> <span class="n">_canonicalize_axis</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
</span><span id="Array.argsort-5083"><a href="#Array.argsort-5083"><span class="linenos">5083</span></a>  <span class="n">use_64bit_index</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">core</span><span class="o">.</span><span class="n">is_constant_dim</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">dimension</span><span class="p">])</span> <span class="ow">or</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">dimension</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">31</span><span class="p">)</span>
</span><span id="Array.argsort-5084"><a href="#Array.argsort-5084"><span class="linenos">5084</span></a>  <span class="n">iota</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">broadcasted_iota</span><span class="p">(</span><span class="n">int64</span> <span class="k">if</span> <span class="n">use_64bit_index</span> <span class="k">else</span> <span class="n">int_</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dimension</span><span class="p">)</span>
</span><span id="Array.argsort-5085"><a href="#Array.argsort-5085"><span class="linenos">5085</span></a>  <span class="c1"># For stable descending sort, we reverse the array and indices to ensure that</span>
</span><span id="Array.argsort-5086"><a href="#Array.argsort-5086"><span class="linenos">5086</span></a>  <span class="c1"># duplicates remain in their original order when the final indices are reversed.</span>
</span><span id="Array.argsort-5087"><a href="#Array.argsort-5087"><span class="linenos">5087</span></a>  <span class="c1"># For non-stable descending sort, we can avoid these extra operations.</span>
</span><span id="Array.argsort-5088"><a href="#Array.argsort-5088"><span class="linenos">5088</span></a>  <span class="k">if</span> <span class="n">descending</span> <span class="ow">and</span> <span class="n">stable</span><span class="p">:</span>
</span><span id="Array.argsort-5089"><a href="#Array.argsort-5089"><span class="linenos">5089</span></a>    <span class="n">arr</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">rev</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="p">[</span><span class="n">dimension</span><span class="p">])</span>
</span><span id="Array.argsort-5090"><a href="#Array.argsort-5090"><span class="linenos">5090</span></a>    <span class="n">iota</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">rev</span><span class="p">(</span><span class="n">iota</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="p">[</span><span class="n">dimension</span><span class="p">])</span>
</span><span id="Array.argsort-5091"><a href="#Array.argsort-5091"><span class="linenos">5091</span></a>  <span class="n">_</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">sort_key_val</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">iota</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="n">dimension</span><span class="p">,</span> <span class="n">is_stable</span><span class="o">=</span><span class="n">stable</span><span class="p">)</span>
</span><span id="Array.argsort-5092"><a href="#Array.argsort-5092"><span class="linenos">5092</span></a>  <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">rev</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="p">[</span><span class="n">dimension</span><span class="p">])</span> <span class="k">if</span> <span class="n">descending</span> <span class="k">else</span> <span class="n">indices</span>
</span></pre></div>


            <div class="docstring"><p>Returns the indices that would sort an array.</p>

<p>LAX-backend implementation of <code>numpy.argsort()</code>.</p>

<p><em>Original docstring below.</em></p>

<p>Perform an indirect sort along the given axis using the algorithm specified
by the <code>kind</code> keyword. It returns an array of indices of the same shape as
<code>a</code> that index data along the given axis in sorted order.</p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Array to sort.
axis : int or None, optional
    Axis along which to sort.  The default is -1 (the last axis). If None,
    the flattened array is used.
kind : deprecated; specify sort algorithm using stable=True or stable=False
order : not supported
stable : bool, default=True
    Specify whether to use a stable sort.
descending : bool, default=False
    Specify whether to do a descending sort.</p>

<h2 id="returns">Returns</h2>

<p>index_array : ndarray, int
    Array of indices that sort <code>a</code> along the specified <code>axis</code>.
    If <code>a</code> is one-dimensional, <code>a[index_array]</code> yields a sorted <code>a</code>.
    More generally, <code>np.take_along_axis(a, index_array, axis=axis)</code>
    always yields the sorted <code>a</code>, irrespective of dimensionality.</p>
</div>


                            </div>
                            <div id="Array.astype" class="classattr">
                                        <input id="Array.astype-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">astype</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">arr</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">_src</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">SupportsDType</span><span class="p">]</span>,</span><span class="param">	<span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">device</span><span class="p">:</span> <span class="n">jaxlib</span><span class="o">.</span><span class="n">xla_extension</span><span class="o">.</span><span class="n">Device</span> <span class="o">|</span> <span class="n">jaxlib</span><span class="o">.</span><span class="n">xla_extension</span><span class="o">.</span><span class="n">Sharding</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.astype-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.astype"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.astype-61"><a href="#Array.astype-61"><span class="linenos">61</span></a><span class="k">def</span> <span class="nf">_astype</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">DTypeLike</span><span class="p">,</span> <span class="n">copy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="n">xc</span><span class="o">.</span><span class="n">Device</span> <span class="o">|</span> <span class="n">Sharding</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.astype-62"><a href="#Array.astype-62"><span class="linenos">62</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Copy the array and cast to a specified dtype.</span>
</span><span id="Array.astype-63"><a href="#Array.astype-63"><span class="linenos">63</span></a>
</span><span id="Array.astype-64"><a href="#Array.astype-64"><span class="linenos">64</span></a><span class="sd">  This is implemented via :func:`jax.lax.convert_element_type`, which may</span>
</span><span id="Array.astype-65"><a href="#Array.astype-65"><span class="linenos">65</span></a><span class="sd">  have slightly different behavior than :meth:`numpy.ndarray.astype` in</span>
</span><span id="Array.astype-66"><a href="#Array.astype-66"><span class="linenos">66</span></a><span class="sd">  some cases. In particular, the details of float-to-int and int-to-float</span>
</span><span id="Array.astype-67"><a href="#Array.astype-67"><span class="linenos">67</span></a><span class="sd">  casts are implementation dependent.</span>
</span><span id="Array.astype-68"><a href="#Array.astype-68"><span class="linenos">68</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="Array.astype-69"><a href="#Array.astype-69"><span class="linenos">69</span></a>  <span class="k">return</span> <span class="n">lax_numpy</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="n">copy</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Copy the array and cast to a specified dtype.</p>

<p>This is implemented via <code>jax.lax.convert_element_type()</code>, which may
have slightly different behavior than <code>numpy.ndarray.astype()</code> in
some cases. In particular, the details of float-to-int and int-to-float
casts are implementation dependent.</p>
</div>


                            </div>
                            <div id="Array.choose" class="classattr">
                                        <input id="Array.choose-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@util.implements(np.choose, skip_params=[&#39;out&#39;])</div>

        <span class="def">def</span>
        <span class="name">choose</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">choices</span><span class="p">:</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]]</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;raise&#39;</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.choose-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.choose"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.choose-2370"><a href="#Array.choose-2370"><span class="linenos">2370</span></a><span class="nd">@util</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">choose</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">])</span>
</span><span id="Array.choose-2371"><a href="#Array.choose-2371"><span class="linenos">2371</span></a><span class="k">def</span> <span class="nf">choose</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">choices</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">],</span>
</span><span id="Array.choose-2372"><a href="#Array.choose-2372"><span class="linenos">2372</span></a>           <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;raise&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.choose-2373"><a href="#Array.choose-2373"><span class="linenos">2373</span></a>  <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.choose-2374"><a href="#Array.choose-2374"><span class="linenos">2374</span></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;The &#39;out&#39; argument to jnp.choose is not supported.&quot;</span><span class="p">)</span>
</span><span id="Array.choose-2375"><a href="#Array.choose-2375"><span class="linenos">2375</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s1">&#39;choose&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="n">choices</span><span class="p">)</span>
</span><span id="Array.choose-2376"><a href="#Array.choose-2376"><span class="linenos">2376</span></a>  <span class="k">if</span> <span class="ow">not</span> <span class="n">issubdtype</span><span class="p">(</span><span class="n">_dtype</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">integer</span><span class="p">):</span>
</span><span id="Array.choose-2377"><a href="#Array.choose-2377"><span class="linenos">2377</span></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`a` array must be integer typed&quot;</span><span class="p">)</span>
</span><span id="Array.choose-2378"><a href="#Array.choose-2378"><span class="linenos">2378</span></a>  <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">choices</span><span class="p">)</span>
</span><span id="Array.choose-2379"><a href="#Array.choose-2379"><span class="linenos">2379</span></a>
</span><span id="Array.choose-2380"><a href="#Array.choose-2380"><span class="linenos">2380</span></a>  <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;raise&#39;</span><span class="p">:</span>
</span><span id="Array.choose-2381"><a href="#Array.choose-2381"><span class="linenos">2381</span></a>    <span class="n">arr</span><span class="p">:</span> <span class="n">Array</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">concrete_or_error</span><span class="p">(</span><span class="n">asarray</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span>
</span><span id="Array.choose-2382"><a href="#Array.choose-2382"><span class="linenos">2382</span></a>      <span class="s2">&quot;The error occurred because jnp.choose was jit-compiled&quot;</span>
</span><span id="Array.choose-2383"><a href="#Array.choose-2383"><span class="linenos">2383</span></a>      <span class="s2">&quot; with mode=&#39;raise&#39;. Use mode=&#39;wrap&#39; or mode=&#39;clip&#39; instead.&quot;</span><span class="p">)</span>
</span><span id="Array.choose-2384"><a href="#Array.choose-2384"><span class="linenos">2384</span></a>    <span class="k">if</span> <span class="n">reductions</span><span class="o">.</span><span class="n">any</span><span class="p">((</span><span class="n">arr</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">arr</span> <span class="o">&gt;=</span> <span class="n">N</span><span class="p">)):</span>
</span><span id="Array.choose-2385"><a href="#Array.choose-2385"><span class="linenos">2385</span></a>      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid entry in choice array&quot;</span><span class="p">)</span>
</span><span id="Array.choose-2386"><a href="#Array.choose-2386"><span class="linenos">2386</span></a>  <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;wrap&#39;</span><span class="p">:</span>
</span><span id="Array.choose-2387"><a href="#Array.choose-2387"><span class="linenos">2387</span></a>    <span class="n">arr</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">%</span> <span class="n">N</span>
</span><span id="Array.choose-2388"><a href="#Array.choose-2388"><span class="linenos">2388</span></a>  <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;clip&#39;</span><span class="p">:</span>
</span><span id="Array.choose-2389"><a href="#Array.choose-2389"><span class="linenos">2389</span></a>    <span class="n">arr</span> <span class="o">=</span> <span class="n">clip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Array.choose-2390"><a href="#Array.choose-2390"><span class="linenos">2390</span></a>  <span class="k">else</span><span class="p">:</span>
</span><span id="Array.choose-2391"><a href="#Array.choose-2391"><span class="linenos">2391</span></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mode=</span><span class="si">{</span><span class="n">mode</span><span class="si">!r}</span><span class="s2"> not understood. Must be &#39;raise&#39;, &#39;wrap&#39;, or &#39;clip&#39;&quot;</span><span class="p">)</span>
</span><span id="Array.choose-2392"><a href="#Array.choose-2392"><span class="linenos">2392</span></a>
</span><span id="Array.choose-2393"><a href="#Array.choose-2393"><span class="linenos">2393</span></a>  <span class="n">arr</span><span class="p">,</span> <span class="o">*</span><span class="n">choices</span> <span class="o">=</span> <span class="n">broadcast_arrays</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="o">*</span><span class="n">choices</span><span class="p">)</span>
</span><span id="Array.choose-2394"><a href="#Array.choose-2394"><span class="linenos">2394</span></a>  <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="n">choices</span><span class="p">)[(</span><span class="n">arr</span><span class="p">,)</span> <span class="o">+</span> <span class="n">indices</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Construct an array from an index array and a list of arrays to choose from.</p>

<p>LAX-backend implementation of <code>numpy.choose()</code>.</p>

<p><em>Original docstring below.</em></p>

<p>First of all, if confused or uncertain, definitely look at the Examples -
in its full generality, this function is less simple than it might
seem from the following code description (below ndi =
<code>numpy.lib.index_tricks</code>):</p>

<p><code>np.choose(a,c) == np.array([c[a[I]][I] for I in ndi.ndindex(a.shape)])</code>.</p>

<p>But this omits some subtleties.  Here is a fully general summary:</p>

<p>Given an "index" array (<code>a</code>) of integers and a sequence of <code>n</code> arrays
(<code>choices</code>), <code>a</code> and each choice array are first broadcast, as necessary,
to arrays of a common shape; calling these <em>Ba</em> and <em>Bchoices[i], i =
0,...,n-1</em> we have that, necessarily, <code>Ba.shape == Bchoices[i].shape</code>
for each <code>i</code>.  Then, a new array with shape <code>Ba.shape</code> is created as
follows:</p>

<ul>
<li><p>if <code>mode='raise'</code> (the default), then, first of all, each element of
<code>a</code> (and thus <code>Ba</code>) must be in the range <code>[0, n-1]</code>; now, suppose
that <code>i</code> (in that range) is the value at the <code>(j0, j1, ..., jm)</code>
position in <code>Ba</code> - then the value at the same position in the new array
is the value in <code>Bchoices[i]</code> at that same position;</p></li>
<li><p>if <code>mode='wrap'</code>, values in <code>a</code> (and thus <code>Ba</code>) may be any (signed)
integer; modular arithmetic is used to map integers outside the range
<code>[0, n-1]</code> back into that range; and then the new array is constructed
as above;</p></li>
<li><p>if <code>mode='clip'</code>, values in <code>a</code> (and thus <code>Ba</code>) may be any (signed)
integer; negative integers are mapped to 0; values greater than <code>n-1</code>
are mapped to <code>n-1</code>; and then the new array is constructed as above.</p></li>
</ul>

<h2 id="parameters">Parameters</h2>

<p>a : int array
    This array must contain integers in <code>[0, n-1]</code>, where <code>n</code> is the
    number of choices, unless <code>mode=wrap</code> or <code>mode=clip</code>, in which
    cases any integers are permissible.
choices : sequence of arrays
    Choice arrays. <code>a</code> and all of the choices must be broadcastable to the
    same shape.  If <code>choices</code> is itself an array (not recommended), then
    its outermost dimension (i.e., the one corresponding to
    <code>choices.shape[0]</code>) is taken as defining the "sequence".
mode : {'raise' (default), 'wrap', 'clip'}, optional
    Specifies how indices outside <code>[0, n-1]</code> will be treated:</p>

<pre><code>  * 'raise' : an exception is raised
  * 'wrap' : value becomes value mod ``n``
  * 'clip' : values &lt; 0 are mapped to 0, values &gt; n-1 are mapped to n-1
</code></pre>

<h2 id="returns">Returns</h2>

<p>merged_array : array
    The merged result.</p>
</div>


                            </div>
                            <div id="Array.clip" class="classattr">
                                        <input id="Array.clip-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">clip</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">number</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="nb">min</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="nb">max</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.clip-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.clip"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.clip-89"><a href="#Array.clip-89"><span class="linenos">89</span></a><span class="k">def</span> <span class="nf">_clip</span><span class="p">(</span><span class="n">number</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
</span><span id="Array.clip-90"><a href="#Array.clip-90"><span class="linenos">90</span></a>          <span class="nb">min</span><span class="p">:</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.clip-91"><a href="#Array.clip-91"><span class="linenos">91</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Return an array whose values are limited to a specified range.</span>
</span><span id="Array.clip-92"><a href="#Array.clip-92"><span class="linenos">92</span></a>
</span><span id="Array.clip-93"><a href="#Array.clip-93"><span class="linenos">93</span></a><span class="sd">  Refer to :func:`jax.numpy.clip` for full documentation.&quot;&quot;&quot;</span>
</span><span id="Array.clip-94"><a href="#Array.clip-94"><span class="linenos">94</span></a>  <span class="k">return</span> <span class="n">lax_numpy</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="nb">max</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return an array whose values are limited to a specified range.</p>

<p>Refer to <code>jax.numpy.clip()</code> for full documentation.</p>
</div>


                            </div>
                            <div id="Array.conj" class="classattr">
                                        <input id="Array.conj-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@implements(np.conjugate, module=&#39;numpy&#39;)</div>
        <div class="decorator">@partial(jit, inline=True)</div>

        <span class="def">def</span>
        <span class="name">conj</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="o">/</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.conj-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.conj"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.conj-635"><a href="#Array.conj-635"><span class="linenos">635</span></a><span class="nd">@implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conjugate</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
</span><span id="Array.conj-636"><a href="#Array.conj-636"><span class="linenos">636</span></a><span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Array.conj-637"><a href="#Array.conj-637"><span class="linenos">637</span></a><span class="k">def</span> <span class="nf">conjugate</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.conj-638"><a href="#Array.conj-638"><span class="linenos">638</span></a>  <span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;conjugate&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Array.conj-639"><a href="#Array.conj-639"><span class="linenos">639</span></a>  <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">lax</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the complex conjugate, element-wise.</p>

<p>LAX-backend implementation of <code>numpy.conjugate()</code>.</p>

<p><em>Original docstring below.</em></p>

<p>The complex conjugate of a complex number is obtained by changing the
sign of its imaginary part.</p>

<h2 id="parameters">Parameters</h2>

<p>x : array_like
    Input value.</p>

<h2 id="returns">Returns</h2>

<p>y : ndarray
    The complex conjugate of <code>x</code>, with same dtype as <code>y</code>.
    This is a scalar if <code>x</code> is a scalar.</p>
</div>


                            </div>
                            <div id="Array.conjugate" class="classattr">
                                        <input id="Array.conjugate-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@implements(np.conjugate, module=&#39;numpy&#39;)</div>
        <div class="decorator">@partial(jit, inline=True)</div>

        <span class="def">def</span>
        <span class="name">conjugate</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="o">/</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.conjugate-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.conjugate"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.conjugate-635"><a href="#Array.conjugate-635"><span class="linenos">635</span></a><span class="nd">@implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conjugate</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
</span><span id="Array.conjugate-636"><a href="#Array.conjugate-636"><span class="linenos">636</span></a><span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Array.conjugate-637"><a href="#Array.conjugate-637"><span class="linenos">637</span></a><span class="k">def</span> <span class="nf">conjugate</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.conjugate-638"><a href="#Array.conjugate-638"><span class="linenos">638</span></a>  <span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;conjugate&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Array.conjugate-639"><a href="#Array.conjugate-639"><span class="linenos">639</span></a>  <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">else</span> <span class="n">lax</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the complex conjugate, element-wise.</p>

<p>LAX-backend implementation of <code>numpy.conjugate()</code>.</p>

<p><em>Original docstring below.</em></p>

<p>The complex conjugate of a complex number is obtained by changing the
sign of its imaginary part.</p>

<h2 id="parameters">Parameters</h2>

<p>x : array_like
    Input value.</p>

<h2 id="returns">Returns</h2>

<p>y : ndarray
    The complex conjugate of <code>x</code>, with same dtype as <code>y</code>.
    This is a scalar if <code>x</code> is a scalar.</p>
</div>


                            </div>
                            <div id="Array.compress" class="classattr">
                                        <input id="Array.compress-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">compress</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">condition</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">fill_value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.compress-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.compress"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.compress-307"><a href="#Array.compress-307"><span class="linenos">307</span></a><span class="k">def</span> <span class="nf">_compress_method</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">condition</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
</span><span id="Array.compress-308"><a href="#Array.compress-308"><span class="linenos">308</span></a>                     <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.compress-309"><a href="#Array.compress-309"><span class="linenos">309</span></a>                     <span class="n">size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fill_value</span><span class="p">:</span> <span class="n">ArrayLike</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.compress-310"><a href="#Array.compress-310"><span class="linenos">310</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Return selected slices of this array along given axis.</span>
</span><span id="Array.compress-311"><a href="#Array.compress-311"><span class="linenos">311</span></a>
</span><span id="Array.compress-312"><a href="#Array.compress-312"><span class="linenos">312</span></a><span class="sd">  Refer to :func:`jax.numpy.compress` for full documentation.&quot;&quot;&quot;</span>
</span><span id="Array.compress-313"><a href="#Array.compress-313"><span class="linenos">313</span></a>  <span class="k">return</span> <span class="n">lax_numpy</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span>
</span><span id="Array.compress-314"><a href="#Array.compress-314"><span class="linenos">314</span></a>                            <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return selected slices of this array along given axis.</p>

<p>Refer to <code>jax.numpy.compress()</code> for full documentation.</p>
</div>


                            </div>
                            <div id="Array.copy" class="classattr">
                                        <input id="Array.copy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@util.implements(np.copy, lax_description=_ARRAY_DOC)</div>

        <span class="def">def</span>
        <span class="name">copy</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.copy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.copy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.copy-2687"><a href="#Array.copy-2687"><span class="linenos">2687</span></a><span class="nd">@util</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">,</span> <span class="n">lax_description</span><span class="o">=</span><span class="n">_ARRAY_DOC</span><span class="p">)</span>
</span><span id="Array.copy-2688"><a href="#Array.copy-2688"><span class="linenos">2688</span></a><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.copy-2689"><a href="#Array.copy-2689"><span class="linenos">2689</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;copy&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Array.copy-2690"><a href="#Array.copy-2690"><span class="linenos">2690</span></a>  <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return an array copy of the given object.</p>

<p>LAX-backend implementation of <code>numpy.copy()</code>.</p>

<p>This function will create arrays on JAX's default device. For control of the
device placement of data, see <code>jax.device_put()</code>. More information is
available in the JAX FAQ at :ref:<code>faq-data-placement</code> (full FAQ at
https://jax.readthedocs.io/en/latest/faq.html).</p>

<p><em>Original docstring below.</em></p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Input data.
order : {'C', 'F', 'A', 'K'}, optional
    Controls the memory layout of the copy. 'C' means C-order,
    'F' means F-order, 'A' means 'F' if <code>a</code> is Fortran contiguous,
    'C' otherwise. 'K' means match the layout of <code>a</code> as closely
    as possible. (Note that this function and <code>ndarray.copy()</code> are very
    similar, but have different default values for their order=
    arguments.)</p>

<h2 id="returns">Returns</h2>

<p>arr : ndarray
    Array interpretation of <code>a</code>.</p>
</div>


                            </div>
                            <div id="Array.cumprod" class="classattr">
                                        <input id="Array.cumprod-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@implements(np_reduction, skip_params=[&#39;out&#39;], lax_description=CUML_REDUCTION_LAX_DESCRIPTION)</div>

        <span class="def">def</span>
        <span class="name">cumprod</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">_src</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">SupportsDType</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.cumprod-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.cumprod"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.cumprod-674"><a href="#Array.cumprod-674"><span class="linenos">674</span></a>  <span class="nd">@implements</span><span class="p">(</span><span class="n">np_reduction</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">],</span>
</span><span id="Array.cumprod-675"><a href="#Array.cumprod-675"><span class="linenos">675</span></a>          <span class="n">lax_description</span><span class="o">=</span><span class="n">CUML_REDUCTION_LAX_DESCRIPTION</span><span class="p">)</span>
</span><span id="Array.cumprod-676"><a href="#Array.cumprod-676"><span class="linenos">676</span></a>  <span class="k">def</span> <span class="nf">cumulative_reduction</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.cumprod-677"><a href="#Array.cumprod-677"><span class="linenos">677</span></a>                           <span class="n">dtype</span><span class="p">:</span> <span class="n">DTypeLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.cumprod-678"><a href="#Array.cumprod-678"><span class="linenos">678</span></a>    <span class="k">return</span> <span class="n">_cumulative_reduction</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">_ensure_optional_axes</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the cumulative product of elements along a given axis.</p>

<p>LAX-backend implementation of <code>numpy.cumprod()</code>.</p>

<p>Unlike the numpy counterpart, when <code><a href="#Array.dtype">dtype</a></code> is not specified the output dtype will always
match the dtype of the input.</p>

<p><em>Original docstring below.</em></p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Input array.
axis : int, optional
    Axis along which the cumulative product is computed.  By default
    the input is flattened.
dtype : dtype, optional
    Type of the returned array, as well as of the accumulator in which
    the elements are multiplied.  If <em>dtype</em> is not specified, it
    defaults to the dtype of <code>a</code>, unless <code>a</code> has an integer dtype with
    a precision less than that of the default platform integer.  In
    that case, the default platform integer is used instead.</p>

<h2 id="returns">Returns</h2>

<p>cumprod : ndarray
    A new array holding the result is returned unless <code>out</code> is
    specified, in which case a reference to out is returned.</p>
</div>


                            </div>
                            <div id="Array.cumsum" class="classattr">
                                        <input id="Array.cumsum-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@implements(np_reduction, skip_params=[&#39;out&#39;], lax_description=CUML_REDUCTION_LAX_DESCRIPTION)</div>

        <span class="def">def</span>
        <span class="name">cumsum</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">_src</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">SupportsDType</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.cumsum-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.cumsum"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.cumsum-674"><a href="#Array.cumsum-674"><span class="linenos">674</span></a>  <span class="nd">@implements</span><span class="p">(</span><span class="n">np_reduction</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">],</span>
</span><span id="Array.cumsum-675"><a href="#Array.cumsum-675"><span class="linenos">675</span></a>          <span class="n">lax_description</span><span class="o">=</span><span class="n">CUML_REDUCTION_LAX_DESCRIPTION</span><span class="p">)</span>
</span><span id="Array.cumsum-676"><a href="#Array.cumsum-676"><span class="linenos">676</span></a>  <span class="k">def</span> <span class="nf">cumulative_reduction</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.cumsum-677"><a href="#Array.cumsum-677"><span class="linenos">677</span></a>                           <span class="n">dtype</span><span class="p">:</span> <span class="n">DTypeLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.cumsum-678"><a href="#Array.cumsum-678"><span class="linenos">678</span></a>    <span class="k">return</span> <span class="n">_cumulative_reduction</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">_ensure_optional_axes</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the cumulative sum of the elements along a given axis.</p>

<p>LAX-backend implementation of <code>numpy.cumsum()</code>.</p>

<p>Unlike the numpy counterpart, when <code><a href="#Array.dtype">dtype</a></code> is not specified the output dtype will always
match the dtype of the input.</p>

<p><em>Original docstring below.</em></p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Input array.
axis : int, optional
    Axis along which the cumulative sum is computed. The default
    (None) is to compute the cumsum over the flattened array.
dtype : dtype, optional
    Type of the returned array and of the accumulator in which the
    elements are summed.  If <code><a href="#Array.dtype">dtype</a></code> is not specified, it defaults
    to the dtype of <code>a</code>, unless <code>a</code> has an integer dtype with a
    precision less than that of the default platform integer.  In
    that case, the default platform integer is used.</p>

<h2 id="returns">Returns</h2>

<p>cumsum_along_axis : ndarray.
    A new array holding the result is returned unless <code>out</code> is
    specified, in which case a reference to <code>out</code> is returned. The
    result has the same size as <code>a</code>, and the same shape as <code>a</code> if
    <code>axis</code> is not None or <code>a</code> is a 1-d array.</p>
</div>


                            </div>
                            <div id="Array.diagonal" class="classattr">
                                        <input id="Array.diagonal-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@util.implements(np.diagonal, lax_description=_ARRAY_VIEW_DOC)</div>
        <div class="decorator">@partial(jit, static_argnames=(&#39;offset&#39;, &#39;axis1&#39;, &#39;axis2&#39;))</div>

        <span class="def">def</span>
        <span class="name">diagonal</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">axis1</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">axis2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.diagonal-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.diagonal"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.diagonal-3530"><a href="#Array.diagonal-3530"><span class="linenos">3530</span></a><span class="nd">@util</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diagonal</span><span class="p">,</span> <span class="n">lax_description</span><span class="o">=</span><span class="n">_ARRAY_VIEW_DOC</span><span class="p">)</span>
</span><span id="Array.diagonal-3531"><a href="#Array.diagonal-3531"><span class="linenos">3531</span></a><span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnames</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;offset&#39;</span><span class="p">,</span> <span class="s1">&#39;axis1&#39;</span><span class="p">,</span> <span class="s1">&#39;axis2&#39;</span><span class="p">))</span>
</span><span id="Array.diagonal-3532"><a href="#Array.diagonal-3532"><span class="linenos">3532</span></a><span class="k">def</span> <span class="nf">diagonal</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis1</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="Array.diagonal-3533"><a href="#Array.diagonal-3533"><span class="linenos">3533</span></a>             <span class="n">axis2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.diagonal-3534"><a href="#Array.diagonal-3534"><span class="linenos">3534</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;diagonal&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Array.diagonal-3535"><a href="#Array.diagonal-3535"><span class="linenos">3535</span></a>  <span class="n">a_shape</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="Array.diagonal-3536"><a href="#Array.diagonal-3536"><span class="linenos">3536</span></a>  <span class="k">if</span> <span class="n">ndim</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Array.diagonal-3537"><a href="#Array.diagonal-3537"><span class="linenos">3537</span></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;diagonal requires an array of at least two dimensions.&quot;</span><span class="p">)</span>
</span><span id="Array.diagonal-3538"><a href="#Array.diagonal-3538"><span class="linenos">3538</span></a>  <span class="n">offset</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">concrete_or_error</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="s2">&quot;&#39;offset&#39; argument of jnp.diagonal()&quot;</span><span class="p">)</span>
</span><span id="Array.diagonal-3539"><a href="#Array.diagonal-3539"><span class="linenos">3539</span></a>
</span><span id="Array.diagonal-3540"><a href="#Array.diagonal-3540"><span class="linenos">3540</span></a>  <span class="n">a</span> <span class="o">=</span> <span class="n">moveaxis</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">axis1</span><span class="p">,</span> <span class="n">axis2</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</span><span id="Array.diagonal-3541"><a href="#Array.diagonal-3541"><span class="linenos">3541</span></a>
</span><span id="Array.diagonal-3542"><a href="#Array.diagonal-3542"><span class="linenos">3542</span></a>  <span class="n">diag_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">a_shape</span><span class="p">[</span><span class="n">axis1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
</span><span id="Array.diagonal-3543"><a href="#Array.diagonal-3543"><span class="linenos">3543</span></a>                         <span class="n">a_shape</span><span class="p">[</span><span class="n">axis2</span><span class="p">]</span> <span class="o">-</span> <span class="nb">max</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
</span><span id="Array.diagonal-3544"><a href="#Array.diagonal-3544"><span class="linenos">3544</span></a>  <span class="n">i</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="n">diag_size</span><span class="p">)</span>
</span><span id="Array.diagonal-3545"><a href="#Array.diagonal-3545"><span class="linenos">3545</span></a>  <span class="n">j</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">offset</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">offset</span><span class="p">)</span> <span class="o">+</span> <span class="n">diag_size</span><span class="p">)</span>
</span><span id="Array.diagonal-3546"><a href="#Array.diagonal-3546"><span class="linenos">3546</span></a>  <span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="k">if</span> <span class="n">offset</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">a</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return specified diagonals.</p>

<p>LAX-backend implementation of <code>numpy.diagonal()</code>.</p>

<p>The JAX version of this function may in some cases return a copy rather than a
view of the input.</p>

<p><em>Original docstring below.</em></p>

<p>If <code>a</code> is 2-D, returns the diagonal of <code>a</code> with the given offset,
i.e., the collection of elements of the form <code>a[i, i+offset]</code>.  If
<code>a</code> has more than two dimensions, then the axes specified by <code>axis1</code>
and <code>axis2</code> are used to determine the 2-D sub-array whose diagonal is
returned.  The shape of the resulting array can be determined by
removing <code>axis1</code> and <code>axis2</code> and appending an index to the right equal
to the size of the resulting diagonals.</p>

<p>In versions of NumPy prior to 1.7, this function always returned a new,
independent array containing a copy of the values in the diagonal.</p>

<p>In NumPy 1.7 and 1.8, it continues to return a copy of the diagonal,
but depending on this fact is deprecated. Writing to the resulting
array continues to work as it used to, but a FutureWarning is issued.</p>

<p>Starting in NumPy 1.9 it returns a read-only view on the original array.
Attempting to write to the resulting array will produce an error.</p>

<p>In some future release, it will return a read/write view and writing to
the returned array will alter your original array.  The returned array
will have the same type as the input array.</p>

<p>If you don't write to the array returned by this function, then you can
just ignore all of the above.</p>

<p>If you depend on the current behavior, then we suggest copying the
returned array explicitly, i.e., use <code>np.diagonal(a).copy()</code> instead
of just <code>np.diagonal(a)</code>. This will work with both past and future
versions of NumPy.</p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Array from which the diagonals are taken.
offset : int, optional
    Offset of the diagonal from the main diagonal.  Can be positive or
    negative.  Defaults to main diagonal (0).
axis1 : int, optional
    Axis to be used as the first axis of the 2-D sub-arrays from which
    the diagonals should be taken.  Defaults to first axis (0).
axis2 : int, optional
    Axis to be used as the second axis of the 2-D sub-arrays from
    which the diagonals should be taken. Defaults to second axis (1).</p>

<h2 id="returns">Returns</h2>

<p>array_of_diagonals : ndarray
    If <code>a</code> is 2-D, then a 1-D array containing the diagonal and of the
    same type as <code>a</code> is returned unless <code>a</code> is a <code>matrix</code>, in which case
    a 1-D array rather than a (2-D) <code>matrix</code> is returned in order to
    maintain backward compatibility.</p>

<pre><code>If ``a.ndim &gt; 2``, then the dimensions specified by `axis1` and `axis2`
are removed, and a new axis inserted at the end corresponding to the
diagonal.
</code></pre>
</div>


                            </div>
                            <div id="Array.dot" class="classattr">
                                        <input id="Array.dot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@partial(jit, static_argnames=(&#39;precision&#39;, &#39;preferred_element_type&#39;), inline=True)</div>

        <span class="def">def</span>
        <span class="name">dot</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">precision</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">_src</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">Precision</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">_src</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">Precision</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">_src</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">Precision</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">preferred_element_type</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">_src</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">SupportsDType</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.dot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.dot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.dot-3831"><a href="#Array.dot-3831"><span class="linenos">3831</span></a><span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnames</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="s1">&#39;preferred_element_type&#39;</span><span class="p">),</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Array.dot-3832"><a href="#Array.dot-3832"><span class="linenos">3832</span></a><span class="k">def</span> <span class="nf">dot</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
</span><span id="Array.dot-3833"><a href="#Array.dot-3833"><span class="linenos">3833</span></a>        <span class="n">precision</span><span class="p">:</span> <span class="n">PrecisionLike</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.dot-3834"><a href="#Array.dot-3834"><span class="linenos">3834</span></a>        <span class="n">preferred_element_type</span><span class="p">:</span> <span class="n">DTypeLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.dot-3835"><a href="#Array.dot-3835"><span class="linenos">3835</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Compute the dot product of two arrays.</span>
</span><span id="Array.dot-3836"><a href="#Array.dot-3836"><span class="linenos">3836</span></a>
</span><span id="Array.dot-3837"><a href="#Array.dot-3837"><span class="linenos">3837</span></a><span class="sd">  JAX implementation of :func:`numpy.dot`.</span>
</span><span id="Array.dot-3838"><a href="#Array.dot-3838"><span class="linenos">3838</span></a>
</span><span id="Array.dot-3839"><a href="#Array.dot-3839"><span class="linenos">3839</span></a><span class="sd">  This differs from :func:`jax.numpy.matmul` in two respects:</span>
</span><span id="Array.dot-3840"><a href="#Array.dot-3840"><span class="linenos">3840</span></a>
</span><span id="Array.dot-3841"><a href="#Array.dot-3841"><span class="linenos">3841</span></a><span class="sd">  - if either ``a`` or ``b`` is a scalar, the result of ``dot`` is equivalent to</span>
</span><span id="Array.dot-3842"><a href="#Array.dot-3842"><span class="linenos">3842</span></a><span class="sd">    :func:`jax.numpy.multiply`, while the result of ``matmul`` is an error.</span>
</span><span id="Array.dot-3843"><a href="#Array.dot-3843"><span class="linenos">3843</span></a><span class="sd">  - if ``a`` and ``b`` have more than 2 dimensions, the batch indices are</span>
</span><span id="Array.dot-3844"><a href="#Array.dot-3844"><span class="linenos">3844</span></a><span class="sd">    stacked rather than broadcast.</span>
</span><span id="Array.dot-3845"><a href="#Array.dot-3845"><span class="linenos">3845</span></a>
</span><span id="Array.dot-3846"><a href="#Array.dot-3846"><span class="linenos">3846</span></a><span class="sd">  Args:</span>
</span><span id="Array.dot-3847"><a href="#Array.dot-3847"><span class="linenos">3847</span></a><span class="sd">    a: first input array, of shape ``(..., N)``.</span>
</span><span id="Array.dot-3848"><a href="#Array.dot-3848"><span class="linenos">3848</span></a><span class="sd">    b: second input array. Must have shape ``(N,)`` or ``(..., N, M)``.</span>
</span><span id="Array.dot-3849"><a href="#Array.dot-3849"><span class="linenos">3849</span></a><span class="sd">      In the multi-dimensional case, leading dimensions must be broadcast-compatible</span>
</span><span id="Array.dot-3850"><a href="#Array.dot-3850"><span class="linenos">3850</span></a><span class="sd">      with the leading dimensions of ``a``.</span>
</span><span id="Array.dot-3851"><a href="#Array.dot-3851"><span class="linenos">3851</span></a><span class="sd">    precision: either ``None`` (default), which means the default precision for</span>
</span><span id="Array.dot-3852"><a href="#Array.dot-3852"><span class="linenos">3852</span></a><span class="sd">      the backend, a :class:`~jax.lax.Precision` enum value (``Precision.DEFAULT``,</span>
</span><span id="Array.dot-3853"><a href="#Array.dot-3853"><span class="linenos">3853</span></a><span class="sd">      ``Precision.HIGH`` or ``Precision.HIGHEST``) or a tuple of two</span>
</span><span id="Array.dot-3854"><a href="#Array.dot-3854"><span class="linenos">3854</span></a><span class="sd">      such values indicating precision of ``a`` and ``b``.</span>
</span><span id="Array.dot-3855"><a href="#Array.dot-3855"><span class="linenos">3855</span></a><span class="sd">    preferred_element_type: either ``None`` (default), which means the default</span>
</span><span id="Array.dot-3856"><a href="#Array.dot-3856"><span class="linenos">3856</span></a><span class="sd">      accumulation type for the input types, or a datatype, indicating to</span>
</span><span id="Array.dot-3857"><a href="#Array.dot-3857"><span class="linenos">3857</span></a><span class="sd">      accumulate results to and return a result with that datatype.</span>
</span><span id="Array.dot-3858"><a href="#Array.dot-3858"><span class="linenos">3858</span></a>
</span><span id="Array.dot-3859"><a href="#Array.dot-3859"><span class="linenos">3859</span></a><span class="sd">  Returns:</span>
</span><span id="Array.dot-3860"><a href="#Array.dot-3860"><span class="linenos">3860</span></a><span class="sd">    array containing the dot product of the inputs, with batch dimensions of</span>
</span><span id="Array.dot-3861"><a href="#Array.dot-3861"><span class="linenos">3861</span></a><span class="sd">    ``a`` and ``b`` stacked rather than broadcast.</span>
</span><span id="Array.dot-3862"><a href="#Array.dot-3862"><span class="linenos">3862</span></a>
</span><span id="Array.dot-3863"><a href="#Array.dot-3863"><span class="linenos">3863</span></a><span class="sd">  See also:</span>
</span><span id="Array.dot-3864"><a href="#Array.dot-3864"><span class="linenos">3864</span></a><span class="sd">    - :func:`jax.numpy.matmul`: broadcasted batched matmul.</span>
</span><span id="Array.dot-3865"><a href="#Array.dot-3865"><span class="linenos">3865</span></a><span class="sd">    - :func:`jax.lax.dot_general`: general batched matrix multiplication.</span>
</span><span id="Array.dot-3866"><a href="#Array.dot-3866"><span class="linenos">3866</span></a>
</span><span id="Array.dot-3867"><a href="#Array.dot-3867"><span class="linenos">3867</span></a><span class="sd">  Examples:</span>
</span><span id="Array.dot-3868"><a href="#Array.dot-3868"><span class="linenos">3868</span></a><span class="sd">    For scalar inputs, ``dot`` computes the element-wise product:</span>
</span><span id="Array.dot-3869"><a href="#Array.dot-3869"><span class="linenos">3869</span></a>
</span><span id="Array.dot-3870"><a href="#Array.dot-3870"><span class="linenos">3870</span></a><span class="sd">    &gt;&gt;&gt; x = jnp.array([1, 2, 3])</span>
</span><span id="Array.dot-3871"><a href="#Array.dot-3871"><span class="linenos">3871</span></a><span class="sd">    &gt;&gt;&gt; jnp.dot(x, 2)</span>
</span><span id="Array.dot-3872"><a href="#Array.dot-3872"><span class="linenos">3872</span></a><span class="sd">    Array([2, 4, 6], dtype=int32)</span>
</span><span id="Array.dot-3873"><a href="#Array.dot-3873"><span class="linenos">3873</span></a>
</span><span id="Array.dot-3874"><a href="#Array.dot-3874"><span class="linenos">3874</span></a><span class="sd">    For vector or matrix inputs, ``dot`` computes the vector or matrix product:</span>
</span><span id="Array.dot-3875"><a href="#Array.dot-3875"><span class="linenos">3875</span></a>
</span><span id="Array.dot-3876"><a href="#Array.dot-3876"><span class="linenos">3876</span></a><span class="sd">    &gt;&gt;&gt; M = jnp.array([[2, 3, 4],</span>
</span><span id="Array.dot-3877"><a href="#Array.dot-3877"><span class="linenos">3877</span></a><span class="sd">    ...                [5, 6, 7],</span>
</span><span id="Array.dot-3878"><a href="#Array.dot-3878"><span class="linenos">3878</span></a><span class="sd">    ...                [8, 9, 0]])</span>
</span><span id="Array.dot-3879"><a href="#Array.dot-3879"><span class="linenos">3879</span></a><span class="sd">    &gt;&gt;&gt; jnp.dot(M, x)</span>
</span><span id="Array.dot-3880"><a href="#Array.dot-3880"><span class="linenos">3880</span></a><span class="sd">    Array([20, 38, 26], dtype=int32)</span>
</span><span id="Array.dot-3881"><a href="#Array.dot-3881"><span class="linenos">3881</span></a><span class="sd">    &gt;&gt;&gt; jnp.dot(M, M)</span>
</span><span id="Array.dot-3882"><a href="#Array.dot-3882"><span class="linenos">3882</span></a><span class="sd">    Array([[ 51,  60,  29],</span>
</span><span id="Array.dot-3883"><a href="#Array.dot-3883"><span class="linenos">3883</span></a><span class="sd">           [ 96, 114,  62],</span>
</span><span id="Array.dot-3884"><a href="#Array.dot-3884"><span class="linenos">3884</span></a><span class="sd">           [ 61,  78,  95]], dtype=int32)</span>
</span><span id="Array.dot-3885"><a href="#Array.dot-3885"><span class="linenos">3885</span></a>
</span><span id="Array.dot-3886"><a href="#Array.dot-3886"><span class="linenos">3886</span></a><span class="sd">    For higher-dimensional matrix products, batch dimensions are stacked, whereas</span>
</span><span id="Array.dot-3887"><a href="#Array.dot-3887"><span class="linenos">3887</span></a><span class="sd">    in :func:`~jax.numpy.matmul` they are broadcast. For example:</span>
</span><span id="Array.dot-3888"><a href="#Array.dot-3888"><span class="linenos">3888</span></a>
</span><span id="Array.dot-3889"><a href="#Array.dot-3889"><span class="linenos">3889</span></a><span class="sd">    &gt;&gt;&gt; a = jnp.zeros((3, 2, 4))</span>
</span><span id="Array.dot-3890"><a href="#Array.dot-3890"><span class="linenos">3890</span></a><span class="sd">    &gt;&gt;&gt; b = jnp.zeros((3, 4, 1))</span>
</span><span id="Array.dot-3891"><a href="#Array.dot-3891"><span class="linenos">3891</span></a><span class="sd">    &gt;&gt;&gt; jnp.dot(a, b).shape</span>
</span><span id="Array.dot-3892"><a href="#Array.dot-3892"><span class="linenos">3892</span></a><span class="sd">    (3, 2, 3, 1)</span>
</span><span id="Array.dot-3893"><a href="#Array.dot-3893"><span class="linenos">3893</span></a><span class="sd">    &gt;&gt;&gt; jnp.matmul(a, b).shape</span>
</span><span id="Array.dot-3894"><a href="#Array.dot-3894"><span class="linenos">3894</span></a><span class="sd">    (3, 2, 1)</span>
</span><span id="Array.dot-3895"><a href="#Array.dot-3895"><span class="linenos">3895</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="Array.dot-3896"><a href="#Array.dot-3896"><span class="linenos">3896</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;dot&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</span><span id="Array.dot-3897"><a href="#Array.dot-3897"><span class="linenos">3897</span></a>  <span class="n">dtypes</span><span class="o">.</span><span class="n">check_user_dtype_supported</span><span class="p">(</span><span class="n">preferred_element_type</span><span class="p">,</span> <span class="s2">&quot;dot&quot;</span><span class="p">)</span>
</span><span id="Array.dot-3898"><a href="#Array.dot-3898"><span class="linenos">3898</span></a>  <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">asarray</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span id="Array.dot-3899"><a href="#Array.dot-3899"><span class="linenos">3899</span></a>  <span class="k">if</span> <span class="n">preferred_element_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.dot-3900"><a href="#Array.dot-3900"><span class="linenos">3900</span></a>    <span class="n">preferred_element_type</span><span class="p">,</span> <span class="n">output_weak_type</span> <span class="o">=</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">result_type</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">return_weak_type_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Array.dot-3901"><a href="#Array.dot-3901"><span class="linenos">3901</span></a>  <span class="k">else</span><span class="p">:</span>
</span><span id="Array.dot-3902"><a href="#Array.dot-3902"><span class="linenos">3902</span></a>    <span class="n">output_weak_type</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Array.dot-3903"><a href="#Array.dot-3903"><span class="linenos">3903</span></a>
</span><span id="Array.dot-3904"><a href="#Array.dot-3904"><span class="linenos">3904</span></a>  <span class="n">batch_dims</span> <span class="o">=</span> <span class="p">((),</span> <span class="p">())</span>
</span><span id="Array.dot-3905"><a href="#Array.dot-3905"><span class="linenos">3905</span></a>  <span class="n">a_ndim</span><span class="p">,</span> <span class="n">b_ndim</span> <span class="o">=</span> <span class="n">ndim</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">ndim</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span id="Array.dot-3906"><a href="#Array.dot-3906"><span class="linenos">3906</span></a>  <span class="k">if</span> <span class="n">a_ndim</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">b_ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Array.dot-3907"><a href="#Array.dot-3907"><span class="linenos">3907</span></a>    <span class="c1"># TODO(jakevdp): lower this case to dot_general as well?</span>
</span><span id="Array.dot-3908"><a href="#Array.dot-3908"><span class="linenos">3908</span></a>    <span class="c1"># Currently, doing so causes issues in remat tests due to #16805</span>
</span><span id="Array.dot-3909"><a href="#Array.dot-3909"><span class="linenos">3909</span></a>    <span class="k">if</span> <span class="n">preferred_element_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.dot-3910"><a href="#Array.dot-3910"><span class="linenos">3910</span></a>      <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">preferred_element_type</span><span class="p">)</span>
</span><span id="Array.dot-3911"><a href="#Array.dot-3911"><span class="linenos">3911</span></a>      <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">preferred_element_type</span><span class="p">)</span>
</span><span id="Array.dot-3912"><a href="#Array.dot-3912"><span class="linenos">3912</span></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</span><span id="Array.dot-3913"><a href="#Array.dot-3913"><span class="linenos">3913</span></a>  <span class="k">else</span><span class="p">:</span>
</span><span id="Array.dot-3914"><a href="#Array.dot-3914"><span class="linenos">3914</span></a>    <span class="k">if</span> <span class="n">b_ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Array.dot-3915"><a href="#Array.dot-3915"><span class="linenos">3915</span></a>      <span class="n">contract_dims</span> <span class="o">=</span> <span class="p">((</span><span class="n">a_ndim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
</span><span id="Array.dot-3916"><a href="#Array.dot-3916"><span class="linenos">3916</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Array.dot-3917"><a href="#Array.dot-3917"><span class="linenos">3917</span></a>      <span class="n">contract_dims</span> <span class="o">=</span> <span class="p">((</span><span class="n">a_ndim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="n">b_ndim</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,))</span>
</span><span id="Array.dot-3918"><a href="#Array.dot-3918"><span class="linenos">3918</span></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">dot_general</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">dimension_numbers</span><span class="o">=</span><span class="p">(</span><span class="n">contract_dims</span><span class="p">,</span> <span class="n">batch_dims</span><span class="p">),</span>
</span><span id="Array.dot-3919"><a href="#Array.dot-3919"><span class="linenos">3919</span></a>                             <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span> <span class="n">preferred_element_type</span><span class="o">=</span><span class="n">preferred_element_type</span><span class="p">)</span>
</span><span id="Array.dot-3920"><a href="#Array.dot-3920"><span class="linenos">3920</span></a>  <span class="k">return</span> <span class="n">lax_internal</span><span class="o">.</span><span class="n">_convert_element_type</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">preferred_element_type</span><span class="p">,</span> <span class="n">output_weak_type</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Compute the dot product of two arrays.</p>

<p>JAX implementation of <code>numpy.dot()</code>.</p>

<p>This differs from <code>jax.numpy.matmul()</code> in two respects:</p>

<ul>
<li>if either <code>a</code> or <code>b</code> is a scalar, the result of <code><a href="#Array.dot">dot</a></code> is equivalent to
<code>jax.numpy.multiply()</code>, while the result of <code>matmul</code> is an error.</li>
<li>if <code>a</code> and <code>b</code> have more than 2 dimensions, the batch indices are
stacked rather than broadcast.</li>
</ul>

<p>Args:
  a: first input array, of shape <code>(..., N)</code>.
  b: second input array. Must have shape <code>(N,)</code> or <code>(..., N, M)</code>.
    In the multi-dimensional case, leading dimensions must be broadcast-compatible
    with the leading dimensions of <code>a</code>.
  precision: either <code>None</code> (default), which means the default precision for
    the backend, a <code>~jax.lax.Precision</code> enum value (<code>Precision.DEFAULT</code>,
    <code>Precision.HIGH</code> or <code>Precision.HIGHEST</code>) or a tuple of two
    such values indicating precision of <code>a</code> and <code>b</code>.
  preferred_element_type: either <code>None</code> (default), which means the default
    accumulation type for the input types, or a datatype, indicating to
    accumulate results to and return a result with that datatype.</p>

<p>Returns:
  array containing the dot product of the inputs, with batch dimensions of
  <code>a</code> and <code>b</code> stacked rather than broadcast.</p>

<p>See also:</p>

<ul>
<li><code>jax.numpy.matmul()</code>: broadcasted batched matmul.</li>
<li><code>jax.lax.dot_general()</code>: general batched matrix multiplication.</li>
</ul>

<p>Examples:
  For scalar inputs, <code><a href="#Array.dot">dot</a></code> computes the element-wise product:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">Array([2, 4, 6], dtype=int32)</span>
</code></pre>
</div>

<p>For vector or matrix inputs, <code><a href="#Array.dot">dot</a></code> computes the vector or matrix product:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">Array([20, 38, 26], dtype=int32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="go">Array([[ 51,  60,  29],</span>
<span class="go">       [ 96, 114,  62],</span>
<span class="go">       [ 61,  78,  95]], dtype=int32)</span>
</code></pre>
</div>

<p>For higher-dimensional matrix products, batch dimensions are stacked, whereas
  in <code>~jax.numpy.matmul()</code> they are broadcast. For example:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 2, 3, 1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 2, 1)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Array.flatten" class="classattr">
                                        <input id="Array.flatten-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@partial(jit, static_argnames=(&#39;order&#39;,), inline=True)</div>

        <span class="def">def</span>
        <span class="name">flatten</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.flatten-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.flatten"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.flatten-994"><a href="#Array.flatten-994"><span class="linenos"> 994</span></a><span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnames</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;order&#39;</span><span class="p">,),</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Array.flatten-995"><a href="#Array.flatten-995"><span class="linenos"> 995</span></a><span class="k">def</span> <span class="nf">ravel</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.flatten-996"><a href="#Array.flatten-996"><span class="linenos"> 996</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Flatten array into a 1-dimensional shape.</span>
</span><span id="Array.flatten-997"><a href="#Array.flatten-997"><span class="linenos"> 997</span></a>
</span><span id="Array.flatten-998"><a href="#Array.flatten-998"><span class="linenos"> 998</span></a><span class="sd">  JAX implementation of :func:`numpy.ravel`, implemented in terms of</span>
</span><span id="Array.flatten-999"><a href="#Array.flatten-999"><span class="linenos"> 999</span></a><span class="sd">  :func:`jax.lax.reshape`.</span>
</span><span id="Array.flatten-1000"><a href="#Array.flatten-1000"><span class="linenos">1000</span></a>
</span><span id="Array.flatten-1001"><a href="#Array.flatten-1001"><span class="linenos">1001</span></a><span class="sd">  ``ravel(arr, order=order)`` is equivalent to ``reshape(arr, -1, order=order)``.</span>
</span><span id="Array.flatten-1002"><a href="#Array.flatten-1002"><span class="linenos">1002</span></a>
</span><span id="Array.flatten-1003"><a href="#Array.flatten-1003"><span class="linenos">1003</span></a><span class="sd">  Args:</span>
</span><span id="Array.flatten-1004"><a href="#Array.flatten-1004"><span class="linenos">1004</span></a><span class="sd">    a: array to be flattened.</span>
</span><span id="Array.flatten-1005"><a href="#Array.flatten-1005"><span class="linenos">1005</span></a><span class="sd">    order: ``&#39;F&#39;`` or ``&#39;C&#39;``, specifies whether the reshape should apply column-major</span>
</span><span id="Array.flatten-1006"><a href="#Array.flatten-1006"><span class="linenos">1006</span></a><span class="sd">      (fortran-style, ``&quot;F&quot;``) or row-major (C-style, ``&quot;C&quot;``) order; default is ``&quot;C&quot;``.</span>
</span><span id="Array.flatten-1007"><a href="#Array.flatten-1007"><span class="linenos">1007</span></a><span class="sd">      JAX does not support `order=&quot;A&quot;` or `order=&quot;K&quot;`.</span>
</span><span id="Array.flatten-1008"><a href="#Array.flatten-1008"><span class="linenos">1008</span></a>
</span><span id="Array.flatten-1009"><a href="#Array.flatten-1009"><span class="linenos">1009</span></a><span class="sd">  Returns:</span>
</span><span id="Array.flatten-1010"><a href="#Array.flatten-1010"><span class="linenos">1010</span></a><span class="sd">    flattened copy of input array.</span>
</span><span id="Array.flatten-1011"><a href="#Array.flatten-1011"><span class="linenos">1011</span></a>
</span><span id="Array.flatten-1012"><a href="#Array.flatten-1012"><span class="linenos">1012</span></a><span class="sd">  Notes:</span>
</span><span id="Array.flatten-1013"><a href="#Array.flatten-1013"><span class="linenos">1013</span></a><span class="sd">    Unlike :func:`numpy.ravel`, :func:`jax.numpy.ravel` will return a copy rather</span>
</span><span id="Array.flatten-1014"><a href="#Array.flatten-1014"><span class="linenos">1014</span></a><span class="sd">    than a view of the input array. However, under JIT, the compiler will optimize-away</span>
</span><span id="Array.flatten-1015"><a href="#Array.flatten-1015"><span class="linenos">1015</span></a><span class="sd">    such copies when possible, so this doesn&#39;t have performance impacts in practice.</span>
</span><span id="Array.flatten-1016"><a href="#Array.flatten-1016"><span class="linenos">1016</span></a>
</span><span id="Array.flatten-1017"><a href="#Array.flatten-1017"><span class="linenos">1017</span></a><span class="sd">  See Also:</span>
</span><span id="Array.flatten-1018"><a href="#Array.flatten-1018"><span class="linenos">1018</span></a><span class="sd">    - :meth:`jax.Array.ravel`: equivalent functionality via an array method.</span>
</span><span id="Array.flatten-1019"><a href="#Array.flatten-1019"><span class="linenos">1019</span></a><span class="sd">    - :func:`jax.numpy.reshape`: general array reshape.</span>
</span><span id="Array.flatten-1020"><a href="#Array.flatten-1020"><span class="linenos">1020</span></a>
</span><span id="Array.flatten-1021"><a href="#Array.flatten-1021"><span class="linenos">1021</span></a><span class="sd">  Examples:</span>
</span><span id="Array.flatten-1022"><a href="#Array.flatten-1022"><span class="linenos">1022</span></a><span class="sd">    &gt;&gt;&gt; x = jnp.array([[1, 2, 3],</span>
</span><span id="Array.flatten-1023"><a href="#Array.flatten-1023"><span class="linenos">1023</span></a><span class="sd">    ...                [4, 5, 6]])</span>
</span><span id="Array.flatten-1024"><a href="#Array.flatten-1024"><span class="linenos">1024</span></a>
</span><span id="Array.flatten-1025"><a href="#Array.flatten-1025"><span class="linenos">1025</span></a><span class="sd">    By default, ravel in C-style, row-major order</span>
</span><span id="Array.flatten-1026"><a href="#Array.flatten-1026"><span class="linenos">1026</span></a>
</span><span id="Array.flatten-1027"><a href="#Array.flatten-1027"><span class="linenos">1027</span></a><span class="sd">    &gt;&gt;&gt; jnp.ravel(x)</span>
</span><span id="Array.flatten-1028"><a href="#Array.flatten-1028"><span class="linenos">1028</span></a><span class="sd">    Array([1, 2, 3, 4, 5, 6], dtype=int32)</span>
</span><span id="Array.flatten-1029"><a href="#Array.flatten-1029"><span class="linenos">1029</span></a>
</span><span id="Array.flatten-1030"><a href="#Array.flatten-1030"><span class="linenos">1030</span></a><span class="sd">    Optionally ravel in Fortran-style, column-major:</span>
</span><span id="Array.flatten-1031"><a href="#Array.flatten-1031"><span class="linenos">1031</span></a>
</span><span id="Array.flatten-1032"><a href="#Array.flatten-1032"><span class="linenos">1032</span></a><span class="sd">    &gt;&gt;&gt; jnp.ravel(x, order=&#39;F&#39;)</span>
</span><span id="Array.flatten-1033"><a href="#Array.flatten-1033"><span class="linenos">1033</span></a><span class="sd">    Array([1, 4, 2, 5, 3, 6], dtype=int32)</span>
</span><span id="Array.flatten-1034"><a href="#Array.flatten-1034"><span class="linenos">1034</span></a>
</span><span id="Array.flatten-1035"><a href="#Array.flatten-1035"><span class="linenos">1035</span></a><span class="sd">    For convenience, the same functionality is availabel via the :meth:`jax.Array.ravel`</span>
</span><span id="Array.flatten-1036"><a href="#Array.flatten-1036"><span class="linenos">1036</span></a><span class="sd">    method:</span>
</span><span id="Array.flatten-1037"><a href="#Array.flatten-1037"><span class="linenos">1037</span></a>
</span><span id="Array.flatten-1038"><a href="#Array.flatten-1038"><span class="linenos">1038</span></a><span class="sd">    &gt;&gt;&gt; x.ravel()</span>
</span><span id="Array.flatten-1039"><a href="#Array.flatten-1039"><span class="linenos">1039</span></a><span class="sd">    Array([1, 2, 3, 4, 5, 6], dtype=int32)</span>
</span><span id="Array.flatten-1040"><a href="#Array.flatten-1040"><span class="linenos">1040</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="Array.flatten-1041"><a href="#Array.flatten-1041"><span class="linenos">1041</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;ravel&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Array.flatten-1042"><a href="#Array.flatten-1042"><span class="linenos">1042</span></a>  <span class="k">if</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">&quot;K&quot;</span><span class="p">:</span>
</span><span id="Array.flatten-1043"><a href="#Array.flatten-1043"><span class="linenos">1043</span></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Ravel not implemented for order=&#39;K&#39;.&quot;</span><span class="p">)</span>
</span><span id="Array.flatten-1044"><a href="#Array.flatten-1044"><span class="linenos">1044</span></a>  <span class="k">return</span> <span class="n">reshape</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">a</span><span class="p">),),</span> <span class="n">order</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Flatten array into a 1-dimensional shape.</p>

<p>JAX implementation of <code>numpy.ravel()</code>, implemented in terms of
<code>jax.lax.reshape()</code>.</p>

<p><code>ravel(arr, order=order)</code> is equivalent to <code>reshape(arr, -1, order=order)</code>.</p>

<p>Args:
  a: array to be flattened.
  order: <code>'F'</code> or <code>'C'</code>, specifies whether the reshape should apply column-major
    (fortran-style, <code>"F"</code>) or row-major (C-style, <code>"C"</code>) order; default is <code>"C"</code>.
    JAX does not support <code>order="A"</code> or <code>order="K"</code>.</p>

<p>Returns:
  flattened copy of input array.</p>

<p>Notes:
  Unlike <code>numpy.ravel()</code>, <code>jax.numpy.ravel()</code> will return a copy rather
  than a view of the input array. However, under JIT, the compiler will optimize-away
  such copies when possible, so this doesn't have performance impacts in practice.</p>

<p>See Also:</p>

<ul>
<li><code><a href="#Array.ravel">Array.ravel()</a></code>: equivalent functionality via an array method.</li>
<li><code>jax.numpy.reshape()</code>: general array reshape.</li>
</ul>

<p>Examples:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</code></pre>
</div>

<p>By default, ravel in C-style, row-major order</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">Array([1, 2, 3, 4, 5, 6], dtype=int32)</span>
</code></pre>
</div>

<p>Optionally ravel in Fortran-style, column-major:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
<span class="go">Array([1, 4, 2, 5, 3, 6], dtype=int32)</span>
</code></pre>
</div>

<p>For convenience, the same functionality is availabel via the <code><a href="#Array.ravel">Array.ravel()</a></code>
  method:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="go">Array([1, 2, 3, 4, 5, 6], dtype=int32)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Array.item" class="classattr">
                                        <input id="Array.item-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">item</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span><span class="p">:</span> <span class="n"><a href="#Array">Array</a></span>, </span><span class="param"><span class="o">*</span><span class="n">args</span></span><span class="return-annotation">) -> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">complex</span>:</span></span>

                <label class="view-source-button" for="Array.item-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.item"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.item-77"><a href="#Array.item-77"><span class="linenos">77</span></a><span class="k">def</span> <span class="nf">_item</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">complex</span><span class="p">:</span>
</span><span id="Array.item-78"><a href="#Array.item-78"><span class="linenos">78</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Copy an element of an array to a standard Python scalar and return it.&quot;&quot;&quot;</span>
</span><span id="Array.item-79"><a href="#Array.item-79"><span class="linenos">79</span></a>  <span class="n">arr</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">concrete_or_error</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="s2">&quot;This occurred in the item() method of jax.Array&quot;</span><span class="p">)</span>
</span><span id="Array.item-80"><a href="#Array.item-80"><span class="linenos">80</span></a>  <span class="k">if</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">extended</span><span class="p">):</span>
</span><span id="Array.item-81"><a href="#Array.item-81"><span class="linenos">81</span></a>    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No Python scalar type for </span><span class="si">{</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Array.item-82"><a href="#Array.item-82"><span class="linenos">82</span></a>  <span class="k">return</span> <span class="n">arr</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Copy an element of an array to a standard Python scalar and return it.</p>
</div>


                            </div>
                            <div id="Array.max" class="classattr">
                                        <input id="Array.max-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@implements(np.max, skip_params=[&#39;out&#39;])</div>

        <span class="def">def</span>
        <span class="name">max</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">initial</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.max-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.max"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.max-265"><a href="#Array.max-265"><span class="linenos">265</span></a><span class="nd">@implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">])</span>
</span><span id="Array.max-266"><a href="#Array.max-266"><span class="linenos">266</span></a><span class="k">def</span> <span class="nf">max</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.max-267"><a href="#Array.max-267"><span class="linenos">267</span></a>        <span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">initial</span><span class="p">:</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.max-268"><a href="#Array.max-268"><span class="linenos">268</span></a>        <span class="n">where</span><span class="p">:</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.max-269"><a href="#Array.max-269"><span class="linenos">269</span></a>  <span class="k">return</span> <span class="n">_reduce_max</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">_ensure_optional_axes</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span>
</span><span id="Array.max-270"><a href="#Array.max-270"><span class="linenos">270</span></a>                     <span class="n">keepdims</span><span class="o">=</span><span class="n">keepdims</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="n">initial</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the maximum of an array or maximum along an axis.</p>

<p>LAX-backend implementation of <code>numpy.max()</code>.</p>

<p><em>Original docstring below.</em></p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Input data.
axis : None or int or tuple of ints, optional
    Axis or axes along which to operate.  By default, flattened input is
    used.
keepdims : bool, optional
    If this is set to True, the axes which are reduced are left
    in the result as dimensions with size one. With this option,
    the result will broadcast correctly against the input array.</p>

<pre><code>If the default value is passed, then `keepdims` will not be
passed through to the ``max`` method of sub-classes of
`ndarray`, however any non-default value will be.  If the
sub-class' method does not implement `keepdims` any
exceptions will be raised.
</code></pre>

<p>initial : scalar, optional
    The minimum value of an output element. Must be present to allow
    computation on empty slice. See <code>~numpy.ufunc.reduce</code> for details.
where : array_like of bool, optional
    Elements to compare for the maximum. See <code>~numpy.ufunc.reduce</code>
    for details.</p>

<h2 id="returns">Returns</h2>

<p>max : ndarray or scalar
    Maximum of <code>a</code>. If <code>axis</code> is None, the result is a scalar value.
    If <code>axis</code> is an int, the result is an array of dimension
    <code>a.ndim - 1</code>. If <code>axis</code> is a tuple, the result is an array of
    dimension <code>a.ndim - len(axis)</code>.</p>
</div>


                            </div>
                            <div id="Array.mean" class="classattr">
                                        <input id="Array.mean-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@implements(np.mean, skip_params=[&#39;out&#39;])</div>

        <span class="def">def</span>
        <span class="name">mean</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">_src</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">SupportsDType</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.mean-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.mean"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.mean-325"><a href="#Array.mean-325"><span class="linenos">325</span></a><span class="nd">@implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">])</span>
</span><span id="Array.mean-326"><a href="#Array.mean-326"><span class="linenos">326</span></a><span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">DTypeLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.mean-327"><a href="#Array.mean-327"><span class="linenos">327</span></a>         <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
</span><span id="Array.mean-328"><a href="#Array.mean-328"><span class="linenos">328</span></a>         <span class="n">where</span><span class="p">:</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.mean-329"><a href="#Array.mean-329"><span class="linenos">329</span></a>  <span class="k">return</span> <span class="n">_mean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">_ensure_optional_axes</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">,</span>
</span><span id="Array.mean-330"><a href="#Array.mean-330"><span class="linenos">330</span></a>               <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Compute the arithmetic mean along the specified axis.</p>

<p>LAX-backend implementation of <code>numpy.mean()</code>.</p>

<p><em>Original docstring below.</em></p>

<p>Returns the average of the array elements.  The average is taken over
the flattened array by default, otherwise over the specified axis.
<code>float64</code> intermediate and return values are used for integer inputs.</p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Array containing numbers whose mean is desired. If <code>a</code> is not an
    array, a conversion is attempted.
axis : None or int or tuple of ints, optional
    Axis or axes along which the means are computed. The default is to
    compute the mean of the flattened array.
dtype : data-type, optional
    Type to use in computing the mean.  For integer inputs, the default
    is <code>float64</code>; for floating point inputs, it is the same as the
    input dtype.
keepdims : bool, optional
    If this is set to True, the axes which are reduced are left
    in the result as dimensions with size one. With this option,
    the result will broadcast correctly against the input array.</p>

<pre><code>If the default value is passed, then `keepdims` will not be
passed through to the `mean` method of sub-classes of
`ndarray`, however any non-default value will be.  If the
sub-class' method does not implement `keepdims` any
exceptions will be raised.
</code></pre>

<p>where : array_like of bool, optional
    Elements to include in the mean. See <code>~numpy.ufunc.reduce</code> for details.</p>

<h2 id="returns">Returns</h2>

<p>m : ndarray, see dtype parameter above
    If <code>out=None</code>, returns a new array containing the mean values,
    otherwise a reference to the output array is returned.</p>
</div>


                            </div>
                            <div id="Array.min" class="classattr">
                                        <input id="Array.min-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@implements(np.min, skip_params=[&#39;out&#39;])</div>

        <span class="def">def</span>
        <span class="name">min</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">initial</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.min-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.min"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.min-280"><a href="#Array.min-280"><span class="linenos">280</span></a><span class="nd">@implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">])</span>
</span><span id="Array.min-281"><a href="#Array.min-281"><span class="linenos">281</span></a><span class="k">def</span> <span class="nf">min</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.min-282"><a href="#Array.min-282"><span class="linenos">282</span></a>        <span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">initial</span><span class="p">:</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.min-283"><a href="#Array.min-283"><span class="linenos">283</span></a>        <span class="n">where</span><span class="p">:</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.min-284"><a href="#Array.min-284"><span class="linenos">284</span></a>  <span class="k">return</span> <span class="n">_reduce_min</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">_ensure_optional_axes</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span>
</span><span id="Array.min-285"><a href="#Array.min-285"><span class="linenos">285</span></a>                     <span class="n">keepdims</span><span class="o">=</span><span class="n">keepdims</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="n">initial</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the minimum of an array or minimum along an axis.</p>

<p>LAX-backend implementation of <code>numpy.min()</code>.</p>

<p><em>Original docstring below.</em></p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Input data.
axis : None or int or tuple of ints, optional
    Axis or axes along which to operate.  By default, flattened input is
    used.
keepdims : bool, optional
    If this is set to True, the axes which are reduced are left
    in the result as dimensions with size one. With this option,
    the result will broadcast correctly against the input array.</p>

<pre><code>If the default value is passed, then `keepdims` will not be
passed through to the ``min`` method of sub-classes of
`ndarray`, however any non-default value will be.  If the
sub-class' method does not implement `keepdims` any
exceptions will be raised.
</code></pre>

<p>initial : scalar, optional
    The maximum value of an output element. Must be present to allow
    computation on empty slice. See <code>~numpy.ufunc.reduce</code> for details.
where : array_like of bool, optional
    Elements to compare for the minimum. See <code>~numpy.ufunc.reduce</code>
    for details.</p>

<h2 id="returns">Returns</h2>

<p>min : ndarray or scalar
    Minimum of <code>a</code>. If <code>axis</code> is None, the result is a scalar value.
    If <code>axis</code> is an int, the result is an array of dimension
    <code>a.ndim - 1</code>.  If <code>axis</code> is a tuple, the result is an array of
    dimension <code>a.ndim - len(axis)</code>.</p>
</div>


                            </div>
                            <div id="Array.nonzero" class="classattr">
                                        <input id="Array.nonzero-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">nonzero</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">fill_value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">NoneType</span><span class="p">,</span> <span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">],</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="o">...</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="Array.nonzero-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.nonzero"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.nonzero-1684"><a href="#Array.nonzero-1684"><span class="linenos">1684</span></a><span class="k">def</span> <span class="nf">nonzero</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.nonzero-1685"><a href="#Array.nonzero-1685"><span class="linenos">1685</span></a>            <span class="n">fill_value</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Array.nonzero-1686"><a href="#Array.nonzero-1686"><span class="linenos">1686</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Array</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
</span><span id="Array.nonzero-1687"><a href="#Array.nonzero-1687"><span class="linenos">1687</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Return indices of nonzero elements of an array.</span>
</span><span id="Array.nonzero-1688"><a href="#Array.nonzero-1688"><span class="linenos">1688</span></a>
</span><span id="Array.nonzero-1689"><a href="#Array.nonzero-1689"><span class="linenos">1689</span></a><span class="sd">  JAX implementation of :func:`numpy.nonzero`.</span>
</span><span id="Array.nonzero-1690"><a href="#Array.nonzero-1690"><span class="linenos">1690</span></a>
</span><span id="Array.nonzero-1691"><a href="#Array.nonzero-1691"><span class="linenos">1691</span></a><span class="sd">  Because the size of the output of ``nonzero`` is data-dependent, the function</span>
</span><span id="Array.nonzero-1692"><a href="#Array.nonzero-1692"><span class="linenos">1692</span></a><span class="sd">  is not compatible with JIT and other transformations. The JAX version adds</span>
</span><span id="Array.nonzero-1693"><a href="#Array.nonzero-1693"><span class="linenos">1693</span></a><span class="sd">  the optional ``size`` argument which must be specified statically for</span>
</span><span id="Array.nonzero-1694"><a href="#Array.nonzero-1694"><span class="linenos">1694</span></a><span class="sd">  ``jnp.nonzero`` to be used within JAX&#39;s transformations.</span>
</span><span id="Array.nonzero-1695"><a href="#Array.nonzero-1695"><span class="linenos">1695</span></a>
</span><span id="Array.nonzero-1696"><a href="#Array.nonzero-1696"><span class="linenos">1696</span></a><span class="sd">  Args:</span>
</span><span id="Array.nonzero-1697"><a href="#Array.nonzero-1697"><span class="linenos">1697</span></a><span class="sd">    a: N-dimensional array.</span>
</span><span id="Array.nonzero-1698"><a href="#Array.nonzero-1698"><span class="linenos">1698</span></a><span class="sd">    size: optional static integer specifying the number of nonzero entries to</span>
</span><span id="Array.nonzero-1699"><a href="#Array.nonzero-1699"><span class="linenos">1699</span></a><span class="sd">      return. If there are more nonzero elements than the specified ``size``,</span>
</span><span id="Array.nonzero-1700"><a href="#Array.nonzero-1700"><span class="linenos">1700</span></a><span class="sd">      then indices will be truncated at the end. If there are fewer nonzero</span>
</span><span id="Array.nonzero-1701"><a href="#Array.nonzero-1701"><span class="linenos">1701</span></a><span class="sd">      elements than the specified size, then indices will be padded with</span>
</span><span id="Array.nonzero-1702"><a href="#Array.nonzero-1702"><span class="linenos">1702</span></a><span class="sd">      ``fill_value``, which defaults to zero.</span>
</span><span id="Array.nonzero-1703"><a href="#Array.nonzero-1703"><span class="linenos">1703</span></a><span class="sd">    fill_value: optional padding value when ``size`` is specified. Defaults to 0.</span>
</span><span id="Array.nonzero-1704"><a href="#Array.nonzero-1704"><span class="linenos">1704</span></a>
</span><span id="Array.nonzero-1705"><a href="#Array.nonzero-1705"><span class="linenos">1705</span></a><span class="sd">  Returns:</span>
</span><span id="Array.nonzero-1706"><a href="#Array.nonzero-1706"><span class="linenos">1706</span></a><span class="sd">    Tuple of JAX Arrays of length ``a.ndim``, containing the indices of each</span>
</span><span id="Array.nonzero-1707"><a href="#Array.nonzero-1707"><span class="linenos">1707</span></a><span class="sd">    nonzero value.</span>
</span><span id="Array.nonzero-1708"><a href="#Array.nonzero-1708"><span class="linenos">1708</span></a>
</span><span id="Array.nonzero-1709"><a href="#Array.nonzero-1709"><span class="linenos">1709</span></a><span class="sd">  See also:</span>
</span><span id="Array.nonzero-1710"><a href="#Array.nonzero-1710"><span class="linenos">1710</span></a><span class="sd">    - :func:`jax.numpy flatnonzero`</span>
</span><span id="Array.nonzero-1711"><a href="#Array.nonzero-1711"><span class="linenos">1711</span></a><span class="sd">    - :func:`jax.numpy.where`</span>
</span><span id="Array.nonzero-1712"><a href="#Array.nonzero-1712"><span class="linenos">1712</span></a>
</span><span id="Array.nonzero-1713"><a href="#Array.nonzero-1713"><span class="linenos">1713</span></a><span class="sd">  Examples:</span>
</span><span id="Array.nonzero-1714"><a href="#Array.nonzero-1714"><span class="linenos">1714</span></a>
</span><span id="Array.nonzero-1715"><a href="#Array.nonzero-1715"><span class="linenos">1715</span></a><span class="sd">    One-dimensional array returns a length-1 tuple of indices:</span>
</span><span id="Array.nonzero-1716"><a href="#Array.nonzero-1716"><span class="linenos">1716</span></a>
</span><span id="Array.nonzero-1717"><a href="#Array.nonzero-1717"><span class="linenos">1717</span></a><span class="sd">    &gt;&gt;&gt; x = jnp.array([0, 5, 0, 6, 0, 7])</span>
</span><span id="Array.nonzero-1718"><a href="#Array.nonzero-1718"><span class="linenos">1718</span></a><span class="sd">    &gt;&gt;&gt; jnp.nonzero(x)</span>
</span><span id="Array.nonzero-1719"><a href="#Array.nonzero-1719"><span class="linenos">1719</span></a><span class="sd">    (Array([1, 3, 5], dtype=int32),)</span>
</span><span id="Array.nonzero-1720"><a href="#Array.nonzero-1720"><span class="linenos">1720</span></a>
</span><span id="Array.nonzero-1721"><a href="#Array.nonzero-1721"><span class="linenos">1721</span></a><span class="sd">    Two-dimensional array returns a length-2 tuple of indices:</span>
</span><span id="Array.nonzero-1722"><a href="#Array.nonzero-1722"><span class="linenos">1722</span></a>
</span><span id="Array.nonzero-1723"><a href="#Array.nonzero-1723"><span class="linenos">1723</span></a><span class="sd">    &gt;&gt;&gt; x = jnp.array([[0, 5, 0],</span>
</span><span id="Array.nonzero-1724"><a href="#Array.nonzero-1724"><span class="linenos">1724</span></a><span class="sd">    ...                [6, 0, 7]])</span>
</span><span id="Array.nonzero-1725"><a href="#Array.nonzero-1725"><span class="linenos">1725</span></a><span class="sd">    &gt;&gt;&gt; jnp.nonzero(x)</span>
</span><span id="Array.nonzero-1726"><a href="#Array.nonzero-1726"><span class="linenos">1726</span></a><span class="sd">    (Array([0, 1, 1], dtype=int32), Array([1, 0, 2], dtype=int32))</span>
</span><span id="Array.nonzero-1727"><a href="#Array.nonzero-1727"><span class="linenos">1727</span></a>
</span><span id="Array.nonzero-1728"><a href="#Array.nonzero-1728"><span class="linenos">1728</span></a><span class="sd">    In either case, the resulting tuple of indices can be used directly to extract</span>
</span><span id="Array.nonzero-1729"><a href="#Array.nonzero-1729"><span class="linenos">1729</span></a><span class="sd">    the nonzero values:</span>
</span><span id="Array.nonzero-1730"><a href="#Array.nonzero-1730"><span class="linenos">1730</span></a>
</span><span id="Array.nonzero-1731"><a href="#Array.nonzero-1731"><span class="linenos">1731</span></a><span class="sd">    &gt;&gt;&gt; indices = jnp.nonzero(x)</span>
</span><span id="Array.nonzero-1732"><a href="#Array.nonzero-1732"><span class="linenos">1732</span></a><span class="sd">    &gt;&gt;&gt; x[indices]</span>
</span><span id="Array.nonzero-1733"><a href="#Array.nonzero-1733"><span class="linenos">1733</span></a><span class="sd">    Array([5, 6, 7], dtype=int32)</span>
</span><span id="Array.nonzero-1734"><a href="#Array.nonzero-1734"><span class="linenos">1734</span></a>
</span><span id="Array.nonzero-1735"><a href="#Array.nonzero-1735"><span class="linenos">1735</span></a><span class="sd">    The output of ``nonzero`` has a dynamic shape, because the number of returned</span>
</span><span id="Array.nonzero-1736"><a href="#Array.nonzero-1736"><span class="linenos">1736</span></a><span class="sd">    indices depends on the contents of the input array. As such, it is incompatible</span>
</span><span id="Array.nonzero-1737"><a href="#Array.nonzero-1737"><span class="linenos">1737</span></a><span class="sd">    with JIT and other JAX transformations:</span>
</span><span id="Array.nonzero-1738"><a href="#Array.nonzero-1738"><span class="linenos">1738</span></a>
</span><span id="Array.nonzero-1739"><a href="#Array.nonzero-1739"><span class="linenos">1739</span></a><span class="sd">    &gt;&gt;&gt; x = jnp.array([0, 5, 0, 6, 0, 7])</span>
</span><span id="Array.nonzero-1740"><a href="#Array.nonzero-1740"><span class="linenos">1740</span></a><span class="sd">    &gt;&gt;&gt; jax.jit(jnp.nonzero)(x)  # doctest: +IGNORE_EXCEPTION_DETAIL</span>
</span><span id="Array.nonzero-1741"><a href="#Array.nonzero-1741"><span class="linenos">1741</span></a><span class="sd">    Traceback (most recent call last):</span>
</span><span id="Array.nonzero-1742"><a href="#Array.nonzero-1742"><span class="linenos">1742</span></a><span class="sd">      ...</span>
</span><span id="Array.nonzero-1743"><a href="#Array.nonzero-1743"><span class="linenos">1743</span></a><span class="sd">    ConcretizationTypeError: Abstract tracer value encountered where concrete value is expected: traced array with shape int32[].</span>
</span><span id="Array.nonzero-1744"><a href="#Array.nonzero-1744"><span class="linenos">1744</span></a><span class="sd">    The size argument of jnp.nonzero must be statically specified to use jnp.nonzero within JAX transformations.</span>
</span><span id="Array.nonzero-1745"><a href="#Array.nonzero-1745"><span class="linenos">1745</span></a>
</span><span id="Array.nonzero-1746"><a href="#Array.nonzero-1746"><span class="linenos">1746</span></a><span class="sd">    This can be addressed by passing a static ``size`` parameter to specify the</span>
</span><span id="Array.nonzero-1747"><a href="#Array.nonzero-1747"><span class="linenos">1747</span></a><span class="sd">    desired output shape:</span>
</span><span id="Array.nonzero-1748"><a href="#Array.nonzero-1748"><span class="linenos">1748</span></a>
</span><span id="Array.nonzero-1749"><a href="#Array.nonzero-1749"><span class="linenos">1749</span></a><span class="sd">    &gt;&gt;&gt; nonzero_jit = jax.jit(jnp.nonzero, static_argnames=&#39;size&#39;)</span>
</span><span id="Array.nonzero-1750"><a href="#Array.nonzero-1750"><span class="linenos">1750</span></a><span class="sd">    &gt;&gt;&gt; nonzero_jit(x, size=3)</span>
</span><span id="Array.nonzero-1751"><a href="#Array.nonzero-1751"><span class="linenos">1751</span></a><span class="sd">    (Array([1, 3, 5], dtype=int32),)</span>
</span><span id="Array.nonzero-1752"><a href="#Array.nonzero-1752"><span class="linenos">1752</span></a>
</span><span id="Array.nonzero-1753"><a href="#Array.nonzero-1753"><span class="linenos">1753</span></a><span class="sd">    If ``size`` does not match the true size, the result will be either truncated or padded:</span>
</span><span id="Array.nonzero-1754"><a href="#Array.nonzero-1754"><span class="linenos">1754</span></a>
</span><span id="Array.nonzero-1755"><a href="#Array.nonzero-1755"><span class="linenos">1755</span></a><span class="sd">    &gt;&gt;&gt; nonzero_jit(x, size=2)  # size &lt; 3: indices are truncated</span>
</span><span id="Array.nonzero-1756"><a href="#Array.nonzero-1756"><span class="linenos">1756</span></a><span class="sd">    (Array([1, 3], dtype=int32),)</span>
</span><span id="Array.nonzero-1757"><a href="#Array.nonzero-1757"><span class="linenos">1757</span></a><span class="sd">    &gt;&gt;&gt; nonzero_jit(x, size=5)  # size &gt; 3: indices are padded with zeros.</span>
</span><span id="Array.nonzero-1758"><a href="#Array.nonzero-1758"><span class="linenos">1758</span></a><span class="sd">    (Array([1, 3, 5, 0, 0], dtype=int32),)</span>
</span><span id="Array.nonzero-1759"><a href="#Array.nonzero-1759"><span class="linenos">1759</span></a>
</span><span id="Array.nonzero-1760"><a href="#Array.nonzero-1760"><span class="linenos">1760</span></a><span class="sd">    You can specify a custom fill value for the padding using the ``fill_value`` argument:</span>
</span><span id="Array.nonzero-1761"><a href="#Array.nonzero-1761"><span class="linenos">1761</span></a>
</span><span id="Array.nonzero-1762"><a href="#Array.nonzero-1762"><span class="linenos">1762</span></a><span class="sd">    &gt;&gt;&gt; nonzero_jit(x, size=5, fill_value=len(x))</span>
</span><span id="Array.nonzero-1763"><a href="#Array.nonzero-1763"><span class="linenos">1763</span></a><span class="sd">    (Array([1, 3, 5, 6, 6], dtype=int32),)</span>
</span><span id="Array.nonzero-1764"><a href="#Array.nonzero-1764"><span class="linenos">1764</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="Array.nonzero-1765"><a href="#Array.nonzero-1765"><span class="linenos">1765</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;nonzero&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Array.nonzero-1766"><a href="#Array.nonzero-1766"><span class="linenos">1766</span></a>  <span class="n">arr</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="Array.nonzero-1767"><a href="#Array.nonzero-1767"><span class="linenos">1767</span></a>  <span class="k">del</span> <span class="n">a</span>
</span><span id="Array.nonzero-1768"><a href="#Array.nonzero-1768"><span class="linenos">1768</span></a>  <span class="k">if</span> <span class="n">ndim</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Array.nonzero-1769"><a href="#Array.nonzero-1769"><span class="linenos">1769</span></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Calling nonzero on 0d arrays is not allowed. &quot;</span>
</span><span id="Array.nonzero-1770"><a href="#Array.nonzero-1770"><span class="linenos">1770</span></a>                     <span class="s2">&quot;Use jnp.atleast_1d(scalar).nonzero() instead.&quot;</span><span class="p">)</span>
</span><span id="Array.nonzero-1771"><a href="#Array.nonzero-1771"><span class="linenos">1771</span></a>  <span class="n">mask</span> <span class="o">=</span> <span class="n">arr</span> <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">bool</span> <span class="k">else</span> <span class="p">(</span><span class="n">arr</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="Array.nonzero-1772"><a href="#Array.nonzero-1772"><span class="linenos">1772</span></a>  <span class="n">calculated_size</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">size</span>
</span><span id="Array.nonzero-1773"><a href="#Array.nonzero-1773"><span class="linenos">1773</span></a>  <span class="n">calculated_size</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">concrete_dim_or_error</span><span class="p">(</span><span class="n">calculated_size</span><span class="p">,</span>
</span><span id="Array.nonzero-1774"><a href="#Array.nonzero-1774"><span class="linenos">1774</span></a>    <span class="s2">&quot;The size argument of jnp.nonzero must be statically specified &quot;</span>
</span><span id="Array.nonzero-1775"><a href="#Array.nonzero-1775"><span class="linenos">1775</span></a>    <span class="s2">&quot;to use jnp.nonzero within JAX transformations.&quot;</span><span class="p">)</span>
</span><span id="Array.nonzero-1776"><a href="#Array.nonzero-1776"><span class="linenos">1776</span></a>  <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">calculated_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Array.nonzero-1777"><a href="#Array.nonzero-1777"><span class="linenos">1777</span></a>    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">zeros</span><span class="p">(</span><span class="n">calculated_size</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Array.nonzero-1778"><a href="#Array.nonzero-1778"><span class="linenos">1778</span></a>  <span class="n">flat_indices</span> <span class="o">=</span> <span class="n">reductions</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span>
</span><span id="Array.nonzero-1779"><a href="#Array.nonzero-1779"><span class="linenos">1779</span></a>      <span class="n">bincount</span><span class="p">(</span><span class="n">reductions</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">mask</span><span class="p">),</span>
</span><span id="Array.nonzero-1780"><a href="#Array.nonzero-1780"><span class="linenos">1780</span></a>               <span class="n">length</span><span class="o">=</span><span class="n">calculated_size</span><span class="p">))</span>  <span class="c1"># type: ignore[arg-type]</span>
</span><span id="Array.nonzero-1781"><a href="#Array.nonzero-1781"><span class="linenos">1781</span></a>  <span class="n">strides</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumprod</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">int_</span><span class="p">)</span>
</span><span id="Array.nonzero-1782"><a href="#Array.nonzero-1782"><span class="linenos">1782</span></a>  <span class="n">out</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">((</span><span class="n">flat_indices</span> <span class="o">//</span> <span class="n">stride</span><span class="p">)</span> <span class="o">%</span> <span class="n">size</span> <span class="k">for</span> <span class="n">stride</span><span class="p">,</span> <span class="n">size</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">strides</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span><span id="Array.nonzero-1783"><a href="#Array.nonzero-1783"><span class="linenos">1783</span></a>  <span class="k">if</span> <span class="n">fill_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.nonzero-1784"><a href="#Array.nonzero-1784"><span class="linenos">1784</span></a>    <span class="n">fill_value_tup</span> <span class="o">=</span> <span class="n">fill_value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fill_value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span> <span class="o">*</span> <span class="p">(</span><span class="n">fill_value</span><span class="p">,)</span>
</span><span id="Array.nonzero-1785"><a href="#Array.nonzero-1785"><span class="linenos">1785</span></a>    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">_shape</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">!=</span> <span class="p">()</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">fill_value_tup</span><span class="p">):</span>
</span><span id="Array.nonzero-1786"><a href="#Array.nonzero-1786"><span class="linenos">1786</span></a>      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;fill_value must be a scalar or a tuple of length </span><span class="si">{</span><span class="n">arr</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2">; got </span><span class="si">{</span><span class="n">fill_value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Array.nonzero-1787"><a href="#Array.nonzero-1787"><span class="linenos">1787</span></a>    <span class="n">fill_mask</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="n">calculated_size</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">mask</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="Array.nonzero-1788"><a href="#Array.nonzero-1788"><span class="linenos">1788</span></a>    <span class="n">out</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">where</span><span class="p">(</span><span class="n">fill_mask</span><span class="p">,</span> <span class="n">fval</span><span class="p">,</span> <span class="n">entry</span><span class="p">)</span> <span class="k">for</span> <span class="n">fval</span><span class="p">,</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">safe_zip</span><span class="p">(</span><span class="n">fill_value_tup</span><span class="p">,</span> <span class="n">out</span><span class="p">))</span>
</span><span id="Array.nonzero-1789"><a href="#Array.nonzero-1789"><span class="linenos">1789</span></a>  <span class="k">return</span> <span class="n">out</span>
</span></pre></div>


            <div class="docstring"><p>Return indices of nonzero elements of an array.</p>

<p>JAX implementation of <code>numpy.nonzero()</code>.</p>

<p>Because the size of the output of <code><a href="#Array.nonzero">nonzero</a></code> is data-dependent, the function
is not compatible with JIT and other transformations. The JAX version adds
the optional <code><a href="#Array.size">size</a></code> argument which must be specified statically for
<code>jnp.nonzero</code> to be used within JAX's transformations.</p>

<p>Args:
  a: N-dimensional array.
  size: optional static integer specifying the number of nonzero entries to
    return. If there are more nonzero elements than the specified <code><a href="#Array.size">size</a></code>,
    then indices will be truncated at the end. If there are fewer nonzero
    elements than the specified size, then indices will be padded with
    <code>fill_value</code>, which defaults to zero.
  fill_value: optional padding value when <code><a href="#Array.size">size</a></code> is specified. Defaults to 0.</p>

<p>Returns:
  Tuple of JAX Arrays of length <code>a.ndim</code>, containing the indices of each
  nonzero value.</p>

<p>See also:</p>

<ul>
<li><code>jax.numpy flatnonzero()</code></li>
<li><code>jax.numpy.where()</code></li>
</ul>

<p>Examples:</p>

<p>One-dimensional array returns a length-1 tuple of indices:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(Array([1, 3, 5], dtype=int32),)</span>
</code></pre>
</div>

<p>Two-dimensional array returns a length-2 tuple of indices:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(Array([0, 1, 1], dtype=int32), Array([1, 0, 2], dtype=int32))</span>
</code></pre>
</div>

<p>In either case, the resulting tuple of indices can be used directly to extract
  the nonzero values:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
<span class="go">Array([5, 6, 7], dtype=int32)</span>
</code></pre>
</div>

<p>The output of <code><a href="#Array.nonzero">nonzero</a></code> has a dynamic shape, because the number of returned
  indices depends on the contents of the input array. As such, it is incompatible
  with JIT and other JAX transformations:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">nonzero</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># doctest: +IGNORE_EXCEPTION_DETAIL</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="w">  </span><span class="c">...</span>
<span class="gr">ConcretizationTypeError</span>: <span class="n">Abstract tracer value encountered where concrete value is expected: traced array with shape int32[].</span>
<span class="x">The size argument of jnp.nonzero must be statically specified to use jnp.nonzero within JAX transformations.</span>
</code></pre>
</div>

<p>This can be addressed by passing a static <code><a href="#Array.size">size</a></code> parameter to specify the
  desired output shape:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">nonzero_jit</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">nonzero</span><span class="p">,</span> <span class="n">static_argnames</span><span class="o">=</span><span class="s1">&#39;size&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nonzero_jit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(Array([1, 3, 5], dtype=int32),)</span>
</code></pre>
</div>

<p>If <code><a href="#Array.size">size</a></code> does not match the true size, the result will be either truncated or padded:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">nonzero_jit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># size &lt; 3: indices are truncated</span>
<span class="go">(Array([1, 3], dtype=int32),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nonzero_jit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># size &gt; 3: indices are padded with zeros.</span>
<span class="go">(Array([1, 3, 5, 0, 0], dtype=int32),)</span>
</code></pre>
</div>

<p>You can specify a custom fill value for the padding using the <code>fill_value</code> argument:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">nonzero_jit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">(Array([1, 3, 5, 6, 6], dtype=int32),)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Array.prod" class="classattr">
                                        <input id="Array.prod-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@implements(np.prod, skip_params=[&#39;out&#39;], extra_params=_PROMOTE_INTEGERS_DOC)</div>

        <span class="def">def</span>
        <span class="name">prod</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">_src</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">SupportsDType</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">initial</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">promote_integers</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.prod-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.prod"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.prod-247"><a href="#Array.prod-247"><span class="linenos">247</span></a><span class="nd">@implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">],</span> <span class="n">extra_params</span><span class="o">=</span><span class="n">_PROMOTE_INTEGERS_DOC</span><span class="p">)</span>
</span><span id="Array.prod-248"><a href="#Array.prod-248"><span class="linenos">248</span></a><span class="k">def</span> <span class="nf">prod</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">DTypeLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.prod-249"><a href="#Array.prod-249"><span class="linenos">249</span></a>         <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Array.prod-250"><a href="#Array.prod-250"><span class="linenos">250</span></a>         <span class="n">initial</span><span class="p">:</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">where</span><span class="p">:</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.prod-251"><a href="#Array.prod-251"><span class="linenos">251</span></a>         <span class="n">promote_integers</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.prod-252"><a href="#Array.prod-252"><span class="linenos">252</span></a>  <span class="k">return</span> <span class="n">_reduce_prod</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">_ensure_optional_axes</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
</span><span id="Array.prod-253"><a href="#Array.prod-253"><span class="linenos">253</span></a>                      <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="n">keepdims</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="n">initial</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span>
</span><span id="Array.prod-254"><a href="#Array.prod-254"><span class="linenos">254</span></a>                      <span class="n">promote_integers</span><span class="o">=</span><span class="n">promote_integers</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the product of array elements over a given axis.</p>

<p>LAX-backend implementation of <code>numpy.prod()</code>.</p>

<p><em>Original docstring below.</em></p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Input data.
axis : None or int or tuple of ints, optional
    Axis or axes along which a product is performed.  The default,
    axis=None, will calculate the product of all the elements in the
    input array. If axis is negative it counts from the last to the
    first axis.
dtype : dtype, optional
    The type of the returned array, as well as of the accumulator in
    which the elements are multiplied.  The dtype of <code>a</code> is used by
    default unless <code>a</code> has an integer dtype of less precision than the
    default platform integer.  In that case, if <code>a</code> is signed then the
    platform integer is used while if <code>a</code> is unsigned then an unsigned
    integer of the same precision as the platform integer is used.
keepdims : bool, optional
    If this is set to True, the axes which are reduced are left in the
    result as dimensions with size one. With this option, the result
    will broadcast correctly against the input array.</p>

<pre><code>If the default value is passed, then `keepdims` will not be
passed through to the `prod` method of sub-classes of
`ndarray`, however any non-default value will be.  If the
sub-class' method does not implement `keepdims` any
exceptions will be raised.
</code></pre>

<p>initial : scalar, optional
    The starting value for this product. See <code>~numpy.ufunc.reduce</code> for details.
where : array_like of bool, optional
    Elements to include in the product. See <code>~numpy.ufunc.reduce</code> for details.
promote_integers : bool, default=True
    If True, then integer inputs will be promoted to the widest available integer
    dtype, following numpy's behavior. If False, the result will have the same dtype
    as the input. <code>promote_integers</code> is ignored if <code><a href="#Array.dtype">dtype</a></code> is specified.</p>

<h2 id="returns">Returns</h2>

<p>product_along_axis : ndarray, see <code><a href="#Array.dtype">dtype</a></code> parameter above.
    An array shaped as <code>a</code> but with the specified axis removed.
    Returns a reference to <code>out</code> if specified.</p>
</div>


                            </div>
                            <div id="Array.ptp" class="classattr">
                                        <input id="Array.ptp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@implements(np.ptp, skip_params=[&#39;out&#39;])</div>

        <span class="def">def</span>
        <span class="name">ptp</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.ptp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.ptp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.ptp-515"><a href="#Array.ptp-515"><span class="linenos">515</span></a><span class="nd">@implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">])</span>
</span><span id="Array.ptp-516"><a href="#Array.ptp-516"><span class="linenos">516</span></a><span class="k">def</span> <span class="nf">ptp</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.ptp-517"><a href="#Array.ptp-517"><span class="linenos">517</span></a>        <span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.ptp-518"><a href="#Array.ptp-518"><span class="linenos">518</span></a>  <span class="k">return</span> <span class="n">_ptp</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">_ensure_optional_axes</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span> <span class="n">out</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Range of values (maximum - minimum) along an axis.</p>

<p>LAX-backend implementation of <code>numpy.ptp()</code>.</p>

<p><em>Original docstring below.</em></p>

<p>The name of the function comes from the acronym for 'peak to peak'.</p>

<div class="pdoc-alert pdoc-alert-warning">

<p><code><a href="#Array.ptp">ptp</a></code> preserves the data type of the array. This means the
return value for an input of signed integers with n bits
(e.g. <code>np.int8</code>, <code>np.int16</code>, etc) is also a signed integer
with n bits.  In that case, peak-to-peak values greater than
<code>2**(n-1)-1</code> will be returned as negative values. An example
with a work-around is shown below.</p>

</div>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Input values.
axis : None or int or tuple of ints, optional
    Axis along which to find the peaks.  By default, flatten the
    array.  <code>axis</code> may be negative, in
    which case it counts from the last to the first axis.
keepdims : bool, optional
    If this is set to True, the axes which are reduced are left
    in the result as dimensions with size one. With this option,
    the result will broadcast correctly against the input array.</p>

<pre><code>If the default value is passed, then `keepdims` will not be
passed through to the `ptp` method of sub-classes of
`ndarray`, however any non-default value will be.  If the
sub-class' method does not implement `keepdims` any
exceptions will be raised.
</code></pre>

<h2 id="returns">Returns</h2>

<p>ptp : ndarray or scalar
    The range of a given array - <code>scalar</code> if array is one-dimensional
    or a new array holding the result along the given axis</p>
</div>


                            </div>
                            <div id="Array.ravel" class="classattr">
                                        <input id="Array.ravel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@partial(jit, static_argnames=(&#39;order&#39;,), inline=True)</div>

        <span class="def">def</span>
        <span class="name">ravel</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.ravel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.ravel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.ravel-994"><a href="#Array.ravel-994"><span class="linenos"> 994</span></a><span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnames</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;order&#39;</span><span class="p">,),</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Array.ravel-995"><a href="#Array.ravel-995"><span class="linenos"> 995</span></a><span class="k">def</span> <span class="nf">ravel</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.ravel-996"><a href="#Array.ravel-996"><span class="linenos"> 996</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Flatten array into a 1-dimensional shape.</span>
</span><span id="Array.ravel-997"><a href="#Array.ravel-997"><span class="linenos"> 997</span></a>
</span><span id="Array.ravel-998"><a href="#Array.ravel-998"><span class="linenos"> 998</span></a><span class="sd">  JAX implementation of :func:`numpy.ravel`, implemented in terms of</span>
</span><span id="Array.ravel-999"><a href="#Array.ravel-999"><span class="linenos"> 999</span></a><span class="sd">  :func:`jax.lax.reshape`.</span>
</span><span id="Array.ravel-1000"><a href="#Array.ravel-1000"><span class="linenos">1000</span></a>
</span><span id="Array.ravel-1001"><a href="#Array.ravel-1001"><span class="linenos">1001</span></a><span class="sd">  ``ravel(arr, order=order)`` is equivalent to ``reshape(arr, -1, order=order)``.</span>
</span><span id="Array.ravel-1002"><a href="#Array.ravel-1002"><span class="linenos">1002</span></a>
</span><span id="Array.ravel-1003"><a href="#Array.ravel-1003"><span class="linenos">1003</span></a><span class="sd">  Args:</span>
</span><span id="Array.ravel-1004"><a href="#Array.ravel-1004"><span class="linenos">1004</span></a><span class="sd">    a: array to be flattened.</span>
</span><span id="Array.ravel-1005"><a href="#Array.ravel-1005"><span class="linenos">1005</span></a><span class="sd">    order: ``&#39;F&#39;`` or ``&#39;C&#39;``, specifies whether the reshape should apply column-major</span>
</span><span id="Array.ravel-1006"><a href="#Array.ravel-1006"><span class="linenos">1006</span></a><span class="sd">      (fortran-style, ``&quot;F&quot;``) or row-major (C-style, ``&quot;C&quot;``) order; default is ``&quot;C&quot;``.</span>
</span><span id="Array.ravel-1007"><a href="#Array.ravel-1007"><span class="linenos">1007</span></a><span class="sd">      JAX does not support `order=&quot;A&quot;` or `order=&quot;K&quot;`.</span>
</span><span id="Array.ravel-1008"><a href="#Array.ravel-1008"><span class="linenos">1008</span></a>
</span><span id="Array.ravel-1009"><a href="#Array.ravel-1009"><span class="linenos">1009</span></a><span class="sd">  Returns:</span>
</span><span id="Array.ravel-1010"><a href="#Array.ravel-1010"><span class="linenos">1010</span></a><span class="sd">    flattened copy of input array.</span>
</span><span id="Array.ravel-1011"><a href="#Array.ravel-1011"><span class="linenos">1011</span></a>
</span><span id="Array.ravel-1012"><a href="#Array.ravel-1012"><span class="linenos">1012</span></a><span class="sd">  Notes:</span>
</span><span id="Array.ravel-1013"><a href="#Array.ravel-1013"><span class="linenos">1013</span></a><span class="sd">    Unlike :func:`numpy.ravel`, :func:`jax.numpy.ravel` will return a copy rather</span>
</span><span id="Array.ravel-1014"><a href="#Array.ravel-1014"><span class="linenos">1014</span></a><span class="sd">    than a view of the input array. However, under JIT, the compiler will optimize-away</span>
</span><span id="Array.ravel-1015"><a href="#Array.ravel-1015"><span class="linenos">1015</span></a><span class="sd">    such copies when possible, so this doesn&#39;t have performance impacts in practice.</span>
</span><span id="Array.ravel-1016"><a href="#Array.ravel-1016"><span class="linenos">1016</span></a>
</span><span id="Array.ravel-1017"><a href="#Array.ravel-1017"><span class="linenos">1017</span></a><span class="sd">  See Also:</span>
</span><span id="Array.ravel-1018"><a href="#Array.ravel-1018"><span class="linenos">1018</span></a><span class="sd">    - :meth:`jax.Array.ravel`: equivalent functionality via an array method.</span>
</span><span id="Array.ravel-1019"><a href="#Array.ravel-1019"><span class="linenos">1019</span></a><span class="sd">    - :func:`jax.numpy.reshape`: general array reshape.</span>
</span><span id="Array.ravel-1020"><a href="#Array.ravel-1020"><span class="linenos">1020</span></a>
</span><span id="Array.ravel-1021"><a href="#Array.ravel-1021"><span class="linenos">1021</span></a><span class="sd">  Examples:</span>
</span><span id="Array.ravel-1022"><a href="#Array.ravel-1022"><span class="linenos">1022</span></a><span class="sd">    &gt;&gt;&gt; x = jnp.array([[1, 2, 3],</span>
</span><span id="Array.ravel-1023"><a href="#Array.ravel-1023"><span class="linenos">1023</span></a><span class="sd">    ...                [4, 5, 6]])</span>
</span><span id="Array.ravel-1024"><a href="#Array.ravel-1024"><span class="linenos">1024</span></a>
</span><span id="Array.ravel-1025"><a href="#Array.ravel-1025"><span class="linenos">1025</span></a><span class="sd">    By default, ravel in C-style, row-major order</span>
</span><span id="Array.ravel-1026"><a href="#Array.ravel-1026"><span class="linenos">1026</span></a>
</span><span id="Array.ravel-1027"><a href="#Array.ravel-1027"><span class="linenos">1027</span></a><span class="sd">    &gt;&gt;&gt; jnp.ravel(x)</span>
</span><span id="Array.ravel-1028"><a href="#Array.ravel-1028"><span class="linenos">1028</span></a><span class="sd">    Array([1, 2, 3, 4, 5, 6], dtype=int32)</span>
</span><span id="Array.ravel-1029"><a href="#Array.ravel-1029"><span class="linenos">1029</span></a>
</span><span id="Array.ravel-1030"><a href="#Array.ravel-1030"><span class="linenos">1030</span></a><span class="sd">    Optionally ravel in Fortran-style, column-major:</span>
</span><span id="Array.ravel-1031"><a href="#Array.ravel-1031"><span class="linenos">1031</span></a>
</span><span id="Array.ravel-1032"><a href="#Array.ravel-1032"><span class="linenos">1032</span></a><span class="sd">    &gt;&gt;&gt; jnp.ravel(x, order=&#39;F&#39;)</span>
</span><span id="Array.ravel-1033"><a href="#Array.ravel-1033"><span class="linenos">1033</span></a><span class="sd">    Array([1, 4, 2, 5, 3, 6], dtype=int32)</span>
</span><span id="Array.ravel-1034"><a href="#Array.ravel-1034"><span class="linenos">1034</span></a>
</span><span id="Array.ravel-1035"><a href="#Array.ravel-1035"><span class="linenos">1035</span></a><span class="sd">    For convenience, the same functionality is availabel via the :meth:`jax.Array.ravel`</span>
</span><span id="Array.ravel-1036"><a href="#Array.ravel-1036"><span class="linenos">1036</span></a><span class="sd">    method:</span>
</span><span id="Array.ravel-1037"><a href="#Array.ravel-1037"><span class="linenos">1037</span></a>
</span><span id="Array.ravel-1038"><a href="#Array.ravel-1038"><span class="linenos">1038</span></a><span class="sd">    &gt;&gt;&gt; x.ravel()</span>
</span><span id="Array.ravel-1039"><a href="#Array.ravel-1039"><span class="linenos">1039</span></a><span class="sd">    Array([1, 2, 3, 4, 5, 6], dtype=int32)</span>
</span><span id="Array.ravel-1040"><a href="#Array.ravel-1040"><span class="linenos">1040</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="Array.ravel-1041"><a href="#Array.ravel-1041"><span class="linenos">1041</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;ravel&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Array.ravel-1042"><a href="#Array.ravel-1042"><span class="linenos">1042</span></a>  <span class="k">if</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">&quot;K&quot;</span><span class="p">:</span>
</span><span id="Array.ravel-1043"><a href="#Array.ravel-1043"><span class="linenos">1043</span></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Ravel not implemented for order=&#39;K&#39;.&quot;</span><span class="p">)</span>
</span><span id="Array.ravel-1044"><a href="#Array.ravel-1044"><span class="linenos">1044</span></a>  <span class="k">return</span> <span class="n">reshape</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">a</span><span class="p">),),</span> <span class="n">order</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Flatten array into a 1-dimensional shape.</p>

<p>JAX implementation of <code>numpy.ravel()</code>, implemented in terms of
<code>jax.lax.reshape()</code>.</p>

<p><code>ravel(arr, order=order)</code> is equivalent to <code>reshape(arr, -1, order=order)</code>.</p>

<p>Args:
  a: array to be flattened.
  order: <code>'F'</code> or <code>'C'</code>, specifies whether the reshape should apply column-major
    (fortran-style, <code>"F"</code>) or row-major (C-style, <code>"C"</code>) order; default is <code>"C"</code>.
    JAX does not support <code>order="A"</code> or <code>order="K"</code>.</p>

<p>Returns:
  flattened copy of input array.</p>

<p>Notes:
  Unlike <code>numpy.ravel()</code>, <code>jax.numpy.ravel()</code> will return a copy rather
  than a view of the input array. However, under JIT, the compiler will optimize-away
  such copies when possible, so this doesn't have performance impacts in practice.</p>

<p>See Also:</p>

<ul>
<li><code><a href="#Array.ravel">Array.ravel()</a></code>: equivalent functionality via an array method.</li>
<li><code>jax.numpy.reshape()</code>: general array reshape.</li>
</ul>

<p>Examples:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</code></pre>
</div>

<p>By default, ravel in C-style, row-major order</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">Array([1, 2, 3, 4, 5, 6], dtype=int32)</span>
</code></pre>
</div>

<p>Optionally ravel in Fortran-style, column-major:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
<span class="go">Array([1, 4, 2, 5, 3, 6], dtype=int32)</span>
</code></pre>
</div>

<p>For convenience, the same functionality is availabel via the <code><a href="#Array.ravel">Array.ravel()</a></code>
  method:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="go">Array([1, 2, 3, 4, 5, 6], dtype=int32)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Array.repeat" class="classattr">
                                        <input id="Array.repeat-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@util.implements(np.repeat, lax_description=_TOTAL_REPEAT_LENGTH_DOC)</div>

        <span class="def">def</span>
        <span class="name">repeat</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">repeats</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">total_repeat_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.repeat-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.repeat"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.repeat-3270"><a href="#Array.repeat-3270"><span class="linenos">3270</span></a><span class="nd">@util</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">,</span> <span class="n">lax_description</span><span class="o">=</span><span class="n">_TOTAL_REPEAT_LENGTH_DOC</span><span class="p">)</span>
</span><span id="Array.repeat-3271"><a href="#Array.repeat-3271"><span class="linenos">3271</span></a><span class="k">def</span> <span class="nf">repeat</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">repeats</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
</span><span id="Array.repeat-3272"><a href="#Array.repeat-3272"><span class="linenos">3272</span></a>           <span class="n">total_repeat_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.repeat-3273"><a href="#Array.repeat-3273"><span class="linenos">3273</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;repeat&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Array.repeat-3274"><a href="#Array.repeat-3274"><span class="linenos">3274</span></a>  <span class="n">core</span><span class="o">.</span><span class="n">is_dim</span><span class="p">(</span><span class="n">repeats</span><span class="p">)</span> <span class="ow">or</span> <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;repeat&quot;</span><span class="p">,</span> <span class="n">repeats</span><span class="p">)</span>
</span><span id="Array.repeat-3275"><a href="#Array.repeat-3275"><span class="linenos">3275</span></a>
</span><span id="Array.repeat-3276"><a href="#Array.repeat-3276"><span class="linenos">3276</span></a>  <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.repeat-3277"><a href="#Array.repeat-3277"><span class="linenos">3277</span></a>    <span class="n">a</span> <span class="o">=</span> <span class="n">ravel</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="Array.repeat-3278"><a href="#Array.repeat-3278"><span class="linenos">3278</span></a>    <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Array.repeat-3279"><a href="#Array.repeat-3279"><span class="linenos">3279</span></a>  <span class="k">else</span><span class="p">:</span>
</span><span id="Array.repeat-3280"><a href="#Array.repeat-3280"><span class="linenos">3280</span></a>    <span class="n">a</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="Array.repeat-3281"><a href="#Array.repeat-3281"><span class="linenos">3281</span></a>
</span><span id="Array.repeat-3282"><a href="#Array.repeat-3282"><span class="linenos">3282</span></a>  <span class="n">axis</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">concrete_or_error</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="s2">&quot;&#39;axis&#39; argument of jnp.repeat()&quot;</span><span class="p">)</span>
</span><span id="Array.repeat-3283"><a href="#Array.repeat-3283"><span class="linenos">3283</span></a>  <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>  <span class="c1"># to appease mypy</span>
</span><span id="Array.repeat-3284"><a href="#Array.repeat-3284"><span class="linenos">3284</span></a>
</span><span id="Array.repeat-3285"><a href="#Array.repeat-3285"><span class="linenos">3285</span></a>  <span class="k">if</span> <span class="n">core</span><span class="o">.</span><span class="n">is_symbolic_dim</span><span class="p">(</span><span class="n">repeats</span><span class="p">):</span>
</span><span id="Array.repeat-3286"><a href="#Array.repeat-3286"><span class="linenos">3286</span></a>    <span class="k">if</span> <span class="n">total_repeat_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.repeat-3287"><a href="#Array.repeat-3287"><span class="linenos">3287</span></a>      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;jnp.repeat with a non-constant `repeats` is supported only &quot;</span>
</span><span id="Array.repeat-3288"><a href="#Array.repeat-3288"><span class="linenos">3288</span></a>                       <span class="sa">f</span><span class="s2">&quot;when `total_repeat_length` is None. (</span><span class="si">{</span><span class="n">repeats</span><span class="si">=}</span><span class="s2"> </span><span class="si">{</span><span class="n">total_repeat_length</span><span class="si">=}</span><span class="s2">)&quot;</span><span class="p">)</span>
</span><span id="Array.repeat-3289"><a href="#Array.repeat-3289"><span class="linenos">3289</span></a>
</span><span id="Array.repeat-3290"><a href="#Array.repeat-3290"><span class="linenos">3290</span></a>  <span class="c1"># If total_repeat_length is not given, use a default.</span>
</span><span id="Array.repeat-3291"><a href="#Array.repeat-3291"><span class="linenos">3291</span></a>  <span class="k">if</span> <span class="n">total_repeat_length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.repeat-3292"><a href="#Array.repeat-3292"><span class="linenos">3292</span></a>    <span class="n">repeats</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">concrete_or_error</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">repeats</span><span class="p">,</span>
</span><span id="Array.repeat-3293"><a href="#Array.repeat-3293"><span class="linenos">3293</span></a>      <span class="s2">&quot;When jit-compiling jnp.repeat, the total number of repeats must be static. &quot;</span>
</span><span id="Array.repeat-3294"><a href="#Array.repeat-3294"><span class="linenos">3294</span></a>      <span class="s2">&quot;To fix this, either specify a static value for `repeats`, or pass a static &quot;</span>
</span><span id="Array.repeat-3295"><a href="#Array.repeat-3295"><span class="linenos">3295</span></a>      <span class="s2">&quot;value to `total_repeat_length`.&quot;</span><span class="p">)</span>
</span><span id="Array.repeat-3296"><a href="#Array.repeat-3296"><span class="linenos">3296</span></a>
</span><span id="Array.repeat-3297"><a href="#Array.repeat-3297"><span class="linenos">3297</span></a>    <span class="c1"># Fast path for when repeats is a scalar.</span>
</span><span id="Array.repeat-3298"><a href="#Array.repeat-3298"><span class="linenos">3298</span></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">repeats</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">ndim</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Array.repeat-3299"><a href="#Array.repeat-3299"><span class="linenos">3299</span></a>      <span class="n">input_shape</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="Array.repeat-3300"><a href="#Array.repeat-3300"><span class="linenos">3300</span></a>      <span class="n">aux_axis</span> <span class="o">=</span> <span class="n">axis</span> <span class="k">if</span> <span class="n">axis</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">axis</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Array.repeat-3301"><a href="#Array.repeat-3301"><span class="linenos">3301</span></a>      <span class="n">a</span> <span class="o">=</span> <span class="n">expand_dims</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">aux_axis</span><span class="p">)</span>
</span><span id="Array.repeat-3302"><a href="#Array.repeat-3302"><span class="linenos">3302</span></a>      <span class="n">reps</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DimSize</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</span><span id="Array.repeat-3303"><a href="#Array.repeat-3303"><span class="linenos">3303</span></a>      <span class="n">reps</span><span class="p">[</span><span class="n">aux_axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">repeats</span>
</span><span id="Array.repeat-3304"><a href="#Array.repeat-3304"><span class="linenos">3304</span></a>      <span class="n">a</span> <span class="o">=</span> <span class="n">tile</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">reps</span><span class="p">)</span>
</span><span id="Array.repeat-3305"><a href="#Array.repeat-3305"><span class="linenos">3305</span></a>      <span class="n">result_shape</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">DimSize</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span>
</span><span id="Array.repeat-3306"><a href="#Array.repeat-3306"><span class="linenos">3306</span></a>      <span class="n">result_shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">*=</span> <span class="n">repeats</span>
</span><span id="Array.repeat-3307"><a href="#Array.repeat-3307"><span class="linenos">3307</span></a>      <span class="k">return</span> <span class="n">reshape</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">result_shape</span><span class="p">)</span>
</span><span id="Array.repeat-3308"><a href="#Array.repeat-3308"><span class="linenos">3308</span></a>
</span><span id="Array.repeat-3309"><a href="#Array.repeat-3309"><span class="linenos">3309</span></a>    <span class="n">repeats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">repeats</span><span class="p">)</span>
</span><span id="Array.repeat-3310"><a href="#Array.repeat-3310"><span class="linenos">3310</span></a>    <span class="k">if</span> <span class="n">ndim</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Array.repeat-3311"><a href="#Array.repeat-3311"><span class="linenos">3311</span></a>      <span class="n">repeats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">repeats</span><span class="p">,</span> <span class="p">[</span><span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">)[</span><span class="n">axis</span><span class="p">]])</span>
</span><span id="Array.repeat-3312"><a href="#Array.repeat-3312"><span class="linenos">3312</span></a>    <span class="n">total_repeat_length</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">repeats</span><span class="p">)</span>
</span><span id="Array.repeat-3313"><a href="#Array.repeat-3313"><span class="linenos">3313</span></a>  <span class="k">else</span><span class="p">:</span>
</span><span id="Array.repeat-3314"><a href="#Array.repeat-3314"><span class="linenos">3314</span></a>    <span class="n">repeats</span> <span class="o">=</span> <span class="n">ravel</span><span class="p">(</span><span class="n">repeats</span><span class="p">)</span>
</span><span id="Array.repeat-3315"><a href="#Array.repeat-3315"><span class="linenos">3315</span></a>    <span class="k">if</span> <span class="n">ndim</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Array.repeat-3316"><a href="#Array.repeat-3316"><span class="linenos">3316</span></a>      <span class="n">repeats</span> <span class="o">=</span> <span class="n">broadcast_to</span><span class="p">(</span><span class="n">repeats</span><span class="p">,</span> <span class="p">[</span><span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">)[</span><span class="n">axis</span><span class="p">]])</span>
</span><span id="Array.repeat-3317"><a href="#Array.repeat-3317"><span class="linenos">3317</span></a>
</span><span id="Array.repeat-3318"><a href="#Array.repeat-3318"><span class="linenos">3318</span></a>  <span class="c1"># Special case when a is a scalar.</span>
</span><span id="Array.repeat-3319"><a href="#Array.repeat-3319"><span class="linenos">3319</span></a>  <span class="k">if</span> <span class="n">ndim</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Array.repeat-3320"><a href="#Array.repeat-3320"><span class="linenos">3320</span></a>    <span class="k">if</span> <span class="n">shape</span><span class="p">(</span><span class="n">repeats</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,):</span>
</span><span id="Array.repeat-3321"><a href="#Array.repeat-3321"><span class="linenos">3321</span></a>      <span class="k">return</span> <span class="n">full</span><span class="p">([</span><span class="n">total_repeat_length</span><span class="p">],</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Array.repeat-3322"><a href="#Array.repeat-3322"><span class="linenos">3322</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="Array.repeat-3323"><a href="#Array.repeat-3323"><span class="linenos">3323</span></a>      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;`repeat` with a scalar parameter `a` is only &#39;</span>
</span><span id="Array.repeat-3324"><a href="#Array.repeat-3324"><span class="linenos">3324</span></a>      <span class="s1">&#39;implemented for scalar values of the parameter `repeats`.&#39;</span><span class="p">)</span>
</span><span id="Array.repeat-3325"><a href="#Array.repeat-3325"><span class="linenos">3325</span></a>
</span><span id="Array.repeat-3326"><a href="#Array.repeat-3326"><span class="linenos">3326</span></a>  <span class="c1"># Special case if total_repeat_length is zero.</span>
</span><span id="Array.repeat-3327"><a href="#Array.repeat-3327"><span class="linenos">3327</span></a>  <span class="k">if</span> <span class="n">total_repeat_length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Array.repeat-3328"><a href="#Array.repeat-3328"><span class="linenos">3328</span></a>    <span class="n">result_shape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</span><span id="Array.repeat-3329"><a href="#Array.repeat-3329"><span class="linenos">3329</span></a>    <span class="n">result_shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Array.repeat-3330"><a href="#Array.repeat-3330"><span class="linenos">3330</span></a>    <span class="k">return</span> <span class="n">reshape</span><span class="p">(</span><span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">_dtype</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="n">result_shape</span><span class="p">)</span>
</span><span id="Array.repeat-3331"><a href="#Array.repeat-3331"><span class="linenos">3331</span></a>
</span><span id="Array.repeat-3332"><a href="#Array.repeat-3332"><span class="linenos">3332</span></a>  <span class="c1"># If repeats is on a zero sized axis, then return the array.</span>
</span><span id="Array.repeat-3333"><a href="#Array.repeat-3333"><span class="linenos">3333</span></a>  <span class="k">if</span> <span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">)[</span><span class="n">axis</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Array.repeat-3334"><a href="#Array.repeat-3334"><span class="linenos">3334</span></a>    <span class="k">return</span> <span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="Array.repeat-3335"><a href="#Array.repeat-3335"><span class="linenos">3335</span></a>
</span><span id="Array.repeat-3336"><a href="#Array.repeat-3336"><span class="linenos">3336</span></a>  <span class="c1"># This implementation of repeat avoid having to instantiate a large.</span>
</span><span id="Array.repeat-3337"><a href="#Array.repeat-3337"><span class="linenos">3337</span></a>  <span class="c1">#intermediate tensor.</span>
</span><span id="Array.repeat-3338"><a href="#Array.repeat-3338"><span class="linenos">3338</span></a>
</span><span id="Array.repeat-3339"><a href="#Array.repeat-3339"><span class="linenos">3339</span></a>  <span class="c1"># Modify repeats from e.g. [1,2,0,5] -&gt; [0,1,2,0] for exclusive repeat.</span>
</span><span id="Array.repeat-3340"><a href="#Array.repeat-3340"><span class="linenos">3340</span></a>  <span class="n">exclusive_repeats</span> <span class="o">=</span> <span class="n">roll</span><span class="p">(</span><span class="n">repeats</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Array.repeat-3341"><a href="#Array.repeat-3341"><span class="linenos">3341</span></a>  <span class="c1"># Cumsum to get indices of new number in repeated tensor, e.g. [0, 1, 3, 3]</span>
</span><span id="Array.repeat-3342"><a href="#Array.repeat-3342"><span class="linenos">3342</span></a>  <span class="n">scatter_indices</span> <span class="o">=</span> <span class="n">reductions</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">exclusive_repeats</span><span class="p">)</span>
</span><span id="Array.repeat-3343"><a href="#Array.repeat-3343"><span class="linenos">3343</span></a>  <span class="c1"># Scatter these onto a zero buffer, e.g. [1,1,0,2,0,0,0,0]</span>
</span><span id="Array.repeat-3344"><a href="#Array.repeat-3344"><span class="linenos">3344</span></a>  <span class="n">block_split_indicators</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">([</span><span class="n">total_repeat_length</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</span><span id="Array.repeat-3345"><a href="#Array.repeat-3345"><span class="linenos">3345</span></a>  <span class="n">block_split_indicators</span> <span class="o">=</span> <span class="n">block_split_indicators</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">scatter_indices</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Array.repeat-3346"><a href="#Array.repeat-3346"><span class="linenos">3346</span></a>  <span class="c1"># Cumsum again to get scatter indices for repeat, e.g. [0,1,1,3,3,3,3,3]</span>
</span><span id="Array.repeat-3347"><a href="#Array.repeat-3347"><span class="linenos">3347</span></a>  <span class="n">gather_indices</span> <span class="o">=</span> <span class="n">reductions</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">block_split_indicators</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="Array.repeat-3348"><a href="#Array.repeat-3348"><span class="linenos">3348</span></a>  <span class="k">return</span> <span class="n">take</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">gather_indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Repeat each element of an array after themselves</p>

<p>LAX-backend implementation of <code>numpy.repeat()</code>.</p>

<p>JAX adds the optional <code>total_repeat_length</code> parameter which specifies the total
number of repeat, and defaults to sum(repeats). It must be specified for repeat
to be compilable. If <code>sum(repeats)</code> is larger than the specified
<code>total_repeat_length</code> the remaining values will be discarded. In the case of
<code>sum(repeats)</code> being smaller than the specified target length, the final value
will be repeated.</p>

<p><em>Original docstring below.</em></p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Input array.
repeats : int or array of ints
    The number of repetitions for each element.  <code>repeats</code> is broadcasted
    to fit the shape of the given axis.
axis : int, optional
    The axis along which to repeat values.  By default, use the
    flattened input array, and return a flat output array.</p>

<h2 id="returns">Returns</h2>

<p>repeated_array : ndarray
    Output array which has the same shape as <code>a</code>, except along
    the given axis.</p>
</div>


                            </div>
                            <div id="Array.reshape" class="classattr">
                                        <input id="Array.reshape-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">reshape</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span><span class="p">:</span> <span class="n"><a href="#Array">Array</a></span>, </span><span class="param"><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span>, </span><span class="param"><span class="n">order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.reshape-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.reshape"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.reshape-144"><a href="#Array.reshape-144"><span class="linenos">144</span></a><span class="k">def</span> <span class="nf">_reshape</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.reshape-145"><a href="#Array.reshape-145"><span class="linenos">145</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Returns an array containing the same data with a new shape.</span>
</span><span id="Array.reshape-146"><a href="#Array.reshape-146"><span class="linenos">146</span></a>
</span><span id="Array.reshape-147"><a href="#Array.reshape-147"><span class="linenos">147</span></a><span class="sd">  Refer to :func:`jax.numpy.reshape` for full documentation.</span>
</span><span id="Array.reshape-148"><a href="#Array.reshape-148"><span class="linenos">148</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="Array.reshape-149"><a href="#Array.reshape-149"><span class="linenos">149</span></a>  <span class="n">__tracebackhide__</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="Array.reshape-150"><a href="#Array.reshape-150"><span class="linenos">150</span></a>  <span class="n">newshape</span> <span class="o">=</span> <span class="n">_compute_newshape</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">args</span><span class="p">)</span>
</span><span id="Array.reshape-151"><a href="#Array.reshape-151"><span class="linenos">151</span></a>  <span class="k">if</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span>
</span><span id="Array.reshape-152"><a href="#Array.reshape-152"><span class="linenos">152</span></a>    <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">newshape</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="Array.reshape-153"><a href="#Array.reshape-153"><span class="linenos">153</span></a>  <span class="k">elif</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">&quot;F&quot;</span><span class="p">:</span>
</span><span id="Array.reshape-154"><a href="#Array.reshape-154"><span class="linenos">154</span></a>    <span class="n">dims</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ndim</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Array.reshape-155"><a href="#Array.reshape-155"><span class="linenos">155</span></a>    <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">newshape</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dims</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="Array.reshape-156"><a href="#Array.reshape-156"><span class="linenos">156</span></a>  <span class="k">elif</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">&quot;A&quot;</span><span class="p">:</span>
</span><span id="Array.reshape-157"><a href="#Array.reshape-157"><span class="linenos">157</span></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;np.reshape order=A is not implemented.&quot;</span><span class="p">)</span>
</span><span id="Array.reshape-158"><a href="#Array.reshape-158"><span class="linenos">158</span></a>  <span class="k">else</span><span class="p">:</span>
</span><span id="Array.reshape-159"><a href="#Array.reshape-159"><span class="linenos">159</span></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected value for &#39;order&#39; argument: </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns an array containing the same data with a new shape.</p>

<p>Refer to <code>jax.numpy.reshape()</code> for full documentation.</p>
</div>


                            </div>
                            <div id="Array.round" class="classattr">
                                        <input id="Array.round-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@util.implements(np.around, skip_params=[&#39;out&#39;])</div>
        <div class="decorator">@partial(jit, static_argnames=(&#39;decimals&#39;,))</div>

        <span class="def">def</span>
        <span class="name">round</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">decimals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.round-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.round"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.round-1607"><a href="#Array.round-1607"><span class="linenos">1607</span></a><span class="nd">@util</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">])</span>
</span><span id="Array.round-1608"><a href="#Array.round-1608"><span class="linenos">1608</span></a><span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnames</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;decimals&#39;</span><span class="p">,))</span>
</span><span id="Array.round-1609"><a href="#Array.round-1609"><span class="linenos">1609</span></a><span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">decimals</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.round-1610"><a href="#Array.round-1610"><span class="linenos">1610</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Array.round-1611"><a href="#Array.round-1611"><span class="linenos">1611</span></a>  <span class="n">decimals</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">concrete_or_error</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">decimals</span><span class="p">,</span> <span class="s2">&quot;&#39;decimals&#39; argument of jnp.round&quot;</span><span class="p">)</span>
</span><span id="Array.round-1612"><a href="#Array.round-1612"><span class="linenos">1612</span></a>  <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.round-1613"><a href="#Array.round-1613"><span class="linenos">1613</span></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;The &#39;out&#39; argument to jnp.round is not supported.&quot;</span><span class="p">)</span>
</span><span id="Array.round-1614"><a href="#Array.round-1614"><span class="linenos">1614</span></a>  <span class="n">dtype</span> <span class="o">=</span> <span class="n">_dtype</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="Array.round-1615"><a href="#Array.round-1615"><span class="linenos">1615</span></a>  <span class="k">if</span> <span class="n">issubdtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">integer</span><span class="p">):</span>
</span><span id="Array.round-1616"><a href="#Array.round-1616"><span class="linenos">1616</span></a>    <span class="k">if</span> <span class="n">decimals</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Array.round-1617"><a href="#Array.round-1617"><span class="linenos">1617</span></a>      <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span id="Array.round-1618"><a href="#Array.round-1618"><span class="linenos">1618</span></a>        <span class="s2">&quot;integer np.round not implemented for decimals &lt; 0&quot;</span><span class="p">)</span>
</span><span id="Array.round-1619"><a href="#Array.round-1619"><span class="linenos">1619</span></a>    <span class="k">return</span> <span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># no-op on integer types</span>
</span><span id="Array.round-1620"><a href="#Array.round-1620"><span class="linenos">1620</span></a>
</span><span id="Array.round-1621"><a href="#Array.round-1621"><span class="linenos">1621</span></a>  <span class="k">def</span> <span class="nf">_round_float</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.round-1622"><a href="#Array.round-1622"><span class="linenos">1622</span></a>    <span class="k">if</span> <span class="n">decimals</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Array.round-1623"><a href="#Array.round-1623"><span class="linenos">1623</span></a>      <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">lax</span><span class="o">.</span><span class="n">RoundingMethod</span><span class="o">.</span><span class="n">TO_NEAREST_EVEN</span><span class="p">)</span>
</span><span id="Array.round-1624"><a href="#Array.round-1624"><span class="linenos">1624</span></a>
</span><span id="Array.round-1625"><a href="#Array.round-1625"><span class="linenos">1625</span></a>    <span class="c1"># TODO(phawkins): the strategy of rescaling the value isn&#39;t necessarily a</span>
</span><span id="Array.round-1626"><a href="#Array.round-1626"><span class="linenos">1626</span></a>    <span class="c1"># good one since we may be left with an incorrectly rounded value at the</span>
</span><span id="Array.round-1627"><a href="#Array.round-1627"><span class="linenos">1627</span></a>    <span class="c1"># end due to precision problems. As a workaround for float16, convert to</span>
</span><span id="Array.round-1628"><a href="#Array.round-1628"><span class="linenos">1628</span></a>    <span class="c1"># float32,</span>
</span><span id="Array.round-1629"><a href="#Array.round-1629"><span class="linenos">1629</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">convert_element_type</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="k">if</span> <span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">float16</span> <span class="k">else</span> <span class="n">x</span>
</span><span id="Array.round-1630"><a href="#Array.round-1630"><span class="linenos">1630</span></a>    <span class="n">factor</span> <span class="o">=</span> <span class="n">_lax_const</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">decimals</span><span class="p">)</span>
</span><span id="Array.round-1631"><a href="#Array.round-1631"><span class="linenos">1631</span></a>    <span class="n">out</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">lax</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">lax</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">factor</span><span class="p">),</span>
</span><span id="Array.round-1632"><a href="#Array.round-1632"><span class="linenos">1632</span></a>                            <span class="n">lax</span><span class="o">.</span><span class="n">RoundingMethod</span><span class="o">.</span><span class="n">TO_NEAREST_EVEN</span><span class="p">),</span> <span class="n">factor</span><span class="p">)</span>
</span><span id="Array.round-1633"><a href="#Array.round-1633"><span class="linenos">1633</span></a>    <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">convert_element_type</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span> <span class="k">if</span> <span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">float16</span> <span class="k">else</span> <span class="n">out</span>
</span><span id="Array.round-1634"><a href="#Array.round-1634"><span class="linenos">1634</span></a>
</span><span id="Array.round-1635"><a href="#Array.round-1635"><span class="linenos">1635</span></a>  <span class="k">if</span> <span class="n">issubdtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">complexfloating</span><span class="p">):</span>
</span><span id="Array.round-1636"><a href="#Array.round-1636"><span class="linenos">1636</span></a>    <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">complex</span><span class="p">(</span><span class="n">_round_float</span><span class="p">(</span><span class="n">lax</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span> <span class="n">_round_float</span><span class="p">(</span><span class="n">lax</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">a</span><span class="p">)))</span>
</span><span id="Array.round-1637"><a href="#Array.round-1637"><span class="linenos">1637</span></a>  <span class="k">else</span><span class="p">:</span>
</span><span id="Array.round-1638"><a href="#Array.round-1638"><span class="linenos">1638</span></a>    <span class="k">return</span> <span class="n">_round_float</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Round an array to the given number of decimals.</p>

<p>LAX-backend implementation of <code>numpy.around()</code>.</p>

<p><em>Original docstring below.</em></p>

<p><code>around</code> is an alias of <code>~numpy.round</code>.</p>
</div>


                            </div>
                            <div id="Array.searchsorted" class="classattr">
                                        <input id="Array.searchsorted-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@util.implements(np.searchsorted, skip_params=[&#39;sorter&#39;], extra_params=_dedent(&#34;\n    method : str\n        One of &#39;scan&#39; (default), &#39;scan_unrolled&#39;, &#39;sort&#39; or &#39;compare_all&#39;. Controls the method used by the\n        implementation: &#39;scan&#39; tends to be more performant on CPU (particularly when ``a`` is\n        very large), &#39;scan_unrolled&#39; is more performant on GPU at the expense of additional compile time,\n        &#39;sort&#39; is often more performant on accelerator backends like GPU and TPU\n        (particularly when ``v`` is very large), and &#39;compare_all&#39; can be most performant\n        when ``a`` is very small.&#34;))</div>
        <div class="decorator">@partial(jit, static_argnames=(&#39;side&#39;, &#39;sorter&#39;, &#39;method&#39;))</div>

        <span class="def">def</span>
        <span class="name">searchsorted</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">v</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">side</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span>,</span><span class="param">	<span class="n">sorter</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;scan&#39;</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.searchsorted-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.searchsorted"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.searchsorted-6494"><a href="#Array.searchsorted-6494"><span class="linenos">6494</span></a><span class="nd">@util</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;sorter&#39;</span><span class="p">],</span>
</span><span id="Array.searchsorted-6495"><a href="#Array.searchsorted-6495"><span class="linenos">6495</span></a>  <span class="n">extra_params</span><span class="o">=</span><span class="n">_dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="Array.searchsorted-6496"><a href="#Array.searchsorted-6496"><span class="linenos">6496</span></a><span class="s2">    method : str</span>
</span><span id="Array.searchsorted-6497"><a href="#Array.searchsorted-6497"><span class="linenos">6497</span></a><span class="s2">        One of &#39;scan&#39; (default), &#39;scan_unrolled&#39;, &#39;sort&#39; or &#39;compare_all&#39;. Controls the method used by the</span>
</span><span id="Array.searchsorted-6498"><a href="#Array.searchsorted-6498"><span class="linenos">6498</span></a><span class="s2">        implementation: &#39;scan&#39; tends to be more performant on CPU (particularly when ``a`` is</span>
</span><span id="Array.searchsorted-6499"><a href="#Array.searchsorted-6499"><span class="linenos">6499</span></a><span class="s2">        very large), &#39;scan_unrolled&#39; is more performant on GPU at the expense of additional compile time,</span>
</span><span id="Array.searchsorted-6500"><a href="#Array.searchsorted-6500"><span class="linenos">6500</span></a><span class="s2">        &#39;sort&#39; is often more performant on accelerator backends like GPU and TPU</span>
</span><span id="Array.searchsorted-6501"><a href="#Array.searchsorted-6501"><span class="linenos">6501</span></a><span class="s2">        (particularly when ``v`` is very large), and &#39;compare_all&#39; can be most performant</span>
</span><span id="Array.searchsorted-6502"><a href="#Array.searchsorted-6502"><span class="linenos">6502</span></a><span class="s2">        when ``a`` is very small.&quot;&quot;&quot;</span><span class="p">))</span>
</span><span id="Array.searchsorted-6503"><a href="#Array.searchsorted-6503"><span class="linenos">6503</span></a><span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnames</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;side&#39;</span><span class="p">,</span> <span class="s1">&#39;sorter&#39;</span><span class="p">,</span> <span class="s1">&#39;method&#39;</span><span class="p">))</span>
</span><span id="Array.searchsorted-6504"><a href="#Array.searchsorted-6504"><span class="linenos">6504</span></a><span class="k">def</span> <span class="nf">searchsorted</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">side</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span>
</span><span id="Array.searchsorted-6505"><a href="#Array.searchsorted-6505"><span class="linenos">6505</span></a>                 <span class="n">sorter</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;scan&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.searchsorted-6506"><a href="#Array.searchsorted-6506"><span class="linenos">6506</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;searchsorted&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span><span id="Array.searchsorted-6507"><a href="#Array.searchsorted-6507"><span class="linenos">6507</span></a>  <span class="k">if</span> <span class="n">side</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">]:</span>
</span><span id="Array.searchsorted-6508"><a href="#Array.searchsorted-6508"><span class="linenos">6508</span></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">side</span><span class="si">!r}</span><span class="s2"> is an invalid value for keyword &#39;side&#39;. &quot;</span>
</span><span id="Array.searchsorted-6509"><a href="#Array.searchsorted-6509"><span class="linenos">6509</span></a>                     <span class="s2">&quot;Expected one of [&#39;left&#39;, &#39;right&#39;].&quot;</span><span class="p">)</span>
</span><span id="Array.searchsorted-6510"><a href="#Array.searchsorted-6510"><span class="linenos">6510</span></a>  <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;scan&#39;</span><span class="p">,</span> <span class="s1">&#39;scan_unrolled&#39;</span><span class="p">,</span> <span class="s1">&#39;sort&#39;</span><span class="p">,</span> <span class="s1">&#39;compare_all&#39;</span><span class="p">]:</span>
</span><span id="Array.searchsorted-6511"><a href="#Array.searchsorted-6511"><span class="linenos">6511</span></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Array.searchsorted-6512"><a href="#Array.searchsorted-6512"><span class="linenos">6512</span></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">method</span><span class="si">!r}</span><span class="s2"> is an invalid value for keyword &#39;method&#39;. &quot;</span>
</span><span id="Array.searchsorted-6513"><a href="#Array.searchsorted-6513"><span class="linenos">6513</span></a>        <span class="s2">&quot;Expected one of [&#39;sort&#39;, &#39;scan&#39;, &#39;scan_unrolled&#39;, &#39;compare_all&#39;].&quot;</span><span class="p">)</span>
</span><span id="Array.searchsorted-6514"><a href="#Array.searchsorted-6514"><span class="linenos">6514</span></a>  <span class="k">if</span> <span class="n">sorter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.searchsorted-6515"><a href="#Array.searchsorted-6515"><span class="linenos">6515</span></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;sorter is not implemented&quot;</span><span class="p">)</span>
</span><span id="Array.searchsorted-6516"><a href="#Array.searchsorted-6516"><span class="linenos">6516</span></a>  <span class="k">if</span> <span class="n">ndim</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Array.searchsorted-6517"><a href="#Array.searchsorted-6517"><span class="linenos">6517</span></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;a should be 1-dimensional&quot;</span><span class="p">)</span>
</span><span id="Array.searchsorted-6518"><a href="#Array.searchsorted-6518"><span class="linenos">6518</span></a>  <span class="n">a</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">promote_dtypes</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</span><span id="Array.searchsorted-6519"><a href="#Array.searchsorted-6519"><span class="linenos">6519</span></a>  <span class="n">dtype</span> <span class="o">=</span> <span class="n">int32</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span><span class="o">.</span><span class="n">max</span> <span class="k">else</span> <span class="n">int64</span>
</span><span id="Array.searchsorted-6520"><a href="#Array.searchsorted-6520"><span class="linenos">6520</span></a>  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Array.searchsorted-6521"><a href="#Array.searchsorted-6521"><span class="linenos">6521</span></a>    <span class="k">return</span> <span class="n">zeros_like</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="Array.searchsorted-6522"><a href="#Array.searchsorted-6522"><span class="linenos">6522</span></a>  <span class="n">impl</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="Array.searchsorted-6523"><a href="#Array.searchsorted-6523"><span class="linenos">6523</span></a>      <span class="s1">&#39;scan&#39;</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">_searchsorted_via_scan</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
</span><span id="Array.searchsorted-6524"><a href="#Array.searchsorted-6524"><span class="linenos">6524</span></a>      <span class="s1">&#39;scan_unrolled&#39;</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">_searchsorted_via_scan</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
</span><span id="Array.searchsorted-6525"><a href="#Array.searchsorted-6525"><span class="linenos">6525</span></a>      <span class="s1">&#39;sort&#39;</span><span class="p">:</span> <span class="n">_searchsorted_via_sort</span><span class="p">,</span>
</span><span id="Array.searchsorted-6526"><a href="#Array.searchsorted-6526"><span class="linenos">6526</span></a>      <span class="s1">&#39;compare_all&#39;</span><span class="p">:</span> <span class="n">_searchsorted_via_compare_all</span><span class="p">,</span>
</span><span id="Array.searchsorted-6527"><a href="#Array.searchsorted-6527"><span class="linenos">6527</span></a>  <span class="p">}[</span><span class="n">method</span><span class="p">]</span>
</span><span id="Array.searchsorted-6528"><a href="#Array.searchsorted-6528"><span class="linenos">6528</span></a>  <span class="k">return</span> <span class="n">impl</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">asarray</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">side</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span></pre></div>


            <div class="docstring"><p>Find indices where elements should be inserted to maintain order.</p>

<p>LAX-backend implementation of <code>numpy.searchsorted()</code>.</p>

<p><em>Original docstring below.</em></p>

<p>Find the indices into a sorted array <code>a</code> such that, if the
corresponding elements in <code>v</code> were inserted before the indices, the
order of <code>a</code> would be preserved.</p>

<p>Assuming that <code>a</code> is sorted:</p>

<p>======  ============================
<code>side</code>  returned index <code>i</code> satisfies
======  ============================
left    <code>a[i-1] &lt; v &lt;= a[i]</code>
right   <code>a[i-1] &lt;= v &lt; a[i]</code>
======  ============================</p>

<h2 id="parameters">Parameters</h2>

<p>a : 1-D array_like
    Input array. If <code>sorter</code> is None, then it must be sorted in
    ascending order, otherwise <code>sorter</code> must be an array of indices
    that sort it.
v : array_like
    Values to insert into <code>a</code>.
side : {'left', 'right'}, optional
    If 'left', the index of the first suitable location found is given.
    If 'right', return the last such index.  If there is no suitable
    index, return either 0 or N (where N is the length of <code>a</code>).
method : str
    One of 'scan' (default), 'scan_unrolled', 'sort' or 'compare_all'. Controls the method used by the
    implementation: 'scan' tends to be more performant on CPU (particularly when <code>a</code> is
    very large), 'scan_unrolled' is more performant on GPU at the expense of additional compile time,
    'sort' is often more performant on accelerator backends like GPU and TPU
    (particularly when <code>v</code> is very large), and 'compare_all' can be most performant
    when <code>a</code> is very small.</p>

<h2 id="returns">Returns</h2>

<p>indices : int or array of ints
    Array of insertion points with the same shape as <code>v</code>,
    or an integer if <code>v</code> is a scalar.</p>
</div>


                            </div>
                            <div id="Array.sort" class="classattr">
                                        <input id="Array.sort-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@util.implements(np.sort, extra_params=&#39;\nstable : bool, default=True\n    Specify whether to use a stable sort.\ndescending : bool, default=False\n    Specify whether to do a descending sort.\nkind : deprecated; specify sort algorithm using stable=True or stable=False\norder : not supported\n&#39;)</div>
        <div class="decorator">@partial(jit, static_argnames=(&#39;axis&#39;, &#39;kind&#39;, &#39;order&#39;, &#39;stable&#39;, &#39;descending&#39;))</div>

        <span class="def">def</span>
        <span class="name">sort</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">kind</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">order</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">stable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">descending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.sort-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.sort"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.sort-4993"><a href="#Array.sort-4993"><span class="linenos">4993</span></a><span class="nd">@util</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">,</span> <span class="n">extra_params</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="Array.sort-4994"><a href="#Array.sort-4994"><span class="linenos">4994</span></a><span class="s2">stable : bool, default=True</span>
</span><span id="Array.sort-4995"><a href="#Array.sort-4995"><span class="linenos">4995</span></a><span class="s2">    Specify whether to use a stable sort.</span>
</span><span id="Array.sort-4996"><a href="#Array.sort-4996"><span class="linenos">4996</span></a><span class="s2">descending : bool, default=False</span>
</span><span id="Array.sort-4997"><a href="#Array.sort-4997"><span class="linenos">4997</span></a><span class="s2">    Specify whether to do a descending sort.</span>
</span><span id="Array.sort-4998"><a href="#Array.sort-4998"><span class="linenos">4998</span></a><span class="s2">kind : deprecated; specify sort algorithm using stable=True or stable=False</span>
</span><span id="Array.sort-4999"><a href="#Array.sort-4999"><span class="linenos">4999</span></a><span class="s2">order : not supported</span>
</span><span id="Array.sort-5000"><a href="#Array.sort-5000"><span class="linenos">5000</span></a><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</span><span id="Array.sort-5001"><a href="#Array.sort-5001"><span class="linenos">5001</span></a><span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnames</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;axis&#39;</span><span class="p">,</span> <span class="s1">&#39;kind&#39;</span><span class="p">,</span> <span class="s1">&#39;order&#39;</span><span class="p">,</span> <span class="s1">&#39;stable&#39;</span><span class="p">,</span> <span class="s1">&#39;descending&#39;</span><span class="p">))</span>
</span><span id="Array.sort-5002"><a href="#Array.sort-5002"><span class="linenos">5002</span></a><span class="k">def</span> <span class="nf">sort</span><span class="p">(</span>
</span><span id="Array.sort-5003"><a href="#Array.sort-5003"><span class="linenos">5003</span></a>    <span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
</span><span id="Array.sort-5004"><a href="#Array.sort-5004"><span class="linenos">5004</span></a>    <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
</span><span id="Array.sort-5005"><a href="#Array.sort-5005"><span class="linenos">5005</span></a>    <span class="o">*</span><span class="p">,</span>
</span><span id="Array.sort-5006"><a href="#Array.sort-5006"><span class="linenos">5006</span></a>    <span class="n">kind</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.sort-5007"><a href="#Array.sort-5007"><span class="linenos">5007</span></a>    <span class="n">order</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.sort-5008"><a href="#Array.sort-5008"><span class="linenos">5008</span></a>    <span class="n">stable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="Array.sort-5009"><a href="#Array.sort-5009"><span class="linenos">5009</span></a>    <span class="n">descending</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Array.sort-5010"><a href="#Array.sort-5010"><span class="linenos">5010</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.sort-5011"><a href="#Array.sort-5011"><span class="linenos">5011</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;sort&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Array.sort-5012"><a href="#Array.sort-5012"><span class="linenos">5012</span></a>  <span class="k">if</span> <span class="n">kind</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.sort-5013"><a href="#Array.sort-5013"><span class="linenos">5013</span></a>    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;kind&#39; argument to sort is not supported. Use&quot;</span>
</span><span id="Array.sort-5014"><a href="#Array.sort-5014"><span class="linenos">5014</span></a>                    <span class="s2">&quot; stable=True or stable=False to specify sort stability.&quot;</span><span class="p">)</span>
</span><span id="Array.sort-5015"><a href="#Array.sort-5015"><span class="linenos">5015</span></a>  <span class="k">if</span> <span class="n">order</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.sort-5016"><a href="#Array.sort-5016"><span class="linenos">5016</span></a>    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;&#39;order&#39; argument to sort is not supported.&quot;</span><span class="p">)</span>
</span><span id="Array.sort-5017"><a href="#Array.sort-5017"><span class="linenos">5017</span></a>  <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.sort-5018"><a href="#Array.sort-5018"><span class="linenos">5018</span></a>    <span class="n">arr</span> <span class="o">=</span> <span class="n">ravel</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="Array.sort-5019"><a href="#Array.sort-5019"><span class="linenos">5019</span></a>    <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Array.sort-5020"><a href="#Array.sort-5020"><span class="linenos">5020</span></a>  <span class="k">else</span><span class="p">:</span>
</span><span id="Array.sort-5021"><a href="#Array.sort-5021"><span class="linenos">5021</span></a>    <span class="n">arr</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="Array.sort-5022"><a href="#Array.sort-5022"><span class="linenos">5022</span></a>  <span class="n">dimension</span> <span class="o">=</span> <span class="n">_canonicalize_axis</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
</span><span id="Array.sort-5023"><a href="#Array.sort-5023"><span class="linenos">5023</span></a>  <span class="n">result</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="n">dimension</span><span class="p">,</span> <span class="n">is_stable</span><span class="o">=</span><span class="n">stable</span><span class="p">)</span>
</span><span id="Array.sort-5024"><a href="#Array.sort-5024"><span class="linenos">5024</span></a>  <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">rev</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">dimensions</span><span class="o">=</span><span class="p">[</span><span class="n">dimension</span><span class="p">])</span> <span class="k">if</span> <span class="n">descending</span> <span class="k">else</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>Return a sorted copy of an array.</p>

<p>LAX-backend implementation of <code>numpy.sort()</code>.</p>

<p><em>Original docstring below.</em></p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Array to be sorted.
axis : int or None, optional
    Axis along which to sort. If None, the array is flattened before
    sorting. The default is -1, which sorts along the last axis.
kind : deprecated; specify sort algorithm using stable=True or stable=False
order : not supported
stable : bool, default=True
    Specify whether to use a stable sort.
descending : bool, default=False
    Specify whether to do a descending sort.</p>

<h2 id="returns">Returns</h2>

<p>sorted_array : ndarray
    Array of the same type and shape as <code>a</code>.</p>
</div>


                            </div>
                            <div id="Array.squeeze" class="classattr">
                                        <input id="Array.squeeze-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@util.implements(np.squeeze, lax_description=_ARRAY_VIEW_DOC)</div>

        <span class="def">def</span>
        <span class="name">squeeze</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.squeeze-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.squeeze"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.squeeze-1132"><a href="#Array.squeeze-1132"><span class="linenos">1132</span></a><span class="nd">@util</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">,</span> <span class="n">lax_description</span><span class="o">=</span><span class="n">_ARRAY_VIEW_DOC</span><span class="p">)</span>
</span><span id="Array.squeeze-1133"><a href="#Array.squeeze-1133"><span class="linenos">1133</span></a><span class="k">def</span> <span class="nf">squeeze</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.squeeze-1134"><a href="#Array.squeeze-1134"><span class="linenos">1134</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;squeeze&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Array.squeeze-1135"><a href="#Array.squeeze-1135"><span class="linenos">1135</span></a>  <span class="k">return</span> <span class="n">_squeeze</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">_ensure_index_tuple</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span> <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Remove axes of length one from <code>a</code>.</p>

<p>LAX-backend implementation of <code>numpy.squeeze()</code>.</p>

<p>The JAX version of this function may in some cases return a copy rather than a
view of the input.</p>

<p><em>Original docstring below.</em></p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Input data.
axis : None or int or tuple of ints, optional</p>

<h2 id="returns">Returns</h2>

<p>squeezed : ndarray
    The input array, but with all or a subset of the
    dimensions of length 1 removed. This is always <code>a</code> itself
    or a view into <code>a</code>. Note that if all axes are squeezed,
    the result is a 0d array and not a scalar.</p>
</div>


                            </div>
                            <div id="Array.std" class="classattr">
                                        <input id="Array.std-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@implements(np.std, skip_params=[&#39;out&#39;])</div>

        <span class="def">def</span>
        <span class="name">std</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">_src</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">SupportsDType</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.std-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.std"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.std-495"><a href="#Array.std-495"><span class="linenos">495</span></a><span class="nd">@implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">])</span>
</span><span id="Array.std-496"><a href="#Array.std-496"><span class="linenos">496</span></a><span class="k">def</span> <span class="nf">std</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">DTypeLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.std-497"><a href="#Array.std-497"><span class="linenos">497</span></a>        <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
</span><span id="Array.std-498"><a href="#Array.std-498"><span class="linenos">498</span></a>        <span class="n">where</span><span class="p">:</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.std-499"><a href="#Array.std-499"><span class="linenos">499</span></a>  <span class="k">return</span> <span class="n">_std</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">_ensure_optional_axes</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">ddof</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">,</span>
</span><span id="Array.std-500"><a href="#Array.std-500"><span class="linenos">500</span></a>              <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Compute the standard deviation along the specified axis.</p>

<p>LAX-backend implementation of <code>numpy.std()</code>.</p>

<p><em>Original docstring below.</em></p>

<p>Returns the standard deviation, a measure of the spread of a distribution,
of the array elements. The standard deviation is computed for the
flattened array by default, otherwise over the specified axis.</p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Calculate the standard deviation of these values.
axis : None or int or tuple of ints, optional
    Axis or axes along which the standard deviation is computed. The
    default is to compute the standard deviation of the flattened array.
dtype : dtype, optional
    Type to use in computing the standard deviation. For arrays of
    integer type the default is float64, for arrays of float types it is
    the same as the array type.
ddof : int, optional
    Means Delta Degrees of Freedom.  The divisor used in calculations
    is <code>N - ddof</code>, where <code>N</code> represents the number of elements.
    By default <code>ddof</code> is zero.
keepdims : bool, optional
    If this is set to True, the axes which are reduced are left
    in the result as dimensions with size one. With this option,
    the result will broadcast correctly against the input array.</p>

<pre><code>If the default value is passed, then `keepdims` will not be
passed through to the `std` method of sub-classes of
`ndarray`, however any non-default value will be.  If the
sub-class' method does not implement `keepdims` any
exceptions will be raised.
</code></pre>

<p>where : array_like of bool, optional
    Elements to include in the standard deviation.
    See <code>~numpy.ufunc.reduce</code> for details.</p>

<h2 id="returns">Returns</h2>

<p>standard_deviation : ndarray, see dtype parameter above.
    If <code>out</code> is None, return a new array containing the standard deviation,
    otherwise return a reference to the output array.</p>
</div>


                            </div>
                            <div id="Array.sum" class="classattr">
                                        <input id="Array.sum-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@implements(np.sum, skip_params=[&#39;out&#39;], extra_params=_PROMOTE_INTEGERS_DOC)</div>

        <span class="def">def</span>
        <span class="name">sum</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">_src</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">SupportsDType</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">initial</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">promote_integers</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.sum-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.sum"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.sum-228"><a href="#Array.sum-228"><span class="linenos">228</span></a><span class="nd">@implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">],</span> <span class="n">extra_params</span><span class="o">=</span><span class="n">_PROMOTE_INTEGERS_DOC</span><span class="p">)</span>
</span><span id="Array.sum-229"><a href="#Array.sum-229"><span class="linenos">229</span></a><span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">DTypeLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.sum-230"><a href="#Array.sum-230"><span class="linenos">230</span></a>        <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">initial</span><span class="p">:</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.sum-231"><a href="#Array.sum-231"><span class="linenos">231</span></a>        <span class="n">where</span><span class="p">:</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">promote_integers</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.sum-232"><a href="#Array.sum-232"><span class="linenos">232</span></a>  <span class="k">return</span> <span class="n">_reduce_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">_ensure_optional_axes</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">out</span><span class="p">,</span>
</span><span id="Array.sum-233"><a href="#Array.sum-233"><span class="linenos">233</span></a>                     <span class="n">keepdims</span><span class="o">=</span><span class="n">keepdims</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="n">initial</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">,</span>
</span><span id="Array.sum-234"><a href="#Array.sum-234"><span class="linenos">234</span></a>                     <span class="n">promote_integers</span><span class="o">=</span><span class="n">promote_integers</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Sum of array elements over a given axis.</p>

<p>LAX-backend implementation of <code>numpy.sum()</code>.</p>

<p><em>Original docstring below.</em></p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Elements to sum.
axis : None or int or tuple of ints, optional
    Axis or axes along which a sum is performed.  The default,
    axis=None, will sum all of the elements of the input array.  If
    axis is negative it counts from the last to the first axis.
dtype : dtype, optional
    The type of the returned array and of the accumulator in which the
    elements are summed.  The dtype of <code>a</code> is used by default unless <code>a</code>
    has an integer dtype of less precision than the default platform
    integer.  In that case, if <code>a</code> is signed then the platform integer
    is used while if <code>a</code> is unsigned then an unsigned integer of the
    same precision as the platform integer is used.
keepdims : bool, optional
    If this is set to True, the axes which are reduced are left
    in the result as dimensions with size one. With this option,
    the result will broadcast correctly against the input array.</p>

<pre><code>If the default value is passed, then `keepdims` will not be
passed through to the `sum` method of sub-classes of
`ndarray`, however any non-default value will be.  If the
sub-class' method does not implement `keepdims` any
exceptions will be raised.
</code></pre>

<p>initial : scalar, optional
    Starting value for the sum. See <code>~numpy.ufunc.reduce</code> for details.
where : array_like of bool, optional
    Elements to include in the sum. See <code>~numpy.ufunc.reduce</code> for details.
promote_integers : bool, default=True
    If True, then integer inputs will be promoted to the widest available integer
    dtype, following numpy's behavior. If False, the result will have the same dtype
    as the input. <code>promote_integers</code> is ignored if <code><a href="#Array.dtype">dtype</a></code> is specified.</p>

<h2 id="returns">Returns</h2>

<p>sum_along_axis : ndarray
    An array with the same shape as <code>a</code>, with the specified
    axis removed.   If <code>a</code> is a 0-d array, or if <code>axis</code> is None, a scalar
    is returned.  If an output array is specified, a reference to
    <code>out</code> is returned.</p>
</div>


                            </div>
                            <div id="Array.swapaxes" class="classattr">
                                        <input id="Array.swapaxes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@util.implements(np.swapaxes, lax_description=_ARRAY_VIEW_DOC)</div>
        <div class="decorator">@partial(jit, static_argnames=(&#39;axis1&#39;, &#39;axis2&#39;), inline=True)</div>

        <span class="def">def</span>
        <span class="name">swapaxes</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis1</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">axis2</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.swapaxes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.swapaxes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.swapaxes-1155"><a href="#Array.swapaxes-1155"><span class="linenos">1155</span></a><span class="nd">@util</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">,</span> <span class="n">lax_description</span><span class="o">=</span><span class="n">_ARRAY_VIEW_DOC</span><span class="p">)</span>
</span><span id="Array.swapaxes-1156"><a href="#Array.swapaxes-1156"><span class="linenos">1156</span></a><span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnames</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;axis1&#39;</span><span class="p">,</span> <span class="s1">&#39;axis2&#39;</span><span class="p">),</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Array.swapaxes-1157"><a href="#Array.swapaxes-1157"><span class="linenos">1157</span></a><span class="k">def</span> <span class="nf">swapaxes</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axis1</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">axis2</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.swapaxes-1158"><a href="#Array.swapaxes-1158"><span class="linenos">1158</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;swapaxes&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Array.swapaxes-1159"><a href="#Array.swapaxes-1159"><span class="linenos">1159</span></a>  <span class="n">perm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ndim</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</span><span id="Array.swapaxes-1160"><a href="#Array.swapaxes-1160"><span class="linenos">1160</span></a>  <span class="n">perm</span><span class="p">[</span><span class="n">axis1</span><span class="p">],</span> <span class="n">perm</span><span class="p">[</span><span class="n">axis2</span><span class="p">]</span> <span class="o">=</span> <span class="n">perm</span><span class="p">[</span><span class="n">axis2</span><span class="p">],</span> <span class="n">perm</span><span class="p">[</span><span class="n">axis1</span><span class="p">]</span>
</span><span id="Array.swapaxes-1161"><a href="#Array.swapaxes-1161"><span class="linenos">1161</span></a>  <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">perm</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Interchange two axes of an array.</p>

<p>LAX-backend implementation of <code>numpy.swapaxes()</code>.</p>

<p>The JAX version of this function may in some cases return a copy rather than a
view of the input.</p>

<p><em>Original docstring below.</em></p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Input array.
axis1 : int
    First axis.
axis2 : int
    Second axis.</p>

<h2 id="returns">Returns</h2>

<p>a_swapped : ndarray
    For NumPy &gt;= 1.10.0, if <code>a</code> is an ndarray, then a view of <code>a</code> is
    returned; otherwise a new array is created. For earlier NumPy
    versions a view of <code>a</code> is returned only if the order of the
    axes is changed, otherwise the input array is returned.</p>
</div>


                            </div>
                            <div id="Array.take" class="classattr">
                                        <input id="Array.take-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@util.implements(np.take, skip_params=[&#39;out&#39;], lax_description=&#39;\nBy default, JAX assumes that all indices are in-bounds. Alternative out-of-bound\nindex semantics can be specified via the ``mode`` parameter (see below).\n&#39;, extra_params=&#39;\nmode : string, default=&#34;fill&#34;\n    Out-of-bounds indexing mode. The default mode=&#34;fill&#34; returns invalid values\n    (e.g. NaN) for out-of bounds indices (see also ``fill_value`` below).\n    For more discussion of mode options, see :attr:`jax.numpy.ndarray.at`.\nfill_value : optional\n    The fill value to return for out-of-bounds slices when mode is \&#39;fill\&#39;. Ignored\n    otherwise. Defaults to NaN for inexact types, the largest negative value for\n    signed types, the largest positive value for unsigned types, and True for booleans.\nunique_indices : bool, default=False\n    If True, the implementation will assume that the indices are unique,\n    which can result in more efficient execution on some backends.\nindices_are_sorted : bool, default=False\n    If True, the implementation will assume that the indices are sorted in\n    ascending order, which can lead to more efficient execution on some backends.\n&#39;)</div>

        <span class="def">def</span>
        <span class="name">take</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">indices</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">unique_indices</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">indices_are_sorted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">fill_value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.take-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.take"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.take-5275"><a href="#Array.take-5275"><span class="linenos">5275</span></a><span class="nd">@util</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">take</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">],</span>
</span><span id="Array.take-5276"><a href="#Array.take-5276"><span class="linenos">5276</span></a>        <span class="n">lax_description</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="Array.take-5277"><a href="#Array.take-5277"><span class="linenos">5277</span></a><span class="s2">By default, JAX assumes that all indices are in-bounds. Alternative out-of-bound</span>
</span><span id="Array.take-5278"><a href="#Array.take-5278"><span class="linenos">5278</span></a><span class="s2">index semantics can be specified via the ``mode`` parameter (see below).</span>
</span><span id="Array.take-5279"><a href="#Array.take-5279"><span class="linenos">5279</span></a><span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
</span><span id="Array.take-5280"><a href="#Array.take-5280"><span class="linenos">5280</span></a>        <span class="n">extra_params</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="Array.take-5281"><a href="#Array.take-5281"><span class="linenos">5281</span></a><span class="s2">mode : string, default=&quot;fill&quot;</span>
</span><span id="Array.take-5282"><a href="#Array.take-5282"><span class="linenos">5282</span></a><span class="s2">    Out-of-bounds indexing mode. The default mode=&quot;fill&quot; returns invalid values</span>
</span><span id="Array.take-5283"><a href="#Array.take-5283"><span class="linenos">5283</span></a><span class="s2">    (e.g. NaN) for out-of bounds indices (see also ``fill_value`` below).</span>
</span><span id="Array.take-5284"><a href="#Array.take-5284"><span class="linenos">5284</span></a><span class="s2">    For more discussion of mode options, see :attr:`jax.numpy.ndarray.at`.</span>
</span><span id="Array.take-5285"><a href="#Array.take-5285"><span class="linenos">5285</span></a><span class="s2">fill_value : optional</span>
</span><span id="Array.take-5286"><a href="#Array.take-5286"><span class="linenos">5286</span></a><span class="s2">    The fill value to return for out-of-bounds slices when mode is &#39;fill&#39;. Ignored</span>
</span><span id="Array.take-5287"><a href="#Array.take-5287"><span class="linenos">5287</span></a><span class="s2">    otherwise. Defaults to NaN for inexact types, the largest negative value for</span>
</span><span id="Array.take-5288"><a href="#Array.take-5288"><span class="linenos">5288</span></a><span class="s2">    signed types, the largest positive value for unsigned types, and True for booleans.</span>
</span><span id="Array.take-5289"><a href="#Array.take-5289"><span class="linenos">5289</span></a><span class="s2">unique_indices : bool, default=False</span>
</span><span id="Array.take-5290"><a href="#Array.take-5290"><span class="linenos">5290</span></a><span class="s2">    If True, the implementation will assume that the indices are unique,</span>
</span><span id="Array.take-5291"><a href="#Array.take-5291"><span class="linenos">5291</span></a><span class="s2">    which can result in more efficient execution on some backends.</span>
</span><span id="Array.take-5292"><a href="#Array.take-5292"><span class="linenos">5292</span></a><span class="s2">indices_are_sorted : bool, default=False</span>
</span><span id="Array.take-5293"><a href="#Array.take-5293"><span class="linenos">5293</span></a><span class="s2">    If True, the implementation will assume that the indices are sorted in</span>
</span><span id="Array.take-5294"><a href="#Array.take-5294"><span class="linenos">5294</span></a><span class="s2">    ascending order, which can lead to more efficient execution on some backends.</span>
</span><span id="Array.take-5295"><a href="#Array.take-5295"><span class="linenos">5295</span></a><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</span><span id="Array.take-5296"><a href="#Array.take-5296"><span class="linenos">5296</span></a><span class="k">def</span> <span class="nf">take</span><span class="p">(</span>
</span><span id="Array.take-5297"><a href="#Array.take-5297"><span class="linenos">5297</span></a>    <span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
</span><span id="Array.take-5298"><a href="#Array.take-5298"><span class="linenos">5298</span></a>    <span class="n">indices</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
</span><span id="Array.take-5299"><a href="#Array.take-5299"><span class="linenos">5299</span></a>    <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.take-5300"><a href="#Array.take-5300"><span class="linenos">5300</span></a>    <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.take-5301"><a href="#Array.take-5301"><span class="linenos">5301</span></a>    <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.take-5302"><a href="#Array.take-5302"><span class="linenos">5302</span></a>    <span class="n">unique_indices</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Array.take-5303"><a href="#Array.take-5303"><span class="linenos">5303</span></a>    <span class="n">indices_are_sorted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="Array.take-5304"><a href="#Array.take-5304"><span class="linenos">5304</span></a>    <span class="n">fill_value</span><span class="p">:</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.take-5305"><a href="#Array.take-5305"><span class="linenos">5305</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.take-5306"><a href="#Array.take-5306"><span class="linenos">5306</span></a>  <span class="k">return</span> <span class="n">_take</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">operator</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span> <span class="n">out</span><span class="p">,</span>
</span><span id="Array.take-5307"><a href="#Array.take-5307"><span class="linenos">5307</span></a>               <span class="n">mode</span><span class="p">,</span> <span class="n">unique_indices</span><span class="o">=</span><span class="n">unique_indices</span><span class="p">,</span> <span class="n">indices_are_sorted</span><span class="o">=</span><span class="n">indices_are_sorted</span><span class="p">,</span>
</span><span id="Array.take-5308"><a href="#Array.take-5308"><span class="linenos">5308</span></a>               <span class="n">fill_value</span><span class="o">=</span><span class="n">fill_value</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Take elements from an array along an axis.</p>

<p>LAX-backend implementation of <code>numpy.take()</code>.</p>

<p>By default, JAX assumes that all indices are in-bounds. Alternative out-of-bound
index semantics can be specified via the <code>mode</code> parameter (see below).</p>

<p><em>Original docstring below.</em></p>

<p>When axis is not None, this function does the same thing as "fancy"
indexing (indexing arrays using arrays); however, it can be easier to use
if you need elements along a given axis. A call such as
<code>np.take(arr, indices, axis=3)</code> is equivalent to
<code>arr[:,:,:,indices,...]</code>.</p>

<p>Explained without fancy indexing, this is equivalent to the following use
of <code>ndindex</code>, which sets each of <code>ii</code>, <code>jj</code>, and <code>kk</code> to a tuple of
indices::</p>

<pre><code>Ni, Nk = a.shape[:axis], a.shape[axis+1:]
Nj = indices.shape
for ii in ndindex(Ni):
    for jj in ndindex(Nj):
        for kk in ndindex(Nk):
            out[ii + jj + kk] = a[ii + (indices[jj],) + kk]
</code></pre>

<h2 id="parameters">Parameters</h2>

<p>a : array_like (Ni..., M, Nk...)
    The source array.
indices : array_like (Nj...)
    The indices of the values to extract.
axis : int, optional
    The axis over which to select values. By default, the flattened
    input array is used.
mode : string, default="fill"
    Out-of-bounds indexing mode. The default mode="fill" returns invalid values
    (e.g. NaN) for out-of bounds indices (see also <code>fill_value</code> below).
    For more discussion of mode options, see <code>jax.numpy.ndarray.at</code>.
fill_value : optional
    The fill value to return for out-of-bounds slices when mode is 'fill'. Ignored
    otherwise. Defaults to NaN for inexact types, the largest negative value for
    signed types, the largest positive value for unsigned types, and True for booleans.
unique_indices : bool, default=False
    If True, the implementation will assume that the indices are unique,
    which can result in more efficient execution on some backends.
indices_are_sorted : bool, default=False
    If True, the implementation will assume that the indices are sorted in
    ascending order, which can lead to more efficient execution on some backends.</p>

<h2 id="returns">Returns</h2>

<p>out : ndarray (Ni..., Nj..., Nk...)
    The returned array has the same type as <code>a</code>.</p>
</div>


                            </div>
                            <div id="Array.trace" class="classattr">
                                        <input id="Array.trace-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@util.implements(np.trace, skip_params=[&#39;out&#39;])</div>
        <div class="decorator">@partial(jit, static_argnames=(&#39;offset&#39;, &#39;axis1&#39;, &#39;axis2&#39;, &#39;dtype&#39;))</div>

        <span class="def">def</span>
        <span class="name">trace</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">axis1</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">axis2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">_src</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">SupportsDType</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.trace-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.trace"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.trace-3404"><a href="#Array.trace-3404"><span class="linenos">3404</span></a><span class="nd">@util</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">])</span>
</span><span id="Array.trace-3405"><a href="#Array.trace-3405"><span class="linenos">3405</span></a><span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnames</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;offset&#39;</span><span class="p">,</span> <span class="s1">&#39;axis1&#39;</span><span class="p">,</span> <span class="s1">&#39;axis2&#39;</span><span class="p">,</span> <span class="s1">&#39;dtype&#39;</span><span class="p">))</span>
</span><span id="Array.trace-3406"><a href="#Array.trace-3406"><span class="linenos">3406</span></a><span class="k">def</span> <span class="nf">trace</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis1</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis2</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="Array.trace-3407"><a href="#Array.trace-3407"><span class="linenos">3407</span></a>          <span class="n">dtype</span><span class="p">:</span> <span class="n">DTypeLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.trace-3408"><a href="#Array.trace-3408"><span class="linenos">3408</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;trace&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Array.trace-3409"><a href="#Array.trace-3409"><span class="linenos">3409</span></a>  <span class="k">if</span> <span class="n">out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.trace-3410"><a href="#Array.trace-3410"><span class="linenos">3410</span></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;The &#39;out&#39; argument to jnp.trace is not supported.&quot;</span><span class="p">)</span>
</span><span id="Array.trace-3411"><a href="#Array.trace-3411"><span class="linenos">3411</span></a>  <span class="n">dtypes</span><span class="o">.</span><span class="n">check_user_dtype_supported</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="s2">&quot;trace&quot;</span><span class="p">)</span>
</span><span id="Array.trace-3412"><a href="#Array.trace-3412"><span class="linenos">3412</span></a>
</span><span id="Array.trace-3413"><a href="#Array.trace-3413"><span class="linenos">3413</span></a>  <span class="n">a_shape</span> <span class="o">=</span> <span class="n">shape</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="Array.trace-3414"><a href="#Array.trace-3414"><span class="linenos">3414</span></a>  <span class="n">a</span> <span class="o">=</span> <span class="n">moveaxis</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">axis1</span><span class="p">,</span> <span class="n">axis2</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</span><span id="Array.trace-3415"><a href="#Array.trace-3415"><span class="linenos">3415</span></a>
</span><span id="Array.trace-3416"><a href="#Array.trace-3416"><span class="linenos">3416</span></a>  <span class="c1"># Mask out the diagonal and reduce.</span>
</span><span id="Array.trace-3417"><a href="#Array.trace-3417"><span class="linenos">3417</span></a>  <span class="n">a</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">eye</span><span class="p">(</span><span class="n">a_shape</span><span class="p">[</span><span class="n">axis1</span><span class="p">],</span> <span class="n">a_shape</span><span class="p">[</span><span class="n">axis2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">),</span>
</span><span id="Array.trace-3418"><a href="#Array.trace-3418"><span class="linenos">3418</span></a>            <span class="n">a</span><span class="p">,</span> <span class="n">zeros_like</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
</span><span id="Array.trace-3419"><a href="#Array.trace-3419"><span class="linenos">3419</span></a>  <span class="k">return</span> <span class="n">reductions</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the sum along diagonals of the array.</p>

<p>LAX-backend implementation of <code>numpy.trace()</code>.</p>

<p><em>Original docstring below.</em></p>

<p>If <code>a</code> is 2-D, the sum along its diagonal with the given offset
is returned, i.e., the sum of elements <code>a[i,i+offset]</code> for all i.</p>

<p>If <code>a</code> has more than two dimensions, then the axes specified by axis1 and
axis2 are used to determine the 2-D sub-arrays whose traces are returned.
The shape of the resulting array is the same as that of <code>a</code> with <code>axis1</code>
and <code>axis2</code> removed.</p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Input array, from which the diagonals are taken.
offset : int, optional
    Offset of the diagonal from the main diagonal. Can be both positive
    and negative. Defaults to 0.
axis1, axis2 : int, optional
    Axes to be used as the first and second axis of the 2-D sub-arrays
    from which the diagonals should be taken. Defaults are the first two
    axes of <code>a</code>.
dtype : dtype, optional
    Determines the data-type of the returned array and of the accumulator
    where the elements are summed. If dtype has the value None and <code>a</code> is
    of integer type of precision less than the default integer
    precision, then the default integer precision is used. Otherwise,
    the precision is the same as that of <code>a</code>.</p>

<h2 id="returns">Returns</h2>

<p>sum_along_diagonals : ndarray
    If <code>a</code> is 2-D, the sum along the diagonal is returned.  If <code>a</code> has
    larger dimensions, then an array of sums along diagonals is returned.</p>
</div>


                            </div>
                            <div id="Array.transpose" class="classattr">
                                        <input id="Array.transpose-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">transpose</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">a</span><span class="p">:</span> <span class="n"><a href="#Array">Array</a></span>, </span><span class="param"><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.transpose-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.transpose"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.transpose-97"><a href="#Array.transpose-97"><span class="linenos"> 97</span></a><span class="k">def</span> <span class="nf">_transpose</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.transpose-98"><a href="#Array.transpose-98"><span class="linenos"> 98</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Returns a view of the array with axes transposed.</span>
</span><span id="Array.transpose-99"><a href="#Array.transpose-99"><span class="linenos"> 99</span></a>
</span><span id="Array.transpose-100"><a href="#Array.transpose-100"><span class="linenos">100</span></a><span class="sd">  Refer to :func:`jax.numpy.transpose` for full documentation.</span>
</span><span id="Array.transpose-101"><a href="#Array.transpose-101"><span class="linenos">101</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="Array.transpose-102"><a href="#Array.transpose-102"><span class="linenos">102</span></a>  <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="p">:</span>
</span><span id="Array.transpose-103"><a href="#Array.transpose-103"><span class="linenos">103</span></a>    <span class="n">axis</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Array.transpose-104"><a href="#Array.transpose-104"><span class="linenos">104</span></a>  <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Array.transpose-105"><a href="#Array.transpose-105"><span class="linenos">105</span></a>    <span class="n">axis</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">_ensure_index_tuple</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Array.transpose-106"><a href="#Array.transpose-106"><span class="linenos">106</span></a>  <span class="k">else</span><span class="p">:</span>
</span><span id="Array.transpose-107"><a href="#Array.transpose-107"><span class="linenos">107</span></a>    <span class="n">axis</span> <span class="o">=</span> <span class="n">_ensure_index_tuple</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span id="Array.transpose-108"><a href="#Array.transpose-108"><span class="linenos">108</span></a>  <span class="k">return</span> <span class="n">lax_numpy</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns a view of the array with axes transposed.</p>

<p>Refer to <code>jax.numpy.transpose()</code> for full documentation.</p>
</div>


                            </div>
                            <div id="Array.var" class="classattr">
                                        <input id="Array.var-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@implements(np.var, skip_params=[&#39;out&#39;])</div>

        <span class="def">def</span>
        <span class="name">var</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">a</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]</span>,</span><span class="param">	<span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">_src</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">SupportsDType</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">where</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n"><a href="#Array">Array</a></span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">bool_</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.var-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.var"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.var-434"><a href="#Array.var-434"><span class="linenos">434</span></a><span class="nd">@implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">,</span> <span class="n">skip_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">])</span>
</span><span id="Array.var-435"><a href="#Array.var-435"><span class="linenos">435</span></a><span class="k">def</span> <span class="nf">var</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Axis</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">DTypeLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="Array.var-436"><a href="#Array.var-436"><span class="linenos">436</span></a>        <span class="n">out</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ddof</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
</span><span id="Array.var-437"><a href="#Array.var-437"><span class="linenos">437</span></a>        <span class="n">where</span><span class="p">:</span> <span class="n">ArrayLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.var-438"><a href="#Array.var-438"><span class="linenos">438</span></a>  <span class="k">return</span> <span class="n">_var</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">_ensure_optional_axes</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">ddof</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">,</span>
</span><span id="Array.var-439"><a href="#Array.var-439"><span class="linenos">439</span></a>              <span class="n">where</span><span class="o">=</span><span class="n">where</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Compute the variance along the specified axis.</p>

<p>LAX-backend implementation of <code>numpy.var()</code>.</p>

<p><em>Original docstring below.</em></p>

<p>Returns the variance of the array elements, a measure of the spread of a
distribution.  The variance is computed for the flattened array by
default, otherwise over the specified axis.</p>

<h2 id="parameters">Parameters</h2>

<p>a : array_like
    Array containing numbers whose variance is desired.  If <code>a</code> is not an
    array, a conversion is attempted.
axis : None or int or tuple of ints, optional
    Axis or axes along which the variance is computed.  The default is to
    compute the variance of the flattened array.
dtype : data-type, optional
    Type to use in computing the variance.  For arrays of integer type
    the default is <code>float64</code>; for arrays of float types it is the same as
    the array type.
ddof : int, optional
    "Delta Degrees of Freedom": the divisor used in the calculation is
    <code>N - ddof</code>, where <code>N</code> represents the number of elements. By
    default <code>ddof</code> is zero.
keepdims : bool, optional
    If this is set to True, the axes which are reduced are left
    in the result as dimensions with size one. With this option,
    the result will broadcast correctly against the input array.</p>

<pre><code>If the default value is passed, then `keepdims` will not be
passed through to the `var` method of sub-classes of
`ndarray`, however any non-default value will be.  If the
sub-class' method does not implement `keepdims` any
exceptions will be raised.
</code></pre>

<p>where : array_like of bool, optional
    Elements to include in the variance. See <code>~numpy.ufunc.reduce</code> for
    details.</p>

<h2 id="returns">Returns</h2>

<p>variance : ndarray, see dtype parameter above
    If <code>out=None</code>, returns a new array containing the variance;
    otherwise, a reference to the output array is returned.</p>
</div>


                            </div>
                            <div id="Array.view" class="classattr">
                                        <input id="Array.view-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">view</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">arr</span><span class="p">:</span> <span class="n"><a href="#Array">Array</a></span>,</span><span class="param">	<span class="n">dtype</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">_src</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">SupportsDType</span><span class="p">,</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="nb">type</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Array.view-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.view"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.view-162"><a href="#Array.view-162"><span class="linenos">162</span></a><span class="k">def</span> <span class="nf">_view</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">DTypeLike</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.view-163"><a href="#Array.view-163"><span class="linenos">163</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Return a bitwise copy of the array, viewed as a new dtype.</span>
</span><span id="Array.view-164"><a href="#Array.view-164"><span class="linenos">164</span></a>
</span><span id="Array.view-165"><a href="#Array.view-165"><span class="linenos">165</span></a><span class="sd">  This is fuller-featured wrapper around :func:`jax.lax.bitcast_convert_type`.</span>
</span><span id="Array.view-166"><a href="#Array.view-166"><span class="linenos">166</span></a>
</span><span id="Array.view-167"><a href="#Array.view-167"><span class="linenos">167</span></a><span class="sd">  If the source and target dtype have the same bitwidth, the result has the same</span>
</span><span id="Array.view-168"><a href="#Array.view-168"><span class="linenos">168</span></a><span class="sd">  shape as the input array. If the bitwidth of the target dtype is different</span>
</span><span id="Array.view-169"><a href="#Array.view-169"><span class="linenos">169</span></a><span class="sd">  from the source, the size of the last axis of the result is adjusted</span>
</span><span id="Array.view-170"><a href="#Array.view-170"><span class="linenos">170</span></a><span class="sd">  accordingly.</span>
</span><span id="Array.view-171"><a href="#Array.view-171"><span class="linenos">171</span></a>
</span><span id="Array.view-172"><a href="#Array.view-172"><span class="linenos">172</span></a><span class="sd">  &gt;&gt;&gt; jnp.zeros([1,2,3], dtype=jnp.int16).view(jnp.int8).shape</span>
</span><span id="Array.view-173"><a href="#Array.view-173"><span class="linenos">173</span></a><span class="sd">  (1, 2, 6)</span>
</span><span id="Array.view-174"><a href="#Array.view-174"><span class="linenos">174</span></a><span class="sd">  &gt;&gt;&gt; jnp.zeros([1,2,4], dtype=jnp.int8).view(jnp.int16).shape</span>
</span><span id="Array.view-175"><a href="#Array.view-175"><span class="linenos">175</span></a><span class="sd">  (1, 2, 2)</span>
</span><span id="Array.view-176"><a href="#Array.view-176"><span class="linenos">176</span></a>
</span><span id="Array.view-177"><a href="#Array.view-177"><span class="linenos">177</span></a><span class="sd">  Conversions involving booleans are not well-defined in all situations. With</span>
</span><span id="Array.view-178"><a href="#Array.view-178"><span class="linenos">178</span></a><span class="sd">  regards to the shape of result as explained above, booleans are treated as</span>
</span><span id="Array.view-179"><a href="#Array.view-179"><span class="linenos">179</span></a><span class="sd">  having a bitwidth of 8. However, when converting to a boolean array, the input</span>
</span><span id="Array.view-180"><a href="#Array.view-180"><span class="linenos">180</span></a><span class="sd">  should only contain 0 or 1 bytes. Otherwise, results may be unpredictable or</span>
</span><span id="Array.view-181"><a href="#Array.view-181"><span class="linenos">181</span></a><span class="sd">  may change depending on how the result is used.</span>
</span><span id="Array.view-182"><a href="#Array.view-182"><span class="linenos">182</span></a>
</span><span id="Array.view-183"><a href="#Array.view-183"><span class="linenos">183</span></a><span class="sd">  This conversion is guaranteed and safe:</span>
</span><span id="Array.view-184"><a href="#Array.view-184"><span class="linenos">184</span></a><span class="sd">  &gt;&gt;&gt; jnp.array([1, 0, 1], dtype=jnp.int8).view(jnp.bool_)</span>
</span><span id="Array.view-185"><a href="#Array.view-185"><span class="linenos">185</span></a><span class="sd">  Array([ True, False,  True], dtype=bool)</span>
</span><span id="Array.view-186"><a href="#Array.view-186"><span class="linenos">186</span></a>
</span><span id="Array.view-187"><a href="#Array.view-187"><span class="linenos">187</span></a><span class="sd">  However, there are no guarantees about the results of any expression involving</span>
</span><span id="Array.view-188"><a href="#Array.view-188"><span class="linenos">188</span></a><span class="sd">  a view such as this: `jnp.array([1, 2, 3], dtype=jnp.int8).view(jnp.bool_)`.</span>
</span><span id="Array.view-189"><a href="#Array.view-189"><span class="linenos">189</span></a><span class="sd">  In particular, the results may change between JAX releases and depending on</span>
</span><span id="Array.view-190"><a href="#Array.view-190"><span class="linenos">190</span></a><span class="sd">  the platform. To safely convert such an array to a boolean array, compare it</span>
</span><span id="Array.view-191"><a href="#Array.view-191"><span class="linenos">191</span></a><span class="sd">  with `0`:</span>
</span><span id="Array.view-192"><a href="#Array.view-192"><span class="linenos">192</span></a>
</span><span id="Array.view-193"><a href="#Array.view-193"><span class="linenos">193</span></a><span class="sd">  &gt;&gt;&gt; jnp.array([1, 2, 0], dtype=jnp.int8) != 0</span>
</span><span id="Array.view-194"><a href="#Array.view-194"><span class="linenos">194</span></a><span class="sd">  Array([ True,  True, False], dtype=bool)</span>
</span><span id="Array.view-195"><a href="#Array.view-195"><span class="linenos">195</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="Array.view-196"><a href="#Array.view-196"><span class="linenos">196</span></a>  <span class="k">if</span> <span class="nb">type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Array.view-197"><a href="#Array.view-197"><span class="linenos">197</span></a>    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;`type` argument of array.view() is not supported.&quot;</span><span class="p">)</span>
</span><span id="Array.view-198"><a href="#Array.view-198"><span class="linenos">198</span></a>
</span><span id="Array.view-199"><a href="#Array.view-199"><span class="linenos">199</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;view&quot;</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span>
</span><span id="Array.view-200"><a href="#Array.view-200"><span class="linenos">200</span></a>  <span class="n">arr</span> <span class="o">=</span> <span class="n">lax_numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
</span><span id="Array.view-201"><a href="#Array.view-201"><span class="linenos">201</span></a>
</span><span id="Array.view-202"><a href="#Array.view-202"><span class="linenos">202</span></a>  <span class="n">dtypes</span><span class="o">.</span><span class="n">check_user_dtype_supported</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="s2">&quot;view&quot;</span><span class="p">)</span>
</span><span id="Array.view-203"><a href="#Array.view-203"><span class="linenos">203</span></a>  <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">canonicalize_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="Array.view-204"><a href="#Array.view-204"><span class="linenos">204</span></a>
</span><span id="Array.view-205"><a href="#Array.view-205"><span class="linenos">205</span></a>  <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Array.view-206"><a href="#Array.view-206"><span class="linenos">206</span></a>    <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span> <span class="o">!=</span> <span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span><span class="p">:</span>
</span><span id="Array.view-207"><a href="#Array.view-207"><span class="linenos">207</span></a>      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;view() of a 0d array is only supported if the itemsize is unchanged.&quot;</span><span class="p">)</span>
</span><span id="Array.view-208"><a href="#Array.view-208"><span class="linenos">208</span></a>    <span class="k">return</span> <span class="n">_view</span><span class="p">(</span><span class="n">lax</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,)),</span> <span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
</span><span id="Array.view-209"><a href="#Array.view-209"><span class="linenos">209</span></a>
</span><span id="Array.view-210"><a href="#Array.view-210"><span class="linenos">210</span></a>  <span class="k">if</span> <span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span><span class="p">)</span> <span class="o">%</span> <span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Array.view-211"><a href="#Array.view-211"><span class="linenos">211</span></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;When changing to a larger dtype, its size must be a divisor &quot;</span>
</span><span id="Array.view-212"><a href="#Array.view-212"><span class="linenos">212</span></a>                     <span class="s2">&quot;of the total size in bytes of the last axis of the array.&quot;</span><span class="p">)</span>
</span><span id="Array.view-213"><a href="#Array.view-213"><span class="linenos">213</span></a>
</span><span id="Array.view-214"><a href="#Array.view-214"><span class="linenos">214</span></a>  <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">dtype</span><span class="p">:</span>
</span><span id="Array.view-215"><a href="#Array.view-215"><span class="linenos">215</span></a>    <span class="k">return</span> <span class="n">arr</span>
</span><span id="Array.view-216"><a href="#Array.view-216"><span class="linenos">216</span></a>
</span><span id="Array.view-217"><a href="#Array.view-217"><span class="linenos">217</span></a>  <span class="c1"># lax.bitcast_convert_type does not support bool or complex; in these cases we</span>
</span><span id="Array.view-218"><a href="#Array.view-218"><span class="linenos">218</span></a>  <span class="c1"># cast to a compatible type and recursively call _view for simplicity.</span>
</span><span id="Array.view-219"><a href="#Array.view-219"><span class="linenos">219</span></a>  <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Array.view-220"><a href="#Array.view-220"><span class="linenos">220</span></a>    <span class="k">return</span> <span class="n">_view</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="p">)</span>
</span><span id="Array.view-221"><a href="#Array.view-221"><span class="linenos">221</span></a>
</span><span id="Array.view-222"><a href="#Array.view-222"><span class="linenos">222</span></a>  <span class="k">if</span> <span class="n">lax_numpy</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">complexfloating</span><span class="p">):</span>
</span><span id="Array.view-223"><a href="#Array.view-223"><span class="linenos">223</span></a>    <span class="n">new_shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Array.view-224"><a href="#Array.view-224"><span class="linenos">224</span></a>    <span class="n">new_dtype</span> <span class="o">=</span> <span class="n">lax_numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">dtype</span>
</span><span id="Array.view-225"><a href="#Array.view-225"><span class="linenos">225</span></a>    <span class="n">arr</span> <span class="o">=</span> <span class="p">(</span><span class="n">lax_numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">new_shape</span><span class="p">,</span> <span class="n">new_dtype</span><span class="p">)</span>
</span><span id="Array.view-226"><a href="#Array.view-226"><span class="linenos">226</span></a>             <span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
</span><span id="Array.view-227"><a href="#Array.view-227"><span class="linenos">227</span></a>             <span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">imag</span><span class="p">))</span>
</span><span id="Array.view-228"><a href="#Array.view-228"><span class="linenos">228</span></a>    <span class="k">return</span> <span class="n">_view</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
</span><span id="Array.view-229"><a href="#Array.view-229"><span class="linenos">229</span></a>
</span><span id="Array.view-230"><a href="#Array.view-230"><span class="linenos">230</span></a>  <span class="k">if</span> <span class="n">dtype</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="Array.view-231"><a href="#Array.view-231"><span class="linenos">231</span></a>    <span class="k">return</span> <span class="n">_view</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="Array.view-232"><a href="#Array.view-232"><span class="linenos">232</span></a>
</span><span id="Array.view-233"><a href="#Array.view-233"><span class="linenos">233</span></a>  <span class="k">if</span> <span class="n">lax_numpy</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">complexfloating</span><span class="p">):</span>
</span><span id="Array.view-234"><a href="#Array.view-234"><span class="linenos">234</span></a>    <span class="n">out</span> <span class="o">=</span> <span class="n">_view</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">lax_numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="Array.view-235"><a href="#Array.view-235"><span class="linenos">235</span></a>    <span class="k">return</span> <span class="n">out</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">out</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Array.view-236"><a href="#Array.view-236"><span class="linenos">236</span></a>
</span><span id="Array.view-237"><a href="#Array.view-237"><span class="linenos">237</span></a>  <span class="c1"># lax.bitcast_convert_type adds or subtracts dimensions depending on the</span>
</span><span id="Array.view-238"><a href="#Array.view-238"><span class="linenos">238</span></a>  <span class="c1"># relative bitwidths of the dtypes; we account for that with reshapes.</span>
</span><span id="Array.view-239"><a href="#Array.view-239"><span class="linenos">239</span></a>  <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span> <span class="o">&lt;</span> <span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span><span class="p">:</span>
</span><span id="Array.view-240"><a href="#Array.view-240"><span class="linenos">240</span></a>    <span class="n">factor</span> <span class="o">=</span> <span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span> <span class="o">//</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span>
</span><span id="Array.view-241"><a href="#Array.view-241"><span class="linenos">241</span></a>    <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">//</span> <span class="n">factor</span><span class="p">,</span> <span class="n">factor</span><span class="p">)</span>
</span><span id="Array.view-242"><a href="#Array.view-242"><span class="linenos">242</span></a>    <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">bitcast_convert_type</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
</span><span id="Array.view-243"><a href="#Array.view-243"><span class="linenos">243</span></a>
</span><span id="Array.view-244"><a href="#Array.view-244"><span class="linenos">244</span></a>  <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span> <span class="o">&gt;</span> <span class="n">dtype</span><span class="o">.</span><span class="n">itemsize</span><span class="p">:</span>
</span><span id="Array.view-245"><a href="#Array.view-245"><span class="linenos">245</span></a>    <span class="n">out</span> <span class="o">=</span> <span class="n">lax</span><span class="o">.</span><span class="n">bitcast_convert_type</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
</span><span id="Array.view-246"><a href="#Array.view-246"><span class="linenos">246</span></a>    <span class="k">return</span> <span class="n">out</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">*</span><span class="n">out</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">out</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">out</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Array.view-247"><a href="#Array.view-247"><span class="linenos">247</span></a>
</span><span id="Array.view-248"><a href="#Array.view-248"><span class="linenos">248</span></a>  <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">bitcast_convert_type</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a bitwise copy of the array, viewed as a new dtype.</p>

<p>This is fuller-featured wrapper around <code>jax.lax.bitcast_convert_type()</code>.</p>

<p>If the source and target dtype have the same bitwidth, the result has the same
shape as the input array. If the bitwidth of the target dtype is different
from the source, the size of the last axis of the result is adjusted
accordingly.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 2, 6)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1, 2, 2)</span>
</code></pre>
</div>

<p>Conversions involving booleans are not well-defined in all situations. With
regards to the shape of result as explained above, booleans are treated as
having a bitwidth of 8. However, when converting to a boolean array, the input
should only contain 0 or 1 bytes. Otherwise, results may be unpredictable or
may change depending on how the result is used.</p>

<p>This conversion is guaranteed and safe:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
<span class="go">Array([ True, False,  True], dtype=bool)</span>
</code></pre>
</div>

<p>However, there are no guarantees about the results of any expression involving
a view such as this: <code>jnp.array([1, 2, 3], dtype=jnp.int8).view(jnp.bool_)</code>.
In particular, the results may change between JAX releases and depending on
the platform. To safely convert such an array to a boolean array, compare it
with <code>0</code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span>
<span class="go">Array([ True,  True, False], dtype=bool)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Array.flat" class="classattr">
                                        <input id="Array.flat-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">flat</span>

                <label class="view-source-button" for="Array.flat-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.flat"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.flat-251"><a href="#Array.flat-251"><span class="linenos">251</span></a><span class="k">def</span> <span class="nf">_notimplemented_flat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Array.flat-252"><a href="#Array.flat-252"><span class="linenos">252</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Not implemented: Use :meth:`~jax.Array.flatten` instead.&quot;&quot;&quot;</span>
</span><span id="Array.flat-253"><a href="#Array.flat-253"><span class="linenos">253</span></a>  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;JAX Arrays do not implement the arr.flat property: &quot;</span>
</span><span id="Array.flat-254"><a href="#Array.flat-254"><span class="linenos">254</span></a>                            <span class="s2">&quot;consider arr.flatten() instead.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Not implemented: Use <code>~<a href="#Array.flatten">Array.flatten()</a></code> instead.</p>
</div>


                            </div>
                            <div id="Array.T" class="classattr">
                                        <input id="Array.T-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">T</span><span class="annotation">: <a href="#Array">Array</a></span>

                <label class="view-source-button" for="Array.T-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.T"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.T-556"><a href="#Array.T-556"><span class="linenos">556</span></a><span class="k">def</span> <span class="nf">transpose</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">axes</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.T-557"><a href="#Array.T-557"><span class="linenos">557</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Return a transposed version of an N-dimensional array.</span>
</span><span id="Array.T-558"><a href="#Array.T-558"><span class="linenos">558</span></a>
</span><span id="Array.T-559"><a href="#Array.T-559"><span class="linenos">559</span></a><span class="sd">  JAX implementation of :func:`jax.numpy.transpose`, implemented in terms of</span>
</span><span id="Array.T-560"><a href="#Array.T-560"><span class="linenos">560</span></a><span class="sd">  :func:`jax.lax.transpose`.</span>
</span><span id="Array.T-561"><a href="#Array.T-561"><span class="linenos">561</span></a>
</span><span id="Array.T-562"><a href="#Array.T-562"><span class="linenos">562</span></a><span class="sd">  Args:</span>
</span><span id="Array.T-563"><a href="#Array.T-563"><span class="linenos">563</span></a><span class="sd">    a: input array</span>
</span><span id="Array.T-564"><a href="#Array.T-564"><span class="linenos">564</span></a><span class="sd">    axes: optionally specify the permutation using a length-`a.ndim` sequence of integers</span>
</span><span id="Array.T-565"><a href="#Array.T-565"><span class="linenos">565</span></a><span class="sd">      ``i`` satisfying ``0 &lt;= i &lt; a.ndim``. Defaults to ``range(a.ndim)[::-1]``, i.e</span>
</span><span id="Array.T-566"><a href="#Array.T-566"><span class="linenos">566</span></a><span class="sd">      reverses the order of all axes.</span>
</span><span id="Array.T-567"><a href="#Array.T-567"><span class="linenos">567</span></a>
</span><span id="Array.T-568"><a href="#Array.T-568"><span class="linenos">568</span></a><span class="sd">  Returns:</span>
</span><span id="Array.T-569"><a href="#Array.T-569"><span class="linenos">569</span></a><span class="sd">    transposed copy of the array.</span>
</span><span id="Array.T-570"><a href="#Array.T-570"><span class="linenos">570</span></a>
</span><span id="Array.T-571"><a href="#Array.T-571"><span class="linenos">571</span></a><span class="sd">  See Also:</span>
</span><span id="Array.T-572"><a href="#Array.T-572"><span class="linenos">572</span></a><span class="sd">    - :func:`jax.Array.transpose`: equivalent function via an :class:`~jax.Array` method.</span>
</span><span id="Array.T-573"><a href="#Array.T-573"><span class="linenos">573</span></a><span class="sd">    - :attr:`jax.Array.T`: equivalent function via an :class:`~jax.Array`  property.</span>
</span><span id="Array.T-574"><a href="#Array.T-574"><span class="linenos">574</span></a><span class="sd">    - :func:`jax.numpy.matrix_transpose`: transpose the last two axes of an array. This is</span>
</span><span id="Array.T-575"><a href="#Array.T-575"><span class="linenos">575</span></a><span class="sd">      suitable for working with batched 2D matrices.</span>
</span><span id="Array.T-576"><a href="#Array.T-576"><span class="linenos">576</span></a><span class="sd">    - :func:`jax.numpy.swapaxes`: swap any two axes in an array.</span>
</span><span id="Array.T-577"><a href="#Array.T-577"><span class="linenos">577</span></a><span class="sd">    - :func:`jax.numpy.moveaxis`: move an axis to another postion in the array.</span>
</span><span id="Array.T-578"><a href="#Array.T-578"><span class="linenos">578</span></a>
</span><span id="Array.T-579"><a href="#Array.T-579"><span class="linenos">579</span></a><span class="sd">  Note:</span>
</span><span id="Array.T-580"><a href="#Array.T-580"><span class="linenos">580</span></a><span class="sd">    Unlike :func:`numpy.transpose`, :func:`jax.numpy.transpose` will return a copy rather</span>
</span><span id="Array.T-581"><a href="#Array.T-581"><span class="linenos">581</span></a><span class="sd">    than a view of the input array. However, under JIT, the compiler will optimize-away</span>
</span><span id="Array.T-582"><a href="#Array.T-582"><span class="linenos">582</span></a><span class="sd">    such copies when possible, so this doesn&#39;t have performance impacts in practice.</span>
</span><span id="Array.T-583"><a href="#Array.T-583"><span class="linenos">583</span></a>
</span><span id="Array.T-584"><a href="#Array.T-584"><span class="linenos">584</span></a><span class="sd">  Examples:</span>
</span><span id="Array.T-585"><a href="#Array.T-585"><span class="linenos">585</span></a><span class="sd">    For a 1D array, the transpose is the identity:</span>
</span><span id="Array.T-586"><a href="#Array.T-586"><span class="linenos">586</span></a>
</span><span id="Array.T-587"><a href="#Array.T-587"><span class="linenos">587</span></a><span class="sd">    &gt;&gt;&gt; x = jnp.array([1, 2, 3, 4])</span>
</span><span id="Array.T-588"><a href="#Array.T-588"><span class="linenos">588</span></a><span class="sd">    &gt;&gt;&gt; jnp.transpose(x)</span>
</span><span id="Array.T-589"><a href="#Array.T-589"><span class="linenos">589</span></a><span class="sd">    Array([1, 2, 3, 4], dtype=int32)</span>
</span><span id="Array.T-590"><a href="#Array.T-590"><span class="linenos">590</span></a>
</span><span id="Array.T-591"><a href="#Array.T-591"><span class="linenos">591</span></a><span class="sd">    For a 2D array, the transpose is a matrix transpose:</span>
</span><span id="Array.T-592"><a href="#Array.T-592"><span class="linenos">592</span></a>
</span><span id="Array.T-593"><a href="#Array.T-593"><span class="linenos">593</span></a><span class="sd">    &gt;&gt;&gt; x = jnp.array([[1, 2],</span>
</span><span id="Array.T-594"><a href="#Array.T-594"><span class="linenos">594</span></a><span class="sd">    ...                [3, 4]])</span>
</span><span id="Array.T-595"><a href="#Array.T-595"><span class="linenos">595</span></a><span class="sd">    &gt;&gt;&gt; jnp.transpose(x)</span>
</span><span id="Array.T-596"><a href="#Array.T-596"><span class="linenos">596</span></a><span class="sd">    Array([[1, 3],</span>
</span><span id="Array.T-597"><a href="#Array.T-597"><span class="linenos">597</span></a><span class="sd">           [2, 4]], dtype=int32)</span>
</span><span id="Array.T-598"><a href="#Array.T-598"><span class="linenos">598</span></a>
</span><span id="Array.T-599"><a href="#Array.T-599"><span class="linenos">599</span></a><span class="sd">    For an N-dimensional array, the transpose reverses the order of the axes:</span>
</span><span id="Array.T-600"><a href="#Array.T-600"><span class="linenos">600</span></a>
</span><span id="Array.T-601"><a href="#Array.T-601"><span class="linenos">601</span></a><span class="sd">    &gt;&gt;&gt; x = jnp.zeros(shape=(3, 4, 5))</span>
</span><span id="Array.T-602"><a href="#Array.T-602"><span class="linenos">602</span></a><span class="sd">    &gt;&gt;&gt; jnp.transpose(x).shape</span>
</span><span id="Array.T-603"><a href="#Array.T-603"><span class="linenos">603</span></a><span class="sd">    (5, 4, 3)</span>
</span><span id="Array.T-604"><a href="#Array.T-604"><span class="linenos">604</span></a>
</span><span id="Array.T-605"><a href="#Array.T-605"><span class="linenos">605</span></a><span class="sd">    The ``axes`` argument can be specified to change this default behavior:</span>
</span><span id="Array.T-606"><a href="#Array.T-606"><span class="linenos">606</span></a>
</span><span id="Array.T-607"><a href="#Array.T-607"><span class="linenos">607</span></a><span class="sd">    &gt;&gt;&gt; jnp.transpose(x, (0, 2, 1)).shape</span>
</span><span id="Array.T-608"><a href="#Array.T-608"><span class="linenos">608</span></a><span class="sd">    (3, 5, 4)</span>
</span><span id="Array.T-609"><a href="#Array.T-609"><span class="linenos">609</span></a>
</span><span id="Array.T-610"><a href="#Array.T-610"><span class="linenos">610</span></a><span class="sd">    Since swapping the last two axes is a common operation, it can be done</span>
</span><span id="Array.T-611"><a href="#Array.T-611"><span class="linenos">611</span></a><span class="sd">    via its own API, :func:`jax.numpy.matrix_transpose`:</span>
</span><span id="Array.T-612"><a href="#Array.T-612"><span class="linenos">612</span></a>
</span><span id="Array.T-613"><a href="#Array.T-613"><span class="linenos">613</span></a><span class="sd">    &gt;&gt;&gt; jnp.matrix_transpose(x).shape</span>
</span><span id="Array.T-614"><a href="#Array.T-614"><span class="linenos">614</span></a><span class="sd">    (3, 5, 4)</span>
</span><span id="Array.T-615"><a href="#Array.T-615"><span class="linenos">615</span></a>
</span><span id="Array.T-616"><a href="#Array.T-616"><span class="linenos">616</span></a><span class="sd">    For convenience, transposes may also be performed using the :meth:`jax.Array.transpose`</span>
</span><span id="Array.T-617"><a href="#Array.T-617"><span class="linenos">617</span></a><span class="sd">    method or the :attr:`jax.Array.T` property:</span>
</span><span id="Array.T-618"><a href="#Array.T-618"><span class="linenos">618</span></a>
</span><span id="Array.T-619"><a href="#Array.T-619"><span class="linenos">619</span></a><span class="sd">    &gt;&gt;&gt; x = jnp.array([[1, 2],</span>
</span><span id="Array.T-620"><a href="#Array.T-620"><span class="linenos">620</span></a><span class="sd">    ...                [3, 4]])</span>
</span><span id="Array.T-621"><a href="#Array.T-621"><span class="linenos">621</span></a><span class="sd">    &gt;&gt;&gt; x.transpose()</span>
</span><span id="Array.T-622"><a href="#Array.T-622"><span class="linenos">622</span></a><span class="sd">    Array([[1, 3],</span>
</span><span id="Array.T-623"><a href="#Array.T-623"><span class="linenos">623</span></a><span class="sd">           [2, 4]], dtype=int32)</span>
</span><span id="Array.T-624"><a href="#Array.T-624"><span class="linenos">624</span></a><span class="sd">    &gt;&gt;&gt; x.T</span>
</span><span id="Array.T-625"><a href="#Array.T-625"><span class="linenos">625</span></a><span class="sd">    Array([[1, 3],</span>
</span><span id="Array.T-626"><a href="#Array.T-626"><span class="linenos">626</span></a><span class="sd">           [2, 4]], dtype=int32)</span>
</span><span id="Array.T-627"><a href="#Array.T-627"><span class="linenos">627</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="Array.T-628"><a href="#Array.T-628"><span class="linenos">628</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;transpose&quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Array.T-629"><a href="#Array.T-629"><span class="linenos">629</span></a>  <span class="n">axes_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">(</span><span class="n">a</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">axes</span>
</span><span id="Array.T-630"><a href="#Array.T-630"><span class="linenos">630</span></a>  <span class="n">axes_</span> <span class="o">=</span> <span class="p">[</span><span class="n">_canonicalize_axis</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ndim</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">axes_</span><span class="p">]</span>
</span><span id="Array.T-631"><a href="#Array.T-631"><span class="linenos">631</span></a>  <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axes_</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a transposed version of an N-dimensional array.</p>

<p>JAX implementation of <code>jax.numpy.transpose()</code>, implemented in terms of
<code>jax.lax.transpose()</code>.</p>

<p>Args:
  a: input array
  axes: optionally specify the permutation using a length-<code>a.ndim</code> sequence of integers
    <code>i</code> satisfying <code>0 &lt;= i &lt; a.ndim</code>. Defaults to <code>range(a.ndim)[::-1]</code>, i.e
    reverses the order of all axes.</p>

<p>Returns:
  transposed copy of the array.</p>

<p>See Also:</p>

<ul>
<li><code><a href="#Array.transpose">Array.transpose()</a></code>: equivalent function via an <code>~<a href="#Array">Array</a></code> method.</li>
<li><code><a href="#Array.T">Array.T</a></code>: equivalent function via an <code>~<a href="#Array">Array</a></code>  property.</li>
<li><code>jax.numpy.matrix_transpose()</code>: transpose the last two axes of an array. This is
suitable for working with batched 2D matrices.</li>
<li><code>jax.numpy.swapaxes()</code>: swap any two axes in an array.</li>
<li><code>jax.numpy.moveaxis()</code>: move an axis to another postion in the array.</li>
</ul>

<p>Note:
  Unlike <code>numpy.transpose()</code>, <code>jax.numpy.transpose()</code> will return a copy rather
  than a view of the input array. However, under JIT, the compiler will optimize-away
  such copies when possible, so this doesn't have performance impacts in practice.</p>

<p>Examples:
  For a 1D array, the transpose is the identity:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">Array([1, 2, 3, 4], dtype=int32)</span>
</code></pre>
</div>

<p>For a 2D array, the transpose is a matrix transpose:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">Array([[1, 3],</span>
<span class="go">       [2, 4]], dtype=int32)</span>
</code></pre>
</div>

<p>For an N-dimensional array, the transpose reverses the order of the axes:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(5, 4, 3)</span>
</code></pre>
</div>

<p>The <code>axes</code> argument can be specified to change this default behavior:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 5, 4)</span>
</code></pre>
</div>

<p>Since swapping the last two axes is a common operation, it can be done
  via its own API, <code>jax.numpy.matrix_transpose()</code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">matrix_transpose</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(3, 5, 4)</span>
</code></pre>
</div>

<p>For convenience, transposes may also be performed using the <code><a href="#Array.transpose">Array.transpose()</a></code>
  method or the <code><a href="#Array.T">Array.T</a></code> property:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">Array([[1, 3],</span>
<span class="go">       [2, 4]], dtype=int32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">T</span>
<span class="go">Array([[1, 3],</span>
<span class="go">       [2, 4]], dtype=int32)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Array.mT" class="classattr">
                                        <input id="Array.mT-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">mT</span><span class="annotation">: <a href="#Array">Array</a></span>

                <label class="view-source-button" for="Array.mT-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.mT"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.mT-640"><a href="#Array.mT-640"><span class="linenos">640</span></a><span class="k">def</span> <span class="nf">matrix_transpose</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.mT-641"><a href="#Array.mT-641"><span class="linenos">641</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Transpose the last two dimensions of an array.</span>
</span><span id="Array.mT-642"><a href="#Array.mT-642"><span class="linenos">642</span></a>
</span><span id="Array.mT-643"><a href="#Array.mT-643"><span class="linenos">643</span></a><span class="sd">  JAX implementation of :func:`jax.numpy.matrix_transpose`, implemented in terms of</span>
</span><span id="Array.mT-644"><a href="#Array.mT-644"><span class="linenos">644</span></a><span class="sd">  :func:`jax.lax.transpose`.</span>
</span><span id="Array.mT-645"><a href="#Array.mT-645"><span class="linenos">645</span></a>
</span><span id="Array.mT-646"><a href="#Array.mT-646"><span class="linenos">646</span></a><span class="sd">  Args:</span>
</span><span id="Array.mT-647"><a href="#Array.mT-647"><span class="linenos">647</span></a><span class="sd">    x: input array, Must have ``x.ndim &gt;= 2``</span>
</span><span id="Array.mT-648"><a href="#Array.mT-648"><span class="linenos">648</span></a>
</span><span id="Array.mT-649"><a href="#Array.mT-649"><span class="linenos">649</span></a><span class="sd">  Returns:</span>
</span><span id="Array.mT-650"><a href="#Array.mT-650"><span class="linenos">650</span></a><span class="sd">    matrix-transposed copy of the array.</span>
</span><span id="Array.mT-651"><a href="#Array.mT-651"><span class="linenos">651</span></a>
</span><span id="Array.mT-652"><a href="#Array.mT-652"><span class="linenos">652</span></a><span class="sd">  See Also:</span>
</span><span id="Array.mT-653"><a href="#Array.mT-653"><span class="linenos">653</span></a><span class="sd">    - :attr:`jax.Array.mT`: same operation accessed via an :func:`~jax.Array` property.</span>
</span><span id="Array.mT-654"><a href="#Array.mT-654"><span class="linenos">654</span></a><span class="sd">    - :func:`jax.numpy.transpose`: general multi-axis transpose</span>
</span><span id="Array.mT-655"><a href="#Array.mT-655"><span class="linenos">655</span></a>
</span><span id="Array.mT-656"><a href="#Array.mT-656"><span class="linenos">656</span></a><span class="sd">  Note:</span>
</span><span id="Array.mT-657"><a href="#Array.mT-657"><span class="linenos">657</span></a><span class="sd">    Unlike :func:`numpy.matrix_transpose`, :func:`jax.numpy.matrix_transpose` will return a</span>
</span><span id="Array.mT-658"><a href="#Array.mT-658"><span class="linenos">658</span></a><span class="sd">    copy rather than a view of the input array. However, under JIT, the compiler will</span>
</span><span id="Array.mT-659"><a href="#Array.mT-659"><span class="linenos">659</span></a><span class="sd">    optimize-away such copies when possible, so this doesn&#39;t have performance impacts in practice.</span>
</span><span id="Array.mT-660"><a href="#Array.mT-660"><span class="linenos">660</span></a>
</span><span id="Array.mT-661"><a href="#Array.mT-661"><span class="linenos">661</span></a><span class="sd">  Examples:</span>
</span><span id="Array.mT-662"><a href="#Array.mT-662"><span class="linenos">662</span></a><span class="sd">    Here is a 2x2x2 matrix representing a batched 2x2 matrix:</span>
</span><span id="Array.mT-663"><a href="#Array.mT-663"><span class="linenos">663</span></a>
</span><span id="Array.mT-664"><a href="#Array.mT-664"><span class="linenos">664</span></a><span class="sd">    &gt;&gt;&gt; x = jnp.array([[[1, 2],</span>
</span><span id="Array.mT-665"><a href="#Array.mT-665"><span class="linenos">665</span></a><span class="sd">    ...                 [3, 4]],</span>
</span><span id="Array.mT-666"><a href="#Array.mT-666"><span class="linenos">666</span></a><span class="sd">    ...                [[5, 6],</span>
</span><span id="Array.mT-667"><a href="#Array.mT-667"><span class="linenos">667</span></a><span class="sd">    ...                 [7, 8]]])</span>
</span><span id="Array.mT-668"><a href="#Array.mT-668"><span class="linenos">668</span></a><span class="sd">    &gt;&gt;&gt; jnp.matrix_transpose(x)</span>
</span><span id="Array.mT-669"><a href="#Array.mT-669"><span class="linenos">669</span></a><span class="sd">    Array([[[1, 3],</span>
</span><span id="Array.mT-670"><a href="#Array.mT-670"><span class="linenos">670</span></a><span class="sd">            [2, 4]],</span>
</span><span id="Array.mT-671"><a href="#Array.mT-671"><span class="linenos">671</span></a><span class="sd">    &lt;BLANKLINE&gt;</span>
</span><span id="Array.mT-672"><a href="#Array.mT-672"><span class="linenos">672</span></a><span class="sd">           [[5, 7],</span>
</span><span id="Array.mT-673"><a href="#Array.mT-673"><span class="linenos">673</span></a><span class="sd">            [6, 8]]], dtype=int32)</span>
</span><span id="Array.mT-674"><a href="#Array.mT-674"><span class="linenos">674</span></a>
</span><span id="Array.mT-675"><a href="#Array.mT-675"><span class="linenos">675</span></a><span class="sd">    For convenience, you can perform the same transpose via the :attr:`~jax.Array.mT`</span>
</span><span id="Array.mT-676"><a href="#Array.mT-676"><span class="linenos">676</span></a><span class="sd">    property of :class:`jax.Array`:</span>
</span><span id="Array.mT-677"><a href="#Array.mT-677"><span class="linenos">677</span></a>
</span><span id="Array.mT-678"><a href="#Array.mT-678"><span class="linenos">678</span></a><span class="sd">    &gt;&gt;&gt; x.mT</span>
</span><span id="Array.mT-679"><a href="#Array.mT-679"><span class="linenos">679</span></a><span class="sd">    Array([[[1, 3],</span>
</span><span id="Array.mT-680"><a href="#Array.mT-680"><span class="linenos">680</span></a><span class="sd">            [2, 4]],</span>
</span><span id="Array.mT-681"><a href="#Array.mT-681"><span class="linenos">681</span></a><span class="sd">    &lt;BLANKLINE&gt;</span>
</span><span id="Array.mT-682"><a href="#Array.mT-682"><span class="linenos">682</span></a><span class="sd">           [[5, 7],</span>
</span><span id="Array.mT-683"><a href="#Array.mT-683"><span class="linenos">683</span></a><span class="sd">            [6, 8]]], dtype=int32)</span>
</span><span id="Array.mT-684"><a href="#Array.mT-684"><span class="linenos">684</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="Array.mT-685"><a href="#Array.mT-685"><span class="linenos">685</span></a>  <span class="n">util</span><span class="o">.</span><span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;matrix_transpose&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Array.mT-686"><a href="#Array.mT-686"><span class="linenos">686</span></a>  <span class="n">ndim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Array.mT-687"><a href="#Array.mT-687"><span class="linenos">687</span></a>  <span class="k">if</span> <span class="n">ndim</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Array.mT-688"><a href="#Array.mT-688"><span class="linenos">688</span></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x must be at least two-dimensional for matrix_transpose; got </span><span class="si">{</span><span class="n">ndim</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Array.mT-689"><a href="#Array.mT-689"><span class="linenos">689</span></a>  <span class="n">axes</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span><span class="p">),</span> <span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Array.mT-690"><a href="#Array.mT-690"><span class="linenos">690</span></a>  <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Transpose the last two dimensions of an array.</p>

<p>JAX implementation of <code>jax.numpy.matrix_transpose()</code>, implemented in terms of
<code>jax.lax.transpose()</code>.</p>

<p>Args:
  x: input array, Must have <code>x.ndim &gt;= 2</code></p>

<p>Returns:
  matrix-transposed copy of the array.</p>

<p>See Also:</p>

<ul>
<li><code><a href="#Array.mT">Array.mT</a></code>: same operation accessed via an <code>~<a href="#Array">Array()</a></code> property.</li>
<li><code>jax.numpy.transpose()</code>: general multi-axis transpose</li>
</ul>

<p>Note:
  Unlike <code>numpy.matrix_transpose()</code>, <code>jax.numpy.matrix_transpose()</code> will return a
  copy rather than a view of the input array. However, under JIT, the compiler will
  optimize-away such copies when possible, so this doesn't have performance impacts in practice.</p>

<p>Examples:
  Here is a 2x2x2 matrix representing a batched 2x2 matrix:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span>
<span class="gp">... </span>               <span class="p">[[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jnp</span><span class="o">.</span><span class="n">matrix_transpose</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">Array([[[1, 3],</span>
<span class="go">        [2, 4]],</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">       [[5, 7],</span>
<span class="go">        [6, 8]]], dtype=int32)</span>
</code></pre>
</div>

<p>For convenience, you can perform the same transpose via the <code>~<a href="#Array.mT">Array.mT</a></code>
  property of <code><a href="#Array">Array</a></code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">mT</span>
<span class="go">Array([[[1, 3],</span>
<span class="go">        [2, 4]],</span>
<span class="go">&lt;BLANKLINE&gt;</span>
<span class="go">       [[5, 7],</span>
<span class="go">        [6, 8]]], dtype=int32)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="Array.real" class="classattr">
                                        <input id="Array.real-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">real</span><span class="annotation">: <a href="#Array">Array</a></span>

                <label class="view-source-button" for="Array.real-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.real"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.real-650"><a href="#Array.real-650"><span class="linenos">650</span></a><span class="nd">@implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
</span><span id="Array.real-651"><a href="#Array.real-651"><span class="linenos">651</span></a><span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Array.real-652"><a href="#Array.real-652"><span class="linenos">652</span></a><span class="k">def</span> <span class="nf">real</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.real-653"><a href="#Array.real-653"><span class="linenos">653</span></a>  <span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;real&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
</span><span id="Array.real-654"><a href="#Array.real-654"><span class="linenos">654</span></a>  <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">else</span> <span class="n">lax</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the real part of the complex argument.</p>

<p>LAX-backend implementation of <code>numpy.real()</code>.</p>

<p><em>Original docstring below.</em></p>

<h2 id="parameters">Parameters</h2>

<p>val : array_like
    Input array.</p>

<h2 id="returns">Returns</h2>

<p>out : ndarray or scalar
    The real component of the complex argument. If <code>val</code> is real, the type
    of <code>val</code> is used for the output.  If <code>val</code> has complex elements, the
    returned type is float.</p>
</div>


                            </div>
                            <div id="Array.imag" class="classattr">
                                        <input id="Array.imag-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">imag</span><span class="annotation">: <a href="#Array">Array</a></span>

                <label class="view-source-button" for="Array.imag-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.imag"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.imag-643"><a href="#Array.imag-643"><span class="linenos">643</span></a><span class="nd">@implements</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
</span><span id="Array.imag-644"><a href="#Array.imag-644"><span class="linenos">644</span></a><span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Array.imag-645"><a href="#Array.imag-645"><span class="linenos">645</span></a><span class="k">def</span> <span class="nf">imag</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Array.imag-646"><a href="#Array.imag-646"><span class="linenos">646</span></a>  <span class="n">check_arraylike</span><span class="p">(</span><span class="s2">&quot;imag&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
</span><span id="Array.imag-647"><a href="#Array.imag-647"><span class="linenos">647</span></a>  <span class="k">return</span> <span class="n">lax</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">else</span> <span class="n">lax</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the imaginary part of the complex argument.</p>

<p>LAX-backend implementation of <code>numpy.imag()</code>.</p>

<p><em>Original docstring below.</em></p>

<h2 id="parameters">Parameters</h2>

<p>val : array_like
    Input array.</p>

<h2 id="returns">Returns</h2>

<p>out : ndarray or scalar
    The imaginary component of the complex argument. If <code>val</code> is real,
    the type of <code>val</code> is used for the output.  If <code>val</code> has complex
    elements, the returned type is float.</p>
</div>


                            </div>
                            <div id="Array.nbytes" class="classattr">
                                        <input id="Array.nbytes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">nbytes</span><span class="annotation">: int</span>

                <label class="view-source-button" for="Array.nbytes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.nbytes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.nbytes-72"><a href="#Array.nbytes-72"><span class="linenos">72</span></a><span class="k">def</span> <span class="nf">_nbytes</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Array.nbytes-73"><a href="#Array.nbytes-73"><span class="linenos">73</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Total bytes consumed by the elements of the array.&quot;&quot;&quot;</span>
</span><span id="Array.nbytes-74"><a href="#Array.nbytes-74"><span class="linenos">74</span></a>  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="o">*</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">canonicalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">itemsize</span>
</span></pre></div>


            <div class="docstring"><p>Total bytes consumed by the elements of the array.</p>
</div>


                            </div>
                            <div id="Array.itemsize" class="classattr">
                                        <input id="Array.itemsize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">itemsize</span><span class="annotation">: int</span>

                <label class="view-source-button" for="Array.itemsize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.itemsize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.itemsize-84"><a href="#Array.itemsize-84"><span class="linenos">84</span></a><span class="k">def</span> <span class="nf">_itemsize</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="Array.itemsize-85"><a href="#Array.itemsize-85"><span class="linenos">85</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Length of one array element in bytes.&quot;&quot;&quot;</span>
</span><span id="Array.itemsize-86"><a href="#Array.itemsize-86"><span class="linenos">86</span></a>  <span class="k">return</span> <span class="n">dtypes</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">canonicalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">itemsize</span>
</span></pre></div>


            <div class="docstring"><p>Length of one array element in bytes.</p>
</div>


                            </div>
                            <div id="Array.at" class="classattr">
                                        <input id="Array.at-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">at</span>

                <label class="view-source-button" for="Array.at-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Array.at"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Array.at-356"><a href="#Array.at-356"><span class="linenos">356</span></a><span class="k">class</span> <span class="nc">_IndexUpdateHelper</span><span class="p">:</span>
</span><span id="Array.at-357"><a href="#Array.at-357"><span class="linenos">357</span></a>  <span class="c1"># Note: this docstring will appear as the docstring for the `at` property.</span>
</span><span id="Array.at-358"><a href="#Array.at-358"><span class="linenos">358</span></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Helper property for index update functionality.</span>
</span><span id="Array.at-359"><a href="#Array.at-359"><span class="linenos">359</span></a>
</span><span id="Array.at-360"><a href="#Array.at-360"><span class="linenos">360</span></a><span class="sd">  The ``at`` property provides a functionally pure equivalent of in-place</span>
</span><span id="Array.at-361"><a href="#Array.at-361"><span class="linenos">361</span></a><span class="sd">  array modifications.</span>
</span><span id="Array.at-362"><a href="#Array.at-362"><span class="linenos">362</span></a>
</span><span id="Array.at-363"><a href="#Array.at-363"><span class="linenos">363</span></a><span class="sd">  In particular:</span>
</span><span id="Array.at-364"><a href="#Array.at-364"><span class="linenos">364</span></a>
</span><span id="Array.at-365"><a href="#Array.at-365"><span class="linenos">365</span></a><span class="sd">  ==============================  ================================</span>
</span><span id="Array.at-366"><a href="#Array.at-366"><span class="linenos">366</span></a><span class="sd">  Alternate syntax                Equivalent In-place expression</span>
</span><span id="Array.at-367"><a href="#Array.at-367"><span class="linenos">367</span></a><span class="sd">  ==============================  ================================</span>
</span><span id="Array.at-368"><a href="#Array.at-368"><span class="linenos">368</span></a><span class="sd">  ``x = x.at[idx].set(y)``        ``x[idx] = y``</span>
</span><span id="Array.at-369"><a href="#Array.at-369"><span class="linenos">369</span></a><span class="sd">  ``x = x.at[idx].add(y)``        ``x[idx] += y``</span>
</span><span id="Array.at-370"><a href="#Array.at-370"><span class="linenos">370</span></a><span class="sd">  ``x = x.at[idx].multiply(y)``   ``x[idx] *= y``</span>
</span><span id="Array.at-371"><a href="#Array.at-371"><span class="linenos">371</span></a><span class="sd">  ``x = x.at[idx].divide(y)``     ``x[idx] /= y``</span>
</span><span id="Array.at-372"><a href="#Array.at-372"><span class="linenos">372</span></a><span class="sd">  ``x = x.at[idx].power(y)``      ``x[idx] **= y``</span>
</span><span id="Array.at-373"><a href="#Array.at-373"><span class="linenos">373</span></a><span class="sd">  ``x = x.at[idx].min(y)``        ``x[idx] = minimum(x[idx], y)``</span>
</span><span id="Array.at-374"><a href="#Array.at-374"><span class="linenos">374</span></a><span class="sd">  ``x = x.at[idx].max(y)``        ``x[idx] = maximum(x[idx], y)``</span>
</span><span id="Array.at-375"><a href="#Array.at-375"><span class="linenos">375</span></a><span class="sd">  ``x = x.at[idx].apply(ufunc)``  ``ufunc.at(x, idx)``</span>
</span><span id="Array.at-376"><a href="#Array.at-376"><span class="linenos">376</span></a><span class="sd">  ``x = x.at[idx].get()``         ``x = x[idx]``</span>
</span><span id="Array.at-377"><a href="#Array.at-377"><span class="linenos">377</span></a><span class="sd">  ==============================  ================================</span>
</span><span id="Array.at-378"><a href="#Array.at-378"><span class="linenos">378</span></a>
</span><span id="Array.at-379"><a href="#Array.at-379"><span class="linenos">379</span></a><span class="sd">  None of the ``x.at`` expressions modify the original ``x``; instead they return</span>
</span><span id="Array.at-380"><a href="#Array.at-380"><span class="linenos">380</span></a><span class="sd">  a modified copy of ``x``. However, inside a :py:func:`~jax.jit` compiled function,</span>
</span><span id="Array.at-381"><a href="#Array.at-381"><span class="linenos">381</span></a><span class="sd">  expressions like :code:`x = x.at[idx].set(y)` are guaranteed to be applied in-place.</span>
</span><span id="Array.at-382"><a href="#Array.at-382"><span class="linenos">382</span></a>
</span><span id="Array.at-383"><a href="#Array.at-383"><span class="linenos">383</span></a><span class="sd">  Unlike NumPy in-place operations such as :code:`x[idx] += y`, if multiple</span>
</span><span id="Array.at-384"><a href="#Array.at-384"><span class="linenos">384</span></a><span class="sd">  indices refer to the same location, all updates will be applied (NumPy would</span>
</span><span id="Array.at-385"><a href="#Array.at-385"><span class="linenos">385</span></a><span class="sd">  only apply the last update, rather than applying all updates.) The order</span>
</span><span id="Array.at-386"><a href="#Array.at-386"><span class="linenos">386</span></a><span class="sd">  in which conflicting updates are applied is implementation-defined and may be</span>
</span><span id="Array.at-387"><a href="#Array.at-387"><span class="linenos">387</span></a><span class="sd">  nondeterministic (e.g., due to concurrency on some hardware platforms).</span>
</span><span id="Array.at-388"><a href="#Array.at-388"><span class="linenos">388</span></a>
</span><span id="Array.at-389"><a href="#Array.at-389"><span class="linenos">389</span></a><span class="sd">  By default, JAX assumes that all indices are in-bounds. Alternative out-of-bound</span>
</span><span id="Array.at-390"><a href="#Array.at-390"><span class="linenos">390</span></a><span class="sd">  index semantics can be specified via the ``mode`` parameter (see below).</span>
</span><span id="Array.at-391"><a href="#Array.at-391"><span class="linenos">391</span></a>
</span><span id="Array.at-392"><a href="#Array.at-392"><span class="linenos">392</span></a><span class="sd">  Arguments</span>
</span><span id="Array.at-393"><a href="#Array.at-393"><span class="linenos">393</span></a><span class="sd">  ---------</span>
</span><span id="Array.at-394"><a href="#Array.at-394"><span class="linenos">394</span></a><span class="sd">  mode : str</span>
</span><span id="Array.at-395"><a href="#Array.at-395"><span class="linenos">395</span></a><span class="sd">      Specify out-of-bound indexing mode. Options are:</span>
</span><span id="Array.at-396"><a href="#Array.at-396"><span class="linenos">396</span></a>
</span><span id="Array.at-397"><a href="#Array.at-397"><span class="linenos">397</span></a><span class="sd">      - ``&quot;promise_in_bounds&quot;``: (default) The user promises that indices are in bounds.</span>
</span><span id="Array.at-398"><a href="#Array.at-398"><span class="linenos">398</span></a><span class="sd">        No additional checking will be performed. In practice, this means that</span>
</span><span id="Array.at-399"><a href="#Array.at-399"><span class="linenos">399</span></a><span class="sd">        out-of-bounds indices in ``get()`` will be clipped, and out-of-bounds indices</span>
</span><span id="Array.at-400"><a href="#Array.at-400"><span class="linenos">400</span></a><span class="sd">        in ``set()``, ``add()``, etc. will be dropped.</span>
</span><span id="Array.at-401"><a href="#Array.at-401"><span class="linenos">401</span></a><span class="sd">      - ``&quot;clip&quot;``: clamp out of bounds indices into valid range.</span>
</span><span id="Array.at-402"><a href="#Array.at-402"><span class="linenos">402</span></a><span class="sd">      - ``&quot;drop&quot;``: ignore out-of-bound indices.</span>
</span><span id="Array.at-403"><a href="#Array.at-403"><span class="linenos">403</span></a><span class="sd">      - ``&quot;fill&quot;``: alias for ``&quot;drop&quot;``.  For `get()`, the optional ``fill_value``</span>
</span><span id="Array.at-404"><a href="#Array.at-404"><span class="linenos">404</span></a><span class="sd">        argument specifies the value that will be returned.</span>
</span><span id="Array.at-405"><a href="#Array.at-405"><span class="linenos">405</span></a>
</span><span id="Array.at-406"><a href="#Array.at-406"><span class="linenos">406</span></a><span class="sd">        See :class:`jax.lax.GatherScatterMode` for more details.</span>
</span><span id="Array.at-407"><a href="#Array.at-407"><span class="linenos">407</span></a>
</span><span id="Array.at-408"><a href="#Array.at-408"><span class="linenos">408</span></a><span class="sd">  indices_are_sorted : bool</span>
</span><span id="Array.at-409"><a href="#Array.at-409"><span class="linenos">409</span></a><span class="sd">      If True, the implementation will assume that the indices passed to ``at[]``</span>
</span><span id="Array.at-410"><a href="#Array.at-410"><span class="linenos">410</span></a><span class="sd">      are sorted in ascending order, which can lead to more efficient execution</span>
</span><span id="Array.at-411"><a href="#Array.at-411"><span class="linenos">411</span></a><span class="sd">      on some backends.</span>
</span><span id="Array.at-412"><a href="#Array.at-412"><span class="linenos">412</span></a><span class="sd">  unique_indices : bool</span>
</span><span id="Array.at-413"><a href="#Array.at-413"><span class="linenos">413</span></a><span class="sd">      If True, the implementation will assume that the indices passed to ``at[]``</span>
</span><span id="Array.at-414"><a href="#Array.at-414"><span class="linenos">414</span></a><span class="sd">      are unique, which can result in more efficient execution on some backends.</span>
</span><span id="Array.at-415"><a href="#Array.at-415"><span class="linenos">415</span></a><span class="sd">  fill_value : Any</span>
</span><span id="Array.at-416"><a href="#Array.at-416"><span class="linenos">416</span></a><span class="sd">      Only applies to the ``get()`` method: the fill value to return for out-of-bounds</span>
</span><span id="Array.at-417"><a href="#Array.at-417"><span class="linenos">417</span></a><span class="sd">      slices when `mode` is ``&#39;fill&#39;``. Ignored otherwise. Defaults to ``NaN`` for</span>
</span><span id="Array.at-418"><a href="#Array.at-418"><span class="linenos">418</span></a><span class="sd">      inexact types, the largest negative value for signed types, the largest positive</span>
</span><span id="Array.at-419"><a href="#Array.at-419"><span class="linenos">419</span></a><span class="sd">      value for unsigned types, and ``True`` for booleans.</span>
</span><span id="Array.at-420"><a href="#Array.at-420"><span class="linenos">420</span></a>
</span><span id="Array.at-421"><a href="#Array.at-421"><span class="linenos">421</span></a><span class="sd">  Examples</span>
</span><span id="Array.at-422"><a href="#Array.at-422"><span class="linenos">422</span></a><span class="sd">  --------</span>
</span><span id="Array.at-423"><a href="#Array.at-423"><span class="linenos">423</span></a><span class="sd">  &gt;&gt;&gt; x = jnp.arange(5.0)</span>
</span><span id="Array.at-424"><a href="#Array.at-424"><span class="linenos">424</span></a><span class="sd">  &gt;&gt;&gt; x</span>
</span><span id="Array.at-425"><a href="#Array.at-425"><span class="linenos">425</span></a><span class="sd">  Array([0., 1., 2., 3., 4.], dtype=float32)</span>
</span><span id="Array.at-426"><a href="#Array.at-426"><span class="linenos">426</span></a><span class="sd">  &gt;&gt;&gt; x.at[2].add(10)</span>
</span><span id="Array.at-427"><a href="#Array.at-427"><span class="linenos">427</span></a><span class="sd">  Array([ 0.,  1., 12.,  3.,  4.], dtype=float32)</span>
</span><span id="Array.at-428"><a href="#Array.at-428"><span class="linenos">428</span></a><span class="sd">  &gt;&gt;&gt; x.at[10].add(10)  # out-of-bounds indices are ignored</span>
</span><span id="Array.at-429"><a href="#Array.at-429"><span class="linenos">429</span></a><span class="sd">  Array([0., 1., 2., 3., 4.], dtype=float32)</span>
</span><span id="Array.at-430"><a href="#Array.at-430"><span class="linenos">430</span></a><span class="sd">  &gt;&gt;&gt; x.at[20].add(10, mode=&#39;clip&#39;)</span>
</span><span id="Array.at-431"><a href="#Array.at-431"><span class="linenos">431</span></a><span class="sd">  Array([ 0.,  1.,  2.,  3., 14.], dtype=float32)</span>
</span><span id="Array.at-432"><a href="#Array.at-432"><span class="linenos">432</span></a><span class="sd">  &gt;&gt;&gt; x.at[2].get()</span>
</span><span id="Array.at-433"><a href="#Array.at-433"><span class="linenos">433</span></a><span class="sd">  Array(2., dtype=float32)</span>
</span><span id="Array.at-434"><a href="#Array.at-434"><span class="linenos">434</span></a><span class="sd">  &gt;&gt;&gt; x.at[20].get()  # out-of-bounds indices clipped</span>
</span><span id="Array.at-435"><a href="#Array.at-435"><span class="linenos">435</span></a><span class="sd">  Array(4., dtype=float32)</span>
</span><span id="Array.at-436"><a href="#Array.at-436"><span class="linenos">436</span></a><span class="sd">  &gt;&gt;&gt; x.at[20].get(mode=&#39;fill&#39;)  # out-of-bounds indices filled with NaN</span>
</span><span id="Array.at-437"><a href="#Array.at-437"><span class="linenos">437</span></a><span class="sd">  Array(nan, dtype=float32)</span>
</span><span id="Array.at-438"><a href="#Array.at-438"><span class="linenos">438</span></a><span class="sd">  &gt;&gt;&gt; x.at[20].get(mode=&#39;fill&#39;, fill_value=-1)  # custom fill value</span>
</span><span id="Array.at-439"><a href="#Array.at-439"><span class="linenos">439</span></a><span class="sd">  Array(-1., dtype=float32)</span>
</span><span id="Array.at-440"><a href="#Array.at-440"><span class="linenos">440</span></a><span class="sd">  &quot;&quot;&quot;</span>
</span><span id="Array.at-441"><a href="#Array.at-441"><span class="linenos">441</span></a>  <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;array&quot;</span><span class="p">,)</span>
</span><span id="Array.at-442"><a href="#Array.at-442"><span class="linenos">442</span></a>
</span><span id="Array.at-443"><a href="#Array.at-443"><span class="linenos">443</span></a>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
</span><span id="Array.at-444"><a href="#Array.at-444"><span class="linenos">444</span></a>    <span class="bp">self</span><span class="o">.</span><span class="n">array</span> <span class="o">=</span> <span class="n">array</span>
</span><span id="Array.at-445"><a href="#Array.at-445"><span class="linenos">445</span></a>
</span><span id="Array.at-446"><a href="#Array.at-446"><span class="linenos">446</span></a>  <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="Array.at-447"><a href="#Array.at-447"><span class="linenos">447</span></a>    <span class="k">return</span> <span class="n">_IndexUpdateRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="Array.at-448"><a href="#Array.at-448"><span class="linenos">448</span></a>
</span><span id="Array.at-449"><a href="#Array.at-449"><span class="linenos">449</span></a>  <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Array.at-450"><a href="#Array.at-450"><span class="linenos">450</span></a>    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;_IndexUpdateHelper(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">array</span><span class="si">!r}</span><span class="s2">)&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Helper property for index update functionality.</p>

<p>The <code><a href="#Array.at">at</a></code> property provides a functionally pure equivalent of in-place
array modifications.</p>

<p>In particular:</p>

<p>==============================  ================================
Alternate syntax                Equivalent In-place expression
==============================  ================================
<code>x = x.at[idx].set(y)</code>        <code>x[idx] = y</code>
<code>x = x.at[idx].add(y)</code>        <code>x[idx] += y</code>
<code>x = x.at[idx].multiply(y)</code>   <code>x[idx] *= y</code>
<code>x = x.at[idx].divide(y)</code>     <code>x[idx] /= y</code>
<code>x = x.at[idx].power(y)</code>      <code>x[idx] **= y</code>
<code>x = x.at[idx].min(y)</code>        <code>x[idx] = minimum(x[idx], y)</code>
<code>x = x.at[idx].max(y)</code>        <code>x[idx] = maximum(x[idx], y)</code>
<code>x = x.at[idx].apply(ufunc)</code>  <code>ufunc.at(x, idx)</code>
<code>x = x.at[idx].get()</code>         <code>x = x[idx]</code>
==============================  ================================</p>

<p>None of the <code>x.at</code> expressions modify the original <code>x</code>; instead they return
a modified copy of <code>x</code>. However, inside a <code>~jax.jit()</code> compiled function,
expressions like :code:<code>x = x.at[idx].set(y)</code> are guaranteed to be applied in-place.</p>

<p>Unlike NumPy in-place operations such as :code:<code>x[idx] += y</code>, if multiple
indices refer to the same location, all updates will be applied (NumPy would
only apply the last update, rather than applying all updates.) The order
in which conflicting updates are applied is implementation-defined and may be
nondeterministic (e.g., due to concurrency on some hardware platforms).</p>

<p>By default, JAX assumes that all indices are in-bounds. Alternative out-of-bound
index semantics can be specified via the <code>mode</code> parameter (see below).</p>

<h2 id="arguments">Arguments</h2>

<p>mode : str
    Specify out-of-bound indexing mode. Options are:</p>

<pre><code>- ``"promise_in_bounds"``: (default) The user promises that indices are in bounds.
  No additional checking will be performed. In practice, this means that
  out-of-bounds indices in ``get()`` will be clipped, and out-of-bounds indices
  in ``set()``, ``add()``, etc. will be dropped.
- ``"clip"``: clamp out of bounds indices into valid range.
- ``"drop"``: ignore out-of-bound indices.
- ``"fill"``: alias for ``"drop"``.  For `get()`, the optional ``fill_value``
  argument specifies the value that will be returned.

  See `jax.lax.GatherScatterMode` for more details.
</code></pre>

<p>indices_are_sorted : bool
    If True, the implementation will assume that the indices passed to <code>at[]</code>
    are sorted in ascending order, which can lead to more efficient execution
    on some backends.
unique_indices : bool
    If True, the implementation will assume that the indices passed to <code>at[]</code>
    are unique, which can result in more efficient execution on some backends.
fill_value : Any
    Only applies to the <code>get()</code> method: the fill value to return for out-of-bounds
    slices when <code>mode</code> is <code>'fill'</code>. Ignored otherwise. Defaults to <code>NaN</code> for
    inexact types, the largest negative value for signed types, the largest positive
    value for unsigned types, and <code>True</code> for booleans.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">Array([0., 1., 2., 3., 4.], dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">Array([ 0.,  1., 12.,  3.,  4.], dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># out-of-bounds indices are ignored</span>
<span class="go">Array([0., 1., 2., 3., 4.], dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;clip&#39;</span><span class="p">)</span>
<span class="go">Array([ 0.,  1.,  2.,  3., 14.], dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="go">Array(2., dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>  <span class="c1"># out-of-bounds indices clipped</span>
<span class="go">Array(4., dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;fill&#39;</span><span class="p">)</span>  <span class="c1"># out-of-bounds indices filled with NaN</span>
<span class="go">Array(nan, dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># custom fill value</span>
<span class="go">Array(-1., dtype=float32)</span>
</code></pre>
</div>
</div>


                            </div>
                </section>
                <section id="Float">
                    <div class="attr variable">
            <span class="name">Float</span><span class="annotation">: TypeAlias</span>        =
<span class="default_value"><a href="#Array">Array</a></span>


    </div>
    <a class="headerlink" href="#Float"></a>



                </section>
                <section id="Int">
                    <div class="attr variable">
            <span class="name">Int</span><span class="annotation">: TypeAlias</span>        =
<span class="default_value"><a href="#Array">Array</a></span>


    </div>
    <a class="headerlink" href="#Int"></a>



                </section>
                <section id="Quaternion">
                    <div class="attr variable">
            <span class="name">Quaternion</span><span class="annotation">: TypeAlias</span>        =
<span class="default_value"><a href="#Array">Array</a></span>


    </div>
    <a class="headerlink" href="#Quaternion"></a>



                </section>
                <section id="multiply_quats">
                            <input id="multiply_quats-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">multiply_quats</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">q1</span>, </span><span class="param"><span class="n">q2</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="multiply_quats-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#multiply_quats"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="multiply_quats-16"><a href="#multiply_quats-16"><span class="linenos">16</span></a><span class="k">def</span> <span class="nf">multiply_quats</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">):</span>
</span><span id="multiply_quats-17"><a href="#multiply_quats-17"><span class="linenos">17</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span> <span class="o">*</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="n">q2</span><span class="p">))</span><span class="o">.</span><span class="n">as_quat</span><span class="p">()</span>
</span></pre></div>




                </section>
                <section id="multiply_quat_and_vec">
                            <input id="multiply_quat_and_vec-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">multiply_quat_and_vec</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">q</span>, </span><span class="param"><span class="n">vs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="multiply_quat_and_vec-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#multiply_quat_and_vec"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="multiply_quat_and_vec-20"><a href="#multiply_quat_and_vec-20"><span class="linenos">20</span></a><span class="k">def</span> <span class="nf">multiply_quat_and_vec</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">vs</span><span class="p">):</span>
</span><span id="multiply_quat_and_vec-21"><a href="#multiply_quat_and_vec-21"><span class="linenos">21</span></a>    <span class="k">return</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">vs</span><span class="p">)</span>
</span></pre></div>




                </section>
                <section id="choose_good_quat">
                            <input id="choose_good_quat-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">choose_good_quat</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">q</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="choose_good_quat-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#choose_good_quat"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="choose_good_quat-24"><a href="#choose_good_quat-24"><span class="linenos">24</span></a><span class="k">def</span> <span class="nf">choose_good_quat</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
</span><span id="choose_good_quat-25"><a href="#choose_good_quat-25"><span class="linenos">25</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="choose_good_quat-26"><a href="#choose_good_quat-26"><span class="linenos">26</span></a><span class="sd">    If the real part of the quaternion is negative, return the antipodal quaternion,</span>
</span><span id="choose_good_quat-27"><a href="#choose_good_quat-27"><span class="linenos">27</span></a><span class="sd">    which represents the same rotation. If the real part is zero, there is still ambiguity,</span>
</span><span id="choose_good_quat-28"><a href="#choose_good_quat-28"><span class="linenos">28</span></a><span class="sd">    so we&#39;ll iteratively resolve that as well.</span>
</span><span id="choose_good_quat-29"><a href="#choose_good_quat-29"><span class="linenos">29</span></a>
</span><span id="choose_good_quat-30"><a href="#choose_good_quat-30"><span class="linenos">30</span></a><span class="sd">    Recall that SO(3) is isomorphic to  S^3/x~-x and</span>
</span><span id="choose_good_quat-31"><a href="#choose_good_quat-31"><span class="linenos">31</span></a><span class="sd">    also to D^3/~ where x~-x for x in S^2 = \\partial D^3.</span>
</span><span id="choose_good_quat-32"><a href="#choose_good_quat-32"><span class="linenos">32</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="choose_good_quat-33"><a href="#choose_good_quat-33"><span class="linenos">33</span></a>    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
</span><span id="choose_good_quat-34"><a href="#choose_good_quat-34"><span class="linenos">34</span></a>        <span class="n">q</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="choose_good_quat-35"><a href="#choose_good_quat-35"><span class="linenos">35</span></a>        <span class="n">jnp</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]])</span> <span class="o">*</span> <span class="n">q</span><span class="p">,</span>
</span><span id="choose_good_quat-36"><a href="#choose_good_quat-36"><span class="linenos">36</span></a>        <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
</span><span id="choose_good_quat-37"><a href="#choose_good_quat-37"><span class="linenos">37</span></a>            <span class="n">q</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="choose_good_quat-38"><a href="#choose_good_quat-38"><span class="linenos">38</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">*</span> <span class="n">q</span><span class="p">,</span>
</span><span id="choose_good_quat-39"><a href="#choose_good_quat-39"><span class="linenos">39</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
</span><span id="choose_good_quat-40"><a href="#choose_good_quat-40"><span class="linenos">40</span></a>                <span class="n">q</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span> <span class="o">*</span> <span class="n">q</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])</span> <span class="o">*</span> <span class="n">q</span>
</span><span id="choose_good_quat-41"><a href="#choose_good_quat-41"><span class="linenos">41</span></a>            <span class="p">),</span>
</span><span id="choose_good_quat-42"><a href="#choose_good_quat-42"><span class="linenos">42</span></a>        <span class="p">),</span>
</span><span id="choose_good_quat-43"><a href="#choose_good_quat-43"><span class="linenos">43</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>If the real part of the quaternion is negative, return the antipodal quaternion,
which represents the same rotation. If the real part is zero, there is still ambiguity,
so we'll iteratively resolve that as well.</p>

<p>Recall that SO(3) is isomorphic to  S^3/x~-x and
also to D^3/~ where x~-x for x in S^2 = \partial D^3.</p>
</div>


                </section>
                <section id="sample_uniform_pose">
                            <input id="sample_uniform_pose-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@jax.jit</div>

        <span class="def">def</span>
        <span class="name">sample_uniform_pose</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">key</span>, </span><span class="param"><span class="n">low</span>, </span><span class="param"><span class="n">high</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="sample_uniform_pose-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#sample_uniform_pose"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="sample_uniform_pose-46"><a href="#sample_uniform_pose-46"><span class="linenos">46</span></a><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
</span><span id="sample_uniform_pose-47"><a href="#sample_uniform_pose-47"><span class="linenos">47</span></a><span class="k">def</span> <span class="nf">sample_uniform_pose</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">):</span>
</span><span id="sample_uniform_pose-48"><a href="#sample_uniform_pose-48"><span class="linenos">48</span></a>    <span class="n">keys</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="sample_uniform_pose-49"><a href="#sample_uniform_pose-49"><span class="linenos">49</span></a>    <span class="n">pos</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="mi">3</span><span class="p">,))</span> <span class="o">*</span> <span class="p">(</span><span class="n">high</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span> <span class="o">+</span> <span class="n">low</span>
</span><span id="sample_uniform_pose-50"><a href="#sample_uniform_pose-50"><span class="linenos">50</span></a>    <span class="n">quat</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">4</span><span class="p">,))</span>
</span><span id="sample_uniform_pose-51"><a href="#sample_uniform_pose-51"><span class="linenos">51</span></a>    <span class="n">quat</span> <span class="o">=</span> <span class="n">quat</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">quat</span><span class="p">)</span>
</span><span id="sample_uniform_pose-52"><a href="#sample_uniform_pose-52"><span class="linenos">52</span></a>    <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">quat</span><span class="p">)</span>
</span></pre></div>




                </section>
                <section id="logpdf_uniform_pose">
                            <input id="logpdf_uniform_pose-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">logpdf_uniform_pose</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pose</span>, </span><span class="param"><span class="n">low</span>, </span><span class="param"><span class="n">high</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="logpdf_uniform_pose-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#logpdf_uniform_pose"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="logpdf_uniform_pose-55"><a href="#logpdf_uniform_pose-55"><span class="linenos">55</span></a><span class="k">def</span> <span class="nf">logpdf_uniform_pose</span><span class="p">(</span><span class="n">pose</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">):</span>
</span><span id="logpdf_uniform_pose-56"><a href="#logpdf_uniform_pose-56"><span class="linenos">56</span></a>    <span class="n">position</span> <span class="o">=</span> <span class="n">pose</span><span class="o">.</span><span class="n">pos</span>
</span><span id="logpdf_uniform_pose-57"><a href="#logpdf_uniform_pose-57"><span class="linenos">57</span></a>    <span class="n">valid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">&lt;=</span> <span class="n">position</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">position</span> <span class="o">&lt;=</span> <span class="n">high</span><span class="p">)</span>
</span><span id="logpdf_uniform_pose-58"><a href="#logpdf_uniform_pose-58"><span class="linenos">58</span></a>    <span class="n">position_score</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">valid</span> <span class="o">*</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">position</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">high</span> <span class="o">-</span> <span class="n">low</span><span class="p">)))</span>
</span><span id="logpdf_uniform_pose-59"><a href="#logpdf_uniform_pose-59"><span class="linenos">59</span></a>    <span class="k">return</span> <span class="n">position_score</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span>
</span></pre></div>




                </section>
                <section id="sample_gaussian_vmf_pose">
                            <input id="sample_gaussian_vmf_pose-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@jax.jit</div>

        <span class="def">def</span>
        <span class="name">sample_gaussian_vmf_pose</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">key</span>, </span><span class="param"><span class="n">mean_pose</span>, </span><span class="param"><span class="n">std</span>, </span><span class="param"><span class="n">concentration</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="sample_gaussian_vmf_pose-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#sample_gaussian_vmf_pose"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="sample_gaussian_vmf_pose-62"><a href="#sample_gaussian_vmf_pose-62"><span class="linenos">62</span></a><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
</span><span id="sample_gaussian_vmf_pose-63"><a href="#sample_gaussian_vmf_pose-63"><span class="linenos">63</span></a><span class="k">def</span> <span class="nf">sample_gaussian_vmf_pose</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">mean_pose</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">concentration</span><span class="p">):</span>
</span><span id="sample_gaussian_vmf_pose-64"><a href="#sample_gaussian_vmf_pose-64"><span class="linenos">64</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="sample_gaussian_vmf_pose-65"><a href="#sample_gaussian_vmf_pose-65"><span class="linenos">65</span></a><span class="sd">    Samples poses from the product of a diagonal normal distribution (for position) and</span>
</span><span id="sample_gaussian_vmf_pose-66"><a href="#sample_gaussian_vmf_pose-66"><span class="linenos">66</span></a><span class="sd">    a generalized von Mises-Fisher distribution (for quaternion).</span>
</span><span id="sample_gaussian_vmf_pose-67"><a href="#sample_gaussian_vmf_pose-67"><span class="linenos">67</span></a>
</span><span id="sample_gaussian_vmf_pose-68"><a href="#sample_gaussian_vmf_pose-68"><span class="linenos">68</span></a><span class="sd">    Note:</span>
</span><span id="sample_gaussian_vmf_pose-69"><a href="#sample_gaussian_vmf_pose-69"><span class="linenos">69</span></a><span class="sd">    One can view the von MisesFisher distribution over the n-sphere</span>
</span><span id="sample_gaussian_vmf_pose-70"><a href="#sample_gaussian_vmf_pose-70"><span class="linenos">70</span></a><span class="sd">    as the restriction of the normal distribution on R^{n+1}</span>
</span><span id="sample_gaussian_vmf_pose-71"><a href="#sample_gaussian_vmf_pose-71"><span class="linenos">71</span></a><span class="sd">    to the n-sphere. From this viewpoint the concentration is</span>
</span><span id="sample_gaussian_vmf_pose-72"><a href="#sample_gaussian_vmf_pose-72"><span class="linenos">72</span></a><span class="sd">    approximateley the inverse of the variance.</span>
</span><span id="sample_gaussian_vmf_pose-73"><a href="#sample_gaussian_vmf_pose-73"><span class="linenos">73</span></a>
</span><span id="sample_gaussian_vmf_pose-74"><a href="#sample_gaussian_vmf_pose-74"><span class="linenos">74</span></a><span class="sd">    See:</span>
</span><span id="sample_gaussian_vmf_pose-75"><a href="#sample_gaussian_vmf_pose-75"><span class="linenos">75</span></a><span class="sd">    &gt; https://en.wikipedia.org/wiki/Von_Mises%E2%80%93Fisher_distribution#Relation_to_normal_distribution</span>
</span><span id="sample_gaussian_vmf_pose-76"><a href="#sample_gaussian_vmf_pose-76"><span class="linenos">76</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="sample_gaussian_vmf_pose-77"><a href="#sample_gaussian_vmf_pose-77"><span class="linenos">77</span></a>    <span class="kn">from</span> <span class="nn">b3d.utils</span> <span class="kn">import</span> <span class="n">keysplit</span>
</span><span id="sample_gaussian_vmf_pose-78"><a href="#sample_gaussian_vmf_pose-78"><span class="linenos">78</span></a>
</span><span id="sample_gaussian_vmf_pose-79"><a href="#sample_gaussian_vmf_pose-79"><span class="linenos">79</span></a>    <span class="n">_</span><span class="p">,</span> <span class="n">keys</span> <span class="o">=</span> <span class="n">keysplit</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="sample_gaussian_vmf_pose-80"><a href="#sample_gaussian_vmf_pose-80"><span class="linenos">80</span></a>    <span class="n">var</span> <span class="o">=</span> <span class="n">std</span><span class="o">**</span><span class="mi">2</span>
</span><span id="sample_gaussian_vmf_pose-81"><a href="#sample_gaussian_vmf_pose-81"><span class="linenos">81</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mean_pose</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">var</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</span><span id="sample_gaussian_vmf_pose-82"><a href="#sample_gaussian_vmf_pose-82"><span class="linenos">82</span></a>    <span class="n">q</span> <span class="o">=</span> <span class="n">tfp</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">VonMisesFisher</span><span class="p">(</span><span class="n">mean_pose</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">concentration</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
</span><span id="sample_gaussian_vmf_pose-83"><a href="#sample_gaussian_vmf_pose-83"><span class="linenos">83</span></a>        <span class="n">seed</span><span class="o">=</span><span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="sample_gaussian_vmf_pose-84"><a href="#sample_gaussian_vmf_pose-84"><span class="linenos">84</span></a>    <span class="p">)</span>
</span><span id="sample_gaussian_vmf_pose-85"><a href="#sample_gaussian_vmf_pose-85"><span class="linenos">85</span></a>
</span><span id="sample_gaussian_vmf_pose-86"><a href="#sample_gaussian_vmf_pose-86"><span class="linenos">86</span></a>    <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Samples poses from the product of a diagonal normal distribution (for position) and
a generalized von Mises-Fisher distribution (for quaternion).</p>

<p>Note:
One can view the von MisesFisher distribution over the n-sphere
as the restriction of the normal distribution on R^{n+1}
to the n-sphere. From this viewpoint the concentration is
approximateley the inverse of the variance.</p>

<p>See:</p>

<blockquote>
  <p><a href="https://en.wikipedia.org/wiki/Von_Mises%E2%80%93Fisher_distribution#Relation_to_normal_distribution">https://en.wikipedia.org/wiki/Von_Mises%E2%80%93Fisher_distribution#Relation_to_normal_distribution</a></p>
</blockquote>
</div>


                </section>
                <section id="logpdf_gaussian_vmf_pose">
                            <input id="logpdf_gaussian_vmf_pose-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">logpdf_gaussian_vmf_pose</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pose</span>, </span><span class="param"><span class="n">mean_pose</span>, </span><span class="param"><span class="n">std</span>, </span><span class="param"><span class="n">concentration</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="logpdf_gaussian_vmf_pose-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#logpdf_gaussian_vmf_pose"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="logpdf_gaussian_vmf_pose-89"><a href="#logpdf_gaussian_vmf_pose-89"><span class="linenos">89</span></a><span class="k">def</span> <span class="nf">logpdf_gaussian_vmf_pose</span><span class="p">(</span><span class="n">pose</span><span class="p">,</span> <span class="n">mean_pose</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">concentration</span><span class="p">):</span>
</span><span id="logpdf_gaussian_vmf_pose-90"><a href="#logpdf_gaussian_vmf_pose-90"><span class="linenos">90</span></a>    <span class="n">translation_score</span> <span class="o">=</span> <span class="n">tfp</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">MultivariateNormalDiag</span><span class="p">(</span>
</span><span id="logpdf_gaussian_vmf_pose-91"><a href="#logpdf_gaussian_vmf_pose-91"><span class="linenos">91</span></a>        <span class="n">mean_pose</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">std</span>
</span><span id="logpdf_gaussian_vmf_pose-92"><a href="#logpdf_gaussian_vmf_pose-92"><span class="linenos">92</span></a>    <span class="p">)</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">pose</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
</span><span id="logpdf_gaussian_vmf_pose-93"><a href="#logpdf_gaussian_vmf_pose-93"><span class="linenos">93</span></a>    <span class="n">quaternion_score</span> <span class="o">=</span> <span class="n">tfp</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">VonMisesFisher</span><span class="p">(</span>
</span><span id="logpdf_gaussian_vmf_pose-94"><a href="#logpdf_gaussian_vmf_pose-94"><span class="linenos">94</span></a>        <span class="n">mean_pose</span><span class="o">.</span><span class="n">quat</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">mean_pose</span><span class="o">.</span><span class="n">quat</span><span class="p">),</span> <span class="n">concentration</span>
</span><span id="logpdf_gaussian_vmf_pose-95"><a href="#logpdf_gaussian_vmf_pose-95"><span class="linenos">95</span></a>    <span class="p">)</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">pose</span><span class="o">.</span><span class="n">quat</span><span class="p">)</span>
</span><span id="logpdf_gaussian_vmf_pose-96"><a href="#logpdf_gaussian_vmf_pose-96"><span class="linenos">96</span></a>    <span class="k">return</span> <span class="n">translation_score</span> <span class="o">+</span> <span class="n">quaternion_score</span>
</span></pre></div>




                </section>
                <section id="camera_from_position_and_target">
                            <input id="camera_from_position_and_target-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">camera_from_position_and_target</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">position</span>,</span><span class="param">	<span class="n">target</span><span class="o">=</span><span class="n">Array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)</span>,</span><span class="param">	<span class="n">up</span><span class="o">=</span><span class="n">Array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="camera_from_position_and_target-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#camera_from_position_and_target"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="camera_from_position_and_target-99"><a href="#camera_from_position_and_target-99"><span class="linenos"> 99</span></a><span class="k">def</span> <span class="nf">camera_from_position_and_target</span><span class="p">(</span>
</span><span id="camera_from_position_and_target-100"><a href="#camera_from_position_and_target-100"><span class="linenos">100</span></a>    <span class="n">position</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">up</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</span><span id="camera_from_position_and_target-101"><a href="#camera_from_position_and_target-101"><span class="linenos">101</span></a><span class="p">):</span>
</span><span id="camera_from_position_and_target-102"><a href="#camera_from_position_and_target-102"><span class="linenos">102</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="camera_from_position_and_target-103"><a href="#camera_from_position_and_target-103"><span class="linenos">103</span></a><span class="sd">    Create a camera pose at `position` with the camera-z-axis pointint at `target`.</span>
</span><span id="camera_from_position_and_target-104"><a href="#camera_from_position_and_target-104"><span class="linenos">104</span></a><span class="sd">    Recall that in world coordinates we assume z-axis is up.</span>
</span><span id="camera_from_position_and_target-105"><a href="#camera_from_position_and_target-105"><span class="linenos">105</span></a>
</span><span id="camera_from_position_and_target-106"><a href="#camera_from_position_and_target-106"><span class="linenos">106</span></a><span class="sd">    Args:</span>
</span><span id="camera_from_position_and_target-107"><a href="#camera_from_position_and_target-107"><span class="linenos">107</span></a><span class="sd">        `position`: 3D position vector of the camera</span>
</span><span id="camera_from_position_and_target-108"><a href="#camera_from_position_and_target-108"><span class="linenos">108</span></a><span class="sd">        `target`: 3D position vector of the point to look at</span>
</span><span id="camera_from_position_and_target-109"><a href="#camera_from_position_and_target-109"><span class="linenos">109</span></a><span class="sd">        `up`: 3D vector pointing up.</span>
</span><span id="camera_from_position_and_target-110"><a href="#camera_from_position_and_target-110"><span class="linenos">110</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="camera_from_position_and_target-111"><a href="#camera_from_position_and_target-111"><span class="linenos">111</span></a>    <span class="n">z</span> <span class="o">=</span> <span class="n">target</span> <span class="o">-</span> <span class="n">position</span>
</span><span id="camera_from_position_and_target-112"><a href="#camera_from_position_and_target-112"><span class="linenos">112</span></a>    <span class="n">z</span> <span class="o">=</span> <span class="n">z</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</span><span id="camera_from_position_and_target-113"><a href="#camera_from_position_and_target-113"><span class="linenos">113</span></a>
</span><span id="camera_from_position_and_target-114"><a href="#camera_from_position_and_target-114"><span class="linenos">114</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">up</span><span class="p">)</span>
</span><span id="camera_from_position_and_target-115"><a href="#camera_from_position_and_target-115"><span class="linenos">115</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="camera_from_position_and_target-116"><a href="#camera_from_position_and_target-116"><span class="linenos">116</span></a>
</span><span id="camera_from_position_and_target-117"><a href="#camera_from_position_and_target-117"><span class="linenos">117</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="camera_from_position_and_target-118"><a href="#camera_from_position_and_target-118"><span class="linenos">118</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="camera_from_position_and_target-119"><a href="#camera_from_position_and_target-119"><span class="linenos">119</span></a>
</span><span id="camera_from_position_and_target-120"><a href="#camera_from_position_and_target-120"><span class="linenos">120</span></a>    <span class="n">rotation_matrix</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">z</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
</span><span id="camera_from_position_and_target-121"><a href="#camera_from_position_and_target-121"><span class="linenos">121</span></a>    <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">rotation_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">as_quat</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Create a camera pose at <code>position</code> with the camera-z-axis pointint at <code>target</code>.
Recall that in world coordinates we assume z-axis is up.</p>

<p>Args:
    <code>position</code>: 3D position vector of the camera
    <code>target</code>: 3D position vector of the point to look at
    <code>up</code>: 3D vector pointing up.</p>
</div>


                </section>
                <section id="Pose">
                            <input id="Pose-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@register_pytree_node_class</div>

    <span class="def">class</span>
    <span class="name">Pose</span>:

                <label class="view-source-button" for="Pose-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose-124"><a href="#Pose-124"><span class="linenos">124</span></a><span class="nd">@register_pytree_node_class</span>
</span><span id="Pose-125"><a href="#Pose-125"><span class="linenos">125</span></a><span class="k">class</span> <span class="nc">Pose</span><span class="p">:</span>
</span><span id="Pose-126"><a href="#Pose-126"><span class="linenos">126</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Pose class with positions and quaternions representing rotation.&quot;&quot;&quot;</span>
</span><span id="Pose-127"><a href="#Pose-127"><span class="linenos">127</span></a>
</span><span id="Pose-128"><a href="#Pose-128"><span class="linenos">128</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">quaternion</span><span class="p">):</span>
</span><span id="Pose-129"><a href="#Pose-129"><span class="linenos">129</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Pose-130"><a href="#Pose-130"><span class="linenos">130</span></a><span class="sd">        3D rigid transformation</span>
</span><span id="Pose-131"><a href="#Pose-131"><span class="linenos">131</span></a>
</span><span id="Pose-132"><a href="#Pose-132"><span class="linenos">132</span></a><span class="sd">        position: 3D translation vector</span>
</span><span id="Pose-133"><a href="#Pose-133"><span class="linenos">133</span></a><span class="sd">        quaternion: 4D quaternion in xyzw</span>
</span><span id="Pose-134"><a href="#Pose-134"><span class="linenos">134</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-135"><a href="#Pose-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">=</span> <span class="n">position</span>
</span><span id="Pose-136"><a href="#Pose-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_quaternion</span> <span class="o">=</span> <span class="n">quaternion</span>
</span><span id="Pose-137"><a href="#Pose-137"><span class="linenos">137</span></a>
</span><span id="Pose-138"><a href="#Pose-138"><span class="linenos">138</span></a>    <span class="n">identity_quaternion</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</span><span id="Pose-139"><a href="#Pose-139"><span class="linenos">139</span></a>
</span><span id="Pose-140"><a href="#Pose-140"><span class="linenos">140</span></a>    <span class="nd">@property</span>
</span><span id="Pose-141"><a href="#Pose-141"><span class="linenos">141</span></a>    <span class="k">def</span> <span class="nf">unit_quaternion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-142"><a href="#Pose-142"><span class="linenos">142</span></a>        <span class="k">raise</span> <span class="ne">Warning</span><span class="p">(</span>
</span><span id="Pose-143"><a href="#Pose-143"><span class="linenos">143</span></a>            <span class="s2">&quot;Use `identity_quaternion` instead, a unit quaternion is any quat with norm 1!&quot;</span>
</span><span id="Pose-144"><a href="#Pose-144"><span class="linenos">144</span></a>        <span class="p">)</span>
</span><span id="Pose-145"><a href="#Pose-145"><span class="linenos">145</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">identity_quaternion</span>
</span><span id="Pose-146"><a href="#Pose-146"><span class="linenos">146</span></a>
</span><span id="Pose-147"><a href="#Pose-147"><span class="linenos">147</span></a>    <span class="nd">@property</span>
</span><span id="Pose-148"><a href="#Pose-148"><span class="linenos">148</span></a>    <span class="k">def</span> <span class="nf">pos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-149"><a href="#Pose-149"><span class="linenos">149</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span>
</span><span id="Pose-150"><a href="#Pose-150"><span class="linenos">150</span></a>
</span><span id="Pose-151"><a href="#Pose-151"><span class="linenos">151</span></a>    <span class="n">position</span> <span class="o">=</span> <span class="n">pos</span>
</span><span id="Pose-152"><a href="#Pose-152"><span class="linenos">152</span></a>
</span><span id="Pose-153"><a href="#Pose-153"><span class="linenos">153</span></a>    <span class="nd">@property</span>
</span><span id="Pose-154"><a href="#Pose-154"><span class="linenos">154</span></a>    <span class="k">def</span> <span class="nf">xyzw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-155"><a href="#Pose-155"><span class="linenos">155</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quaternion</span>
</span><span id="Pose-156"><a href="#Pose-156"><span class="linenos">156</span></a>
</span><span id="Pose-157"><a href="#Pose-157"><span class="linenos">157</span></a>    <span class="n">quat</span> <span class="o">=</span> <span class="n">xyzw</span>
</span><span id="Pose-158"><a href="#Pose-158"><span class="linenos">158</span></a>    <span class="n">quaternion</span> <span class="o">=</span> <span class="n">xyzw</span>
</span><span id="Pose-159"><a href="#Pose-159"><span class="linenos">159</span></a>
</span><span id="Pose-160"><a href="#Pose-160"><span class="linenos">160</span></a>    <span class="nd">@property</span>
</span><span id="Pose-161"><a href="#Pose-161"><span class="linenos">161</span></a>    <span class="k">def</span> <span class="nf">wxyz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-162"><a href="#Pose-162"><span class="linenos">162</span></a>        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="Pose-163"><a href="#Pose-163"><span class="linenos">163</span></a>            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">quaternion</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">quaternion</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span>
</span><span id="Pose-164"><a href="#Pose-164"><span class="linenos">164</span></a>        <span class="p">)</span>
</span><span id="Pose-165"><a href="#Pose-165"><span class="linenos">165</span></a>
</span><span id="Pose-166"><a href="#Pose-166"><span class="linenos">166</span></a>    <span class="nd">@property</span>
</span><span id="Pose-167"><a href="#Pose-167"><span class="linenos">167</span></a>    <span class="k">def</span> <span class="nf">rot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-168"><a href="#Pose-168"><span class="linenos">168</span></a>        <span class="k">return</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">)</span>
</span><span id="Pose-169"><a href="#Pose-169"><span class="linenos">169</span></a>
</span><span id="Pose-170"><a href="#Pose-170"><span class="linenos">170</span></a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-171"><a href="#Pose-171"><span class="linenos">171</span></a>        <span class="n">quat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Pose-172"><a href="#Pose-172"><span class="linenos">172</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">quat</span><span class="p">)</span>
</span><span id="Pose-173"><a href="#Pose-173"><span class="linenos">173</span></a>
</span><span id="Pose-174"><a href="#Pose-174"><span class="linenos">174</span></a>    <span class="k">def</span> <span class="nf">quat_in_upper_hemisphere</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-175"><a href="#Pose-175"><span class="linenos">175</span></a>        <span class="n">quat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Pose-176"><a href="#Pose-176"><span class="linenos">176</span></a>        <span class="n">quat</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">quat</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]])</span> <span class="o">*</span> <span class="n">quat</span>
</span><span id="Pose-177"><a href="#Pose-177"><span class="linenos">177</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">quat</span><span class="p">)</span>
</span><span id="Pose-178"><a href="#Pose-178"><span class="linenos">178</span></a>
</span><span id="Pose-179"><a href="#Pose-179"><span class="linenos">179</span></a>    <span class="k">def</span> <span class="nf">canonical</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-180"><a href="#Pose-180"><span class="linenos">180</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Pose-181"><a href="#Pose-181"><span class="linenos">181</span></a><span class="sd">        Chooses a canonical representative for the quaternion of the pose, i.e.</span>
</span><span id="Pose-182"><a href="#Pose-182"><span class="linenos">182</span></a><span class="sd">        chooses from {q, -q} s.t. q[3] &gt;= 0. Note that if q[3]==0 there is still ambiguity.</span>
</span><span id="Pose-183"><a href="#Pose-183"><span class="linenos">183</span></a>
</span><span id="Pose-184"><a href="#Pose-184"><span class="linenos">184</span></a><span class="sd">        Recall that SO(3) is isomorphic to  S^3/x~-x and</span>
</span><span id="Pose-185"><a href="#Pose-185"><span class="linenos">185</span></a><span class="sd">        also to D^3/~ where x~-x for x in S^2 = \\partial D^3.</span>
</span><span id="Pose-186"><a href="#Pose-186"><span class="linenos">186</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-187"><a href="#Pose-187"><span class="linenos">187</span></a>        <span class="n">quat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Pose-188"><a href="#Pose-188"><span class="linenos">188</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">choose_good_quat</span><span class="p">(</span><span class="n">quat</span><span class="p">))</span>
</span><span id="Pose-189"><a href="#Pose-189"><span class="linenos">189</span></a>
</span><span id="Pose-190"><a href="#Pose-190"><span class="linenos">190</span></a>    <span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-191"><a href="#Pose-191"><span class="linenos">191</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span>
</span><span id="Pose-192"><a href="#Pose-192"><span class="linenos">192</span></a>
</span><span id="Pose-193"><a href="#Pose-193"><span class="linenos">193</span></a>    <span class="k">def</span> <span class="nf">tree_flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-194"><a href="#Pose-194"><span class="linenos">194</span></a>        <span class="k">return</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="Pose-195"><a href="#Pose-195"><span class="linenos">195</span></a>
</span><span id="Pose-196"><a href="#Pose-196"><span class="linenos">196</span></a>    <span class="nd">@classmethod</span>
</span><span id="Pose-197"><a href="#Pose-197"><span class="linenos">197</span></a>    <span class="k">def</span> <span class="nf">tree_unflatten</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span> <span class="n">children</span><span class="p">):</span>
</span><span id="Pose-198"><a href="#Pose-198"><span class="linenos">198</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">*</span><span class="n">children</span><span class="p">)</span>
</span><span id="Pose-199"><a href="#Pose-199"><span class="linenos">199</span></a>
</span><span id="Pose-200"><a href="#Pose-200"><span class="linenos">200</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-201"><a href="#Pose-201"><span class="linenos">201</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">))</span>
</span><span id="Pose-202"><a href="#Pose-202"><span class="linenos">202</span></a>
</span><span id="Pose-203"><a href="#Pose-203"><span class="linenos">203</span></a>    <span class="nd">@property</span>
</span><span id="Pose-204"><a href="#Pose-204"><span class="linenos">204</span></a>    <span class="k">def</span> <span class="nf">flat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-205"><a href="#Pose-205"><span class="linenos">205</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span><span id="Pose-206"><a href="#Pose-206"><span class="linenos">206</span></a>
</span><span id="Pose-207"><a href="#Pose-207"><span class="linenos">207</span></a>    <span class="nd">@property</span>
</span><span id="Pose-208"><a href="#Pose-208"><span class="linenos">208</span></a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-209"><a href="#Pose-209"><span class="linenos">209</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Pose-210"><a href="#Pose-210"><span class="linenos">210</span></a>
</span><span id="Pose-211"><a href="#Pose-211"><span class="linenos">211</span></a>    <span class="k">def</span> <span class="nf">reshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="Pose-212"><a href="#Pose-212"><span class="linenos">212</span></a>        <span class="n">shape</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span id="Pose-213"><a href="#Pose-213"><span class="linenos">213</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span> <span class="o">+</span> <span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span> <span class="o">+</span> <span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
</span><span id="Pose-214"><a href="#Pose-214"><span class="linenos">214</span></a>
</span><span id="Pose-215"><a href="#Pose-215"><span class="linenos">215</span></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-216"><a href="#Pose-216"><span class="linenos">216</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Pose-217"><a href="#Pose-217"><span class="linenos">217</span></a>
</span><span id="Pose-218"><a href="#Pose-218"><span class="linenos">218</span></a>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-219"><a href="#Pose-219"><span class="linenos">219</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Pose-220"><a href="#Pose-220"><span class="linenos">220</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="Pose-221"><a href="#Pose-221"><span class="linenos">221</span></a>
</span><span id="Pose-222"><a href="#Pose-222"><span class="linenos">222</span></a>    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-223"><a href="#Pose-223"><span class="linenos">223</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Pose-224"><a href="#Pose-224"><span class="linenos">224</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-225"><a href="#Pose-225"><span class="linenos">225</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">current</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="Pose-226"><a href="#Pose-226"><span class="linenos">226</span></a>        <span class="k">raise</span> <span class="ne">StopIteration</span>
</span><span id="Pose-227"><a href="#Pose-227"><span class="linenos">227</span></a>
</span><span id="Pose-228"><a href="#Pose-228"><span class="linenos">228</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="Pose-229"><a href="#Pose-229"><span class="linenos">229</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</span><span id="Pose-230"><a href="#Pose-230"><span class="linenos">230</span></a>
</span><span id="Pose-231"><a href="#Pose-231"><span class="linenos">231</span></a>    <span class="k">def</span> <span class="nf">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="Pose-232"><a href="#Pose-232"><span class="linenos">232</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="Pose-233"><a href="#Pose-233"><span class="linenos">233</span></a>
</span><span id="Pose-234"><a href="#Pose-234"><span class="linenos">234</span></a>    <span class="k">def</span> <span class="nf">as_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-235"><a href="#Pose-235"><span class="linenos">235</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a 4x4 pose matrix.&quot;&quot;&quot;</span>
</span><span id="Pose-236"><a href="#Pose-236"><span class="linenos">236</span></a>        <span class="n">pose_matrix</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="Pose-237"><a href="#Pose-237"><span class="linenos">237</span></a>        <span class="n">pose_matrix</span> <span class="o">=</span> <span class="n">pose_matrix</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
</span><span id="Pose-238"><a href="#Pose-238"><span class="linenos">238</span></a>            <span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">)</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
</span><span id="Pose-239"><a href="#Pose-239"><span class="linenos">239</span></a>        <span class="p">)</span>
</span><span id="Pose-240"><a href="#Pose-240"><span class="linenos">240</span></a>        <span class="n">pose_matrix</span> <span class="o">=</span> <span class="n">pose_matrix</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
</span><span id="Pose-241"><a href="#Pose-241"><span class="linenos">241</span></a>        <span class="n">pose_matrix</span> <span class="o">=</span> <span class="n">pose_matrix</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="Pose-242"><a href="#Pose-242"><span class="linenos">242</span></a>        <span class="k">return</span> <span class="n">pose_matrix</span>
</span><span id="Pose-243"><a href="#Pose-243"><span class="linenos">243</span></a>
</span><span id="Pose-244"><a href="#Pose-244"><span class="linenos">244</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose-245"><a href="#Pose-245"><span class="linenos">245</span></a>    <span class="k">def</span> <span class="nf">identity</span><span class="p">():</span>
</span><span id="Pose-246"><a href="#Pose-246"><span class="linenos">246</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the identity transformation.&quot;&quot;&quot;</span>
</span><span id="Pose-247"><a href="#Pose-247"><span class="linenos">247</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span>
</span><span id="Pose-248"><a href="#Pose-248"><span class="linenos">248</span></a>
</span><span id="Pose-249"><a href="#Pose-249"><span class="linenos">249</span></a>    <span class="n">eye</span> <span class="o">=</span> <span class="n">identity</span>
</span><span id="Pose-250"><a href="#Pose-250"><span class="linenos">250</span></a>    <span class="nb">id</span> <span class="o">=</span> <span class="n">identity</span>
</span><span id="Pose-251"><a href="#Pose-251"><span class="linenos">251</span></a>
</span><span id="Pose-252"><a href="#Pose-252"><span class="linenos">252</span></a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vec</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Pose-253"><a href="#Pose-253"><span class="linenos">253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply pose to vectors.&quot;&quot;&quot;</span>
</span><span id="Pose-254"><a href="#Pose-254"><span class="linenos">254</span></a>        <span class="k">return</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
</span><span id="Pose-255"><a href="#Pose-255"><span class="linenos">255</span></a>
</span><span id="Pose-256"><a href="#Pose-256"><span class="linenos">256</span></a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vec</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Pose-257"><a href="#Pose-257"><span class="linenos">257</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply pose to vectors.&quot;&quot;&quot;</span>
</span><span id="Pose-258"><a href="#Pose-258"><span class="linenos">258</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
</span><span id="Pose-259"><a href="#Pose-259"><span class="linenos">259</span></a>
</span><span id="Pose-260"><a href="#Pose-260"><span class="linenos">260</span></a>    <span class="k">def</span> <span class="nf">compose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-261"><a href="#Pose-261"><span class="linenos">261</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compose with other pose.&quot;&quot;&quot;</span>
</span><span id="Pose-262"><a href="#Pose-262"><span class="linenos">262</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pose</span><span class="o">.</span><span class="n">pos</span><span class="p">),</span> <span class="n">multiply_quats</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">pose</span><span class="o">.</span><span class="n">xyzw</span><span class="p">))</span>
</span><span id="Pose-263"><a href="#Pose-263"><span class="linenos">263</span></a>
</span><span id="Pose-264"><a href="#Pose-264"><span class="linenos">264</span></a>    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-265"><a href="#Pose-265"><span class="linenos">265</span></a>        <span class="c1"># NOTE: this is useful for gradient updates.</span>
</span><span id="Pose-266"><a href="#Pose-266"><span class="linenos">266</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">+</span> <span class="n">pose</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span> <span class="o">+</span> <span class="n">pose</span><span class="o">.</span><span class="n">quat</span><span class="p">)</span>
</span><span id="Pose-267"><a href="#Pose-267"><span class="linenos">267</span></a>
</span><span id="Pose-268"><a href="#Pose-268"><span class="linenos">268</span></a>    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-269"><a href="#Pose-269"><span class="linenos">269</span></a>        <span class="c1"># NOTE: this is useful for gradient updates.</span>
</span><span id="Pose-270"><a href="#Pose-270"><span class="linenos">270</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">-</span> <span class="n">pose</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span> <span class="o">-</span> <span class="n">pose</span><span class="o">.</span><span class="n">quat</span><span class="p">)</span>
</span><span id="Pose-271"><a href="#Pose-271"><span class="linenos">271</span></a>
</span><span id="Pose-272"><a href="#Pose-272"><span class="linenos">272</span></a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="n">Float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-273"><a href="#Pose-273"><span class="linenos">273</span></a>        <span class="c1"># NOTE: this is useful for gradient updates.</span>
</span><span id="Pose-274"><a href="#Pose-274"><span class="linenos">274</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)</span>
</span><span id="Pose-275"><a href="#Pose-275"><span class="linenos">275</span></a>
</span><span id="Pose-276"><a href="#Pose-276"><span class="linenos">276</span></a>    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="n">Float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-277"><a href="#Pose-277"><span class="linenos">277</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
</span><span id="Pose-278"><a href="#Pose-278"><span class="linenos">278</span></a>
</span><span id="Pose-279"><a href="#Pose-279"><span class="linenos">279</span></a>    <span class="k">def</span> <span class="fm">__matmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose-280"><a href="#Pose-280"><span class="linenos">280</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compose with other poses.&quot;&quot;&quot;</span>
</span><span id="Pose-281"><a href="#Pose-281"><span class="linenos">281</span></a>        <span class="c1"># TODO: Add test, in particular to lock in matmul vs mul.</span>
</span><span id="Pose-282"><a href="#Pose-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
</span><span id="Pose-283"><a href="#Pose-283"><span class="linenos">283</span></a>
</span><span id="Pose-284"><a href="#Pose-284"><span class="linenos">284</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose-285"><a href="#Pose-285"><span class="linenos">285</span></a>    <span class="k">def</span> <span class="nf">concatenate_poses</span><span class="p">(</span><span class="n">pose_list</span><span class="p">):</span>
</span><span id="Pose-286"><a href="#Pose-286"><span class="linenos">286</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span>
</span><span id="Pose-287"><a href="#Pose-287"><span class="linenos">287</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">pose</span><span class="o">.</span><span class="n">pos</span> <span class="k">for</span> <span class="n">pose</span> <span class="ow">in</span> <span class="n">pose_list</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="Pose-288"><a href="#Pose-288"><span class="linenos">288</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">pose</span><span class="o">.</span><span class="n">quat</span> <span class="k">for</span> <span class="n">pose</span> <span class="ow">in</span> <span class="n">pose_list</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="Pose-289"><a href="#Pose-289"><span class="linenos">289</span></a>        <span class="p">)</span>
</span><span id="Pose-290"><a href="#Pose-290"><span class="linenos">290</span></a>
</span><span id="Pose-291"><a href="#Pose-291"><span class="linenos">291</span></a>    <span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poses</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Pose-292"><a href="#Pose-292"><span class="linenos">292</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span>
</span><span id="Pose-293"><a href="#Pose-293"><span class="linenos">293</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">poses</span><span class="o">.</span><span class="n">pos</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">),</span>
</span><span id="Pose-294"><a href="#Pose-294"><span class="linenos">294</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">poses</span><span class="o">.</span><span class="n">quat</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">),</span>
</span><span id="Pose-295"><a href="#Pose-295"><span class="linenos">295</span></a>        <span class="p">)</span>
</span><span id="Pose-296"><a href="#Pose-296"><span class="linenos">296</span></a>
</span><span id="Pose-297"><a href="#Pose-297"><span class="linenos">297</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose-298"><a href="#Pose-298"><span class="linenos">298</span></a>    <span class="k">def</span> <span class="nf">stack_poses</span><span class="p">(</span><span class="n">pose_list</span><span class="p">):</span>
</span><span id="Pose-299"><a href="#Pose-299"><span class="linenos">299</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span>
</span><span id="Pose-300"><a href="#Pose-300"><span class="linenos">300</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">pose</span><span class="o">.</span><span class="n">pos</span> <span class="k">for</span> <span class="n">pose</span> <span class="ow">in</span> <span class="n">pose_list</span><span class="p">]),</span>
</span><span id="Pose-301"><a href="#Pose-301"><span class="linenos">301</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">pose</span><span class="o">.</span><span class="n">quat</span> <span class="k">for</span> <span class="n">pose</span> <span class="ow">in</span> <span class="n">pose_list</span><span class="p">]),</span>
</span><span id="Pose-302"><a href="#Pose-302"><span class="linenos">302</span></a>        <span class="p">)</span>
</span><span id="Pose-303"><a href="#Pose-303"><span class="linenos">303</span></a>
</span><span id="Pose-304"><a href="#Pose-304"><span class="linenos">304</span></a>    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span><span id="Pose-305"><a href="#Pose-305"><span class="linenos">305</span></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="Pose-306"><a href="#Pose-306"><span class="linenos">306</span></a>            <span class="n">Pose</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">qs</span><span class="p">)</span>
</span><span id="Pose-307"><a href="#Pose-307"><span class="linenos">307</span></a>            <span class="k">for</span> <span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">qs</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="Pose-308"><a href="#Pose-308"><span class="linenos">308</span></a>                <span class="n">jnp</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="Pose-309"><a href="#Pose-309"><span class="linenos">309</span></a>            <span class="p">)</span>
</span><span id="Pose-310"><a href="#Pose-310"><span class="linenos">310</span></a>        <span class="p">]</span>
</span><span id="Pose-311"><a href="#Pose-311"><span class="linenos">311</span></a>
</span><span id="Pose-312"><a href="#Pose-312"><span class="linenos">312</span></a>    <span class="k">def</span> <span class="nf">inv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-313"><a href="#Pose-313"><span class="linenos">313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Pose-314"><a href="#Pose-314"><span class="linenos">314</span></a><span class="sd">        Inverse of pose.</span>
</span><span id="Pose-315"><a href="#Pose-315"><span class="linenos">315</span></a>
</span><span id="Pose-316"><a href="#Pose-316"><span class="linenos">316</span></a><span class="sd">        Note that for rotation matrix R and</span>
</span><span id="Pose-317"><a href="#Pose-317"><span class="linenos">317</span></a><span class="sd">        translation vector x we have</span>
</span><span id="Pose-318"><a href="#Pose-318"><span class="linenos">318</span></a><span class="sd">        ```</span>
</span><span id="Pose-319"><a href="#Pose-319"><span class="linenos">319</span></a><span class="sd">            [[ R x ]  [[ R&#39; -R&#39;x ]  = [[ I  0 ]</span>
</span><span id="Pose-320"><a href="#Pose-320"><span class="linenos">320</span></a><span class="sd">             [ 0 1 ]]  [ 0    1  ]]      0  1 ]]</span>
</span><span id="Pose-321"><a href="#Pose-321"><span class="linenos">321</span></a><span class="sd">        ```</span>
</span><span id="Pose-322"><a href="#Pose-322"><span class="linenos">322</span></a><span class="sd">        where R&#39; is the transpose of R.</span>
</span><span id="Pose-323"><a href="#Pose-323"><span class="linenos">323</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-324"><a href="#Pose-324"><span class="linenos">324</span></a>        <span class="n">R_inv</span> <span class="o">=</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">)</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="Pose-325"><a href="#Pose-325"><span class="linenos">325</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="o">-</span><span class="n">R_inv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">),</span> <span class="n">R_inv</span><span class="o">.</span><span class="n">as_quat</span><span class="p">())</span>
</span><span id="Pose-326"><a href="#Pose-326"><span class="linenos">326</span></a>
</span><span id="Pose-327"><a href="#Pose-327"><span class="linenos">327</span></a>    <span class="n">inverse</span> <span class="o">=</span> <span class="n">inv</span>
</span><span id="Pose-328"><a href="#Pose-328"><span class="linenos">328</span></a>
</span><span id="Pose-329"><a href="#Pose-329"><span class="linenos">329</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-330"><a href="#Pose-330"><span class="linenos">330</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Pose(position=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span><span class="si">}</span><span class="s2">, quaternion=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="Pose-331"><a href="#Pose-331"><span class="linenos">331</span></a>
</span><span id="Pose-332"><a href="#Pose-332"><span class="linenos">332</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose-333"><a href="#Pose-333"><span class="linenos">333</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</span><span id="Pose-334"><a href="#Pose-334"><span class="linenos">334</span></a>
</span><span id="Pose-335"><a href="#Pose-335"><span class="linenos">335</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose-336"><a href="#Pose-336"><span class="linenos">336</span></a>    <span class="k">def</span> <span class="nf">from_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
</span><span id="Pose-337"><a href="#Pose-337"><span class="linenos">337</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an Pose from a 4x4 matrix.&quot;&quot;&quot;</span>
</span><span id="Pose-338"><a href="#Pose-338"><span class="linenos">338</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">as_quat</span><span class="p">())</span>
</span><span id="Pose-339"><a href="#Pose-339"><span class="linenos">339</span></a>
</span><span id="Pose-340"><a href="#Pose-340"><span class="linenos">340</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose-341"><a href="#Pose-341"><span class="linenos">341</span></a>    <span class="k">def</span> <span class="nf">from_xyzw</span><span class="p">(</span><span class="n">xyzw</span><span class="p">):</span>
</span><span id="Pose-342"><a href="#Pose-342"><span class="linenos">342</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pose from a quaternion. With zero translation.&quot;&quot;&quot;</span>
</span><span id="Pose-343"><a href="#Pose-343"><span class="linenos">343</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="o">*</span><span class="n">xyzw</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">xyzw</span><span class="p">)</span>
</span><span id="Pose-344"><a href="#Pose-344"><span class="linenos">344</span></a>
</span><span id="Pose-345"><a href="#Pose-345"><span class="linenos">345</span></a>    <span class="n">from_quat</span> <span class="o">=</span> <span class="n">from_xyzw</span>
</span><span id="Pose-346"><a href="#Pose-346"><span class="linenos">346</span></a>
</span><span id="Pose-347"><a href="#Pose-347"><span class="linenos">347</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose-348"><a href="#Pose-348"><span class="linenos">348</span></a>    <span class="k">def</span> <span class="nf">from_pos</span><span class="p">(</span><span class="n">position_vec</span><span class="p">):</span>
</span><span id="Pose-349"><a href="#Pose-349"><span class="linenos">349</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pose from a vector. With the identity rotation.&quot;&quot;&quot;</span>
</span><span id="Pose-350"><a href="#Pose-350"><span class="linenos">350</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span>
</span><span id="Pose-351"><a href="#Pose-351"><span class="linenos">351</span></a>            <span class="n">position_vec</span><span class="p">,</span>
</span><span id="Pose-352"><a href="#Pose-352"><span class="linenos">352</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span> <span class="p">(</span><span class="o">*</span><span class="n">position_vec</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)),</span>
</span><span id="Pose-353"><a href="#Pose-353"><span class="linenos">353</span></a>        <span class="p">)</span>
</span><span id="Pose-354"><a href="#Pose-354"><span class="linenos">354</span></a>
</span><span id="Pose-355"><a href="#Pose-355"><span class="linenos">355</span></a>    <span class="n">from_translation</span> <span class="o">=</span> <span class="n">from_pos</span>
</span><span id="Pose-356"><a href="#Pose-356"><span class="linenos">356</span></a>
</span><span id="Pose-357"><a href="#Pose-357"><span class="linenos">357</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose-358"><a href="#Pose-358"><span class="linenos">358</span></a>    <span class="k">def</span> <span class="nf">from_vec</span><span class="p">(</span><span class="n">posxyzw</span><span class="p">):</span>
</span><span id="Pose-359"><a href="#Pose-359"><span class="linenos">359</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Pose-360"><a href="#Pose-360"><span class="linenos">360</span></a><span class="sd">        Creates a Pose from a 7-vector [p_x, p_y, p_z, q_x, q_y, q_z, q_w]</span>
</span><span id="Pose-361"><a href="#Pose-361"><span class="linenos">361</span></a><span class="sd">        where p is the position and q is the quaternion for the rotation.</span>
</span><span id="Pose-362"><a href="#Pose-362"><span class="linenos">362</span></a>
</span><span id="Pose-363"><a href="#Pose-363"><span class="linenos">363</span></a><span class="sd">        Args:</span>
</span><span id="Pose-364"><a href="#Pose-364"><span class="linenos">364</span></a><span class="sd">            posxyzw: Jax array with shape (7,)</span>
</span><span id="Pose-365"><a href="#Pose-365"><span class="linenos">365</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose-366"><a href="#Pose-366"><span class="linenos">366</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">posxyzw</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">posxyzw</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>
</span><span id="Pose-367"><a href="#Pose-367"><span class="linenos">367</span></a>
</span><span id="Pose-368"><a href="#Pose-368"><span class="linenos">368</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose-369"><a href="#Pose-369"><span class="linenos">369</span></a>    <span class="k">def</span> <span class="nf">from_pos_matrix</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">matrix</span><span class="p">):</span>
</span><span id="Pose-370"><a href="#Pose-370"><span class="linenos">370</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an Pose from a position and a 3x3 matrix.&quot;&quot;&quot;</span>
</span><span id="Pose-371"><a href="#Pose-371"><span class="linenos">371</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">as_quat</span><span class="p">())</span>
</span><span id="Pose-372"><a href="#Pose-372"><span class="linenos">372</span></a>
</span><span id="Pose-373"><a href="#Pose-373"><span class="linenos">373</span></a>    <span class="c1"># TODO: Should we keep that on the Pose class?</span>
</span><span id="Pose-374"><a href="#Pose-374"><span class="linenos">374</span></a>    <span class="n">from_position_and_target</span> <span class="o">=</span> <span class="n">camera_from_position_and_target</span>
</span><span id="Pose-375"><a href="#Pose-375"><span class="linenos">375</span></a>
</span><span id="Pose-376"><a href="#Pose-376"><span class="linenos">376</span></a>    <span class="n">sample_uniform_pose</span> <span class="o">=</span> <span class="n">sample_uniform_pose</span>
</span><span id="Pose-377"><a href="#Pose-377"><span class="linenos">377</span></a>    <span class="n">sample_uniform_pose_vmap</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span>
</span><span id="Pose-378"><a href="#Pose-378"><span class="linenos">378</span></a>        <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="n">sample_uniform_pose</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
</span><span id="Pose-379"><a href="#Pose-379"><span class="linenos">379</span></a>    <span class="p">)</span>
</span><span id="Pose-380"><a href="#Pose-380"><span class="linenos">380</span></a>    <span class="n">sample_gaussian_vmf_pose</span> <span class="o">=</span> <span class="n">sample_gaussian_vmf_pose</span>
</span><span id="Pose-381"><a href="#Pose-381"><span class="linenos">381</span></a>    <span class="n">sample_gaussian_vmf_pose_jit</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">sample_gaussian_vmf_pose</span><span class="p">)</span>
</span><span id="Pose-382"><a href="#Pose-382"><span class="linenos">382</span></a>    <span class="n">sample_gaussian_vmf_pose_vmap</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span>
</span><span id="Pose-383"><a href="#Pose-383"><span class="linenos">383</span></a>        <span class="n">sample_gaussian_vmf_pose</span><span class="p">,</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="Pose-384"><a href="#Pose-384"><span class="linenos">384</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Pose class with positions and quaternions representing rotation.</p>
</div>


                            <div id="Pose.__init__" class="classattr">
                                        <input id="Pose.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="name">Pose</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">position</span>, </span><span class="param"><span class="n">quaternion</span></span>)</span>

                <label class="view-source-button" for="Pose.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.__init__-128"><a href="#Pose.__init__-128"><span class="linenos">128</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">quaternion</span><span class="p">):</span>
</span><span id="Pose.__init__-129"><a href="#Pose.__init__-129"><span class="linenos">129</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Pose.__init__-130"><a href="#Pose.__init__-130"><span class="linenos">130</span></a><span class="sd">        3D rigid transformation</span>
</span><span id="Pose.__init__-131"><a href="#Pose.__init__-131"><span class="linenos">131</span></a>
</span><span id="Pose.__init__-132"><a href="#Pose.__init__-132"><span class="linenos">132</span></a><span class="sd">        position: 3D translation vector</span>
</span><span id="Pose.__init__-133"><a href="#Pose.__init__-133"><span class="linenos">133</span></a><span class="sd">        quaternion: 4D quaternion in xyzw</span>
</span><span id="Pose.__init__-134"><a href="#Pose.__init__-134"><span class="linenos">134</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.__init__-135"><a href="#Pose.__init__-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_position</span> <span class="o">=</span> <span class="n">position</span>
</span><span id="Pose.__init__-136"><a href="#Pose.__init__-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_quaternion</span> <span class="o">=</span> <span class="n">quaternion</span>
</span></pre></div>


            <div class="docstring"><p>3D rigid transformation</p>

<p>position: 3D translation vector
quaternion: 4D quaternion in xyzw</p>
</div>


                            </div>
                            <div id="Pose.identity_quaternion" class="classattr">
                                <div class="attr variable">
            <span class="name">identity_quaternion</span>        =
<span class="default_value">Array([0., 0., 0., 1.], dtype=float32)</span>


    </div>
    <a class="headerlink" href="#Pose.identity_quaternion"></a>



                            </div>
                            <div id="Pose.unit_quaternion" class="classattr">
                                        <input id="Pose.unit_quaternion-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">unit_quaternion</span>

                <label class="view-source-button" for="Pose.unit_quaternion-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.unit_quaternion"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.unit_quaternion-140"><a href="#Pose.unit_quaternion-140"><span class="linenos">140</span></a>    <span class="nd">@property</span>
</span><span id="Pose.unit_quaternion-141"><a href="#Pose.unit_quaternion-141"><span class="linenos">141</span></a>    <span class="k">def</span> <span class="nf">unit_quaternion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.unit_quaternion-142"><a href="#Pose.unit_quaternion-142"><span class="linenos">142</span></a>        <span class="k">raise</span> <span class="ne">Warning</span><span class="p">(</span>
</span><span id="Pose.unit_quaternion-143"><a href="#Pose.unit_quaternion-143"><span class="linenos">143</span></a>            <span class="s2">&quot;Use `identity_quaternion` instead, a unit quaternion is any quat with norm 1!&quot;</span>
</span><span id="Pose.unit_quaternion-144"><a href="#Pose.unit_quaternion-144"><span class="linenos">144</span></a>        <span class="p">)</span>
</span><span id="Pose.unit_quaternion-145"><a href="#Pose.unit_quaternion-145"><span class="linenos">145</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">identity_quaternion</span>
</span></pre></div>




                            </div>
                            <div id="Pose.pos" class="classattr">
                                        <input id="Pose.pos-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">pos</span>

                <label class="view-source-button" for="Pose.pos-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.pos"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.pos-147"><a href="#Pose.pos-147"><span class="linenos">147</span></a>    <span class="nd">@property</span>
</span><span id="Pose.pos-148"><a href="#Pose.pos-148"><span class="linenos">148</span></a>    <span class="k">def</span> <span class="nf">pos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.pos-149"><a href="#Pose.pos-149"><span class="linenos">149</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span>
</span></pre></div>




                            </div>
                            <div id="Pose.position" class="classattr">
                                        <input id="Pose.position-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">position</span>

                <label class="view-source-button" for="Pose.position-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.position"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.position-147"><a href="#Pose.position-147"><span class="linenos">147</span></a>    <span class="nd">@property</span>
</span><span id="Pose.position-148"><a href="#Pose.position-148"><span class="linenos">148</span></a>    <span class="k">def</span> <span class="nf">pos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.position-149"><a href="#Pose.position-149"><span class="linenos">149</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_position</span>
</span></pre></div>




                            </div>
                            <div id="Pose.xyzw" class="classattr">
                                        <input id="Pose.xyzw-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">xyzw</span>

                <label class="view-source-button" for="Pose.xyzw-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.xyzw"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.xyzw-153"><a href="#Pose.xyzw-153"><span class="linenos">153</span></a>    <span class="nd">@property</span>
</span><span id="Pose.xyzw-154"><a href="#Pose.xyzw-154"><span class="linenos">154</span></a>    <span class="k">def</span> <span class="nf">xyzw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.xyzw-155"><a href="#Pose.xyzw-155"><span class="linenos">155</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quaternion</span>
</span></pre></div>




                            </div>
                            <div id="Pose.quat" class="classattr">
                                        <input id="Pose.quat-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">quat</span>

                <label class="view-source-button" for="Pose.quat-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.quat"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.quat-153"><a href="#Pose.quat-153"><span class="linenos">153</span></a>    <span class="nd">@property</span>
</span><span id="Pose.quat-154"><a href="#Pose.quat-154"><span class="linenos">154</span></a>    <span class="k">def</span> <span class="nf">xyzw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.quat-155"><a href="#Pose.quat-155"><span class="linenos">155</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quaternion</span>
</span></pre></div>




                            </div>
                            <div id="Pose.quaternion" class="classattr">
                                        <input id="Pose.quaternion-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">quaternion</span>

                <label class="view-source-button" for="Pose.quaternion-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.quaternion"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.quaternion-153"><a href="#Pose.quaternion-153"><span class="linenos">153</span></a>    <span class="nd">@property</span>
</span><span id="Pose.quaternion-154"><a href="#Pose.quaternion-154"><span class="linenos">154</span></a>    <span class="k">def</span> <span class="nf">xyzw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.quaternion-155"><a href="#Pose.quaternion-155"><span class="linenos">155</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quaternion</span>
</span></pre></div>




                            </div>
                            <div id="Pose.wxyz" class="classattr">
                                        <input id="Pose.wxyz-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">wxyz</span>

                <label class="view-source-button" for="Pose.wxyz-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.wxyz"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.wxyz-160"><a href="#Pose.wxyz-160"><span class="linenos">160</span></a>    <span class="nd">@property</span>
</span><span id="Pose.wxyz-161"><a href="#Pose.wxyz-161"><span class="linenos">161</span></a>    <span class="k">def</span> <span class="nf">wxyz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.wxyz-162"><a href="#Pose.wxyz-162"><span class="linenos">162</span></a>        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="Pose.wxyz-163"><a href="#Pose.wxyz-163"><span class="linenos">163</span></a>            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">quaternion</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">quaternion</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span>
</span><span id="Pose.wxyz-164"><a href="#Pose.wxyz-164"><span class="linenos">164</span></a>        <span class="p">)</span>
</span></pre></div>




                            </div>
                            <div id="Pose.rot" class="classattr">
                                        <input id="Pose.rot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">rot</span>

                <label class="view-source-button" for="Pose.rot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.rot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.rot-166"><a href="#Pose.rot-166"><span class="linenos">166</span></a>    <span class="nd">@property</span>
</span><span id="Pose.rot-167"><a href="#Pose.rot-167"><span class="linenos">167</span></a>    <span class="k">def</span> <span class="nf">rot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.rot-168"><a href="#Pose.rot-168"><span class="linenos">168</span></a>        <span class="k">return</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">)</span>
</span></pre></div>




                            </div>
                            <div id="Pose.normalize" class="classattr">
                                        <input id="Pose.normalize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">normalize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.normalize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.normalize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.normalize-170"><a href="#Pose.normalize-170"><span class="linenos">170</span></a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.normalize-171"><a href="#Pose.normalize-171"><span class="linenos">171</span></a>        <span class="n">quat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Pose.normalize-172"><a href="#Pose.normalize-172"><span class="linenos">172</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">quat</span><span class="p">)</span>
</span></pre></div>




                            </div>
                            <div id="Pose.quat_in_upper_hemisphere" class="classattr">
                                        <input id="Pose.quat_in_upper_hemisphere-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">quat_in_upper_hemisphere</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.quat_in_upper_hemisphere-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.quat_in_upper_hemisphere"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.quat_in_upper_hemisphere-174"><a href="#Pose.quat_in_upper_hemisphere-174"><span class="linenos">174</span></a>    <span class="k">def</span> <span class="nf">quat_in_upper_hemisphere</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.quat_in_upper_hemisphere-175"><a href="#Pose.quat_in_upper_hemisphere-175"><span class="linenos">175</span></a>        <span class="n">quat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Pose.quat_in_upper_hemisphere-176"><a href="#Pose.quat_in_upper_hemisphere-176"><span class="linenos">176</span></a>        <span class="n">quat</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">quat</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]])</span> <span class="o">*</span> <span class="n">quat</span>
</span><span id="Pose.quat_in_upper_hemisphere-177"><a href="#Pose.quat_in_upper_hemisphere-177"><span class="linenos">177</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">quat</span><span class="p">)</span>
</span></pre></div>




                            </div>
                            <div id="Pose.canonical" class="classattr">
                                        <input id="Pose.canonical-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">canonical</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.canonical-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.canonical"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.canonical-179"><a href="#Pose.canonical-179"><span class="linenos">179</span></a>    <span class="k">def</span> <span class="nf">canonical</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.canonical-180"><a href="#Pose.canonical-180"><span class="linenos">180</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Pose.canonical-181"><a href="#Pose.canonical-181"><span class="linenos">181</span></a><span class="sd">        Chooses a canonical representative for the quaternion of the pose, i.e.</span>
</span><span id="Pose.canonical-182"><a href="#Pose.canonical-182"><span class="linenos">182</span></a><span class="sd">        chooses from {q, -q} s.t. q[3] &gt;= 0. Note that if q[3]==0 there is still ambiguity.</span>
</span><span id="Pose.canonical-183"><a href="#Pose.canonical-183"><span class="linenos">183</span></a>
</span><span id="Pose.canonical-184"><a href="#Pose.canonical-184"><span class="linenos">184</span></a><span class="sd">        Recall that SO(3) is isomorphic to  S^3/x~-x and</span>
</span><span id="Pose.canonical-185"><a href="#Pose.canonical-185"><span class="linenos">185</span></a><span class="sd">        also to D^3/~ where x~-x for x in S^2 = \\partial D^3.</span>
</span><span id="Pose.canonical-186"><a href="#Pose.canonical-186"><span class="linenos">186</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.canonical-187"><a href="#Pose.canonical-187"><span class="linenos">187</span></a>        <span class="n">quat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Pose.canonical-188"><a href="#Pose.canonical-188"><span class="linenos">188</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">choose_good_quat</span><span class="p">(</span><span class="n">quat</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Chooses a canonical representative for the quaternion of the pose, i.e.
chooses from {q, -q} s.t. q[3] &gt;= 0. Note that if q[3]==0 there is still ambiguity.</p>

<p>Recall that SO(3) is isomorphic to  S^3/x~-x and
also to D^3/~ where x~-x for x in S^2 = \partial D^3.</p>
</div>


                            </div>
                            <div id="Pose.flatten" class="classattr">
                                        <input id="Pose.flatten-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">flatten</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.flatten-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.flatten"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.flatten-190"><a href="#Pose.flatten-190"><span class="linenos">190</span></a>    <span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.flatten-191"><a href="#Pose.flatten-191"><span class="linenos">191</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span>
</span></pre></div>




                            </div>
                            <div id="Pose.tree_flatten" class="classattr">
                                        <input id="Pose.tree_flatten-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">tree_flatten</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.tree_flatten-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.tree_flatten"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.tree_flatten-193"><a href="#Pose.tree_flatten-193"><span class="linenos">193</span></a>    <span class="k">def</span> <span class="nf">tree_flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.tree_flatten-194"><a href="#Pose.tree_flatten-194"><span class="linenos">194</span></a>        <span class="k">return</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">),</span> <span class="kc">None</span><span class="p">)</span>
</span></pre></div>




                            </div>
                            <div id="Pose.tree_unflatten" class="classattr">
                                        <input id="Pose.tree_unflatten-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">tree_unflatten</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">aux_data</span>, </span><span class="param"><span class="n">children</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.tree_unflatten-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.tree_unflatten"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.tree_unflatten-196"><a href="#Pose.tree_unflatten-196"><span class="linenos">196</span></a>    <span class="nd">@classmethod</span>
</span><span id="Pose.tree_unflatten-197"><a href="#Pose.tree_unflatten-197"><span class="linenos">197</span></a>    <span class="k">def</span> <span class="nf">tree_unflatten</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span> <span class="n">children</span><span class="p">):</span>
</span><span id="Pose.tree_unflatten-198"><a href="#Pose.tree_unflatten-198"><span class="linenos">198</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">*</span><span class="n">children</span><span class="p">)</span>
</span></pre></div>




                            </div>
                            <div id="Pose.copy" class="classattr">
                                        <input id="Pose.copy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">copy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.copy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.copy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.copy-200"><a href="#Pose.copy-200"><span class="linenos">200</span></a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.copy-201"><a href="#Pose.copy-201"><span class="linenos">201</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">))</span>
</span></pre></div>




                            </div>
                            <div id="Pose.flat" class="classattr">
                                        <input id="Pose.flat-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">flat</span>

                <label class="view-source-button" for="Pose.flat-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.flat"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.flat-203"><a href="#Pose.flat-203"><span class="linenos">203</span></a>    <span class="nd">@property</span>
</span><span id="Pose.flat-204"><a href="#Pose.flat-204"><span class="linenos">204</span></a>    <span class="k">def</span> <span class="nf">flat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.flat-205"><a href="#Pose.flat-205"><span class="linenos">205</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span></pre></div>




                            </div>
                            <div id="Pose.shape" class="classattr">
                                        <input id="Pose.shape-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">shape</span>

                <label class="view-source-button" for="Pose.shape-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.shape"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.shape-207"><a href="#Pose.shape-207"><span class="linenos">207</span></a>    <span class="nd">@property</span>
</span><span id="Pose.shape-208"><a href="#Pose.shape-208"><span class="linenos">208</span></a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.shape-209"><a href="#Pose.shape-209"><span class="linenos">209</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>




                            </div>
                            <div id="Pose.reshape" class="classattr">
                                        <input id="Pose.reshape-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">reshape</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.reshape-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.reshape"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.reshape-211"><a href="#Pose.reshape-211"><span class="linenos">211</span></a>    <span class="k">def</span> <span class="nf">reshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
</span><span id="Pose.reshape-212"><a href="#Pose.reshape-212"><span class="linenos">212</span></a>        <span class="n">shape</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">leaves</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</span><span id="Pose.reshape-213"><a href="#Pose.reshape-213"><span class="linenos">213</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span> <span class="o">+</span> <span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span> <span class="o">+</span> <span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
</span></pre></div>




                            </div>
                            <div id="Pose.slice" class="classattr">
                                        <input id="Pose.slice-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">slice</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">i</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.slice-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.slice"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.slice-231"><a href="#Pose.slice-231"><span class="linenos">231</span></a>    <span class="k">def</span> <span class="nf">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
</span><span id="Pose.slice-232"><a href="#Pose.slice-232"><span class="linenos">232</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span></pre></div>




                            </div>
                            <div id="Pose.as_matrix" class="classattr">
                                        <input id="Pose.as_matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">as_matrix</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.as_matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.as_matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.as_matrix-234"><a href="#Pose.as_matrix-234"><span class="linenos">234</span></a>    <span class="k">def</span> <span class="nf">as_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.as_matrix-235"><a href="#Pose.as_matrix-235"><span class="linenos">235</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a 4x4 pose matrix.&quot;&quot;&quot;</span>
</span><span id="Pose.as_matrix-236"><a href="#Pose.as_matrix-236"><span class="linenos">236</span></a>        <span class="n">pose_matrix</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="Pose.as_matrix-237"><a href="#Pose.as_matrix-237"><span class="linenos">237</span></a>        <span class="n">pose_matrix</span> <span class="o">=</span> <span class="n">pose_matrix</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
</span><span id="Pose.as_matrix-238"><a href="#Pose.as_matrix-238"><span class="linenos">238</span></a>            <span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">)</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
</span><span id="Pose.as_matrix-239"><a href="#Pose.as_matrix-239"><span class="linenos">239</span></a>        <span class="p">)</span>
</span><span id="Pose.as_matrix-240"><a href="#Pose.as_matrix-240"><span class="linenos">240</span></a>        <span class="n">pose_matrix</span> <span class="o">=</span> <span class="n">pose_matrix</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">)</span>
</span><span id="Pose.as_matrix-241"><a href="#Pose.as_matrix-241"><span class="linenos">241</span></a>        <span class="n">pose_matrix</span> <span class="o">=</span> <span class="n">pose_matrix</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="Pose.as_matrix-242"><a href="#Pose.as_matrix-242"><span class="linenos">242</span></a>        <span class="k">return</span> <span class="n">pose_matrix</span>
</span></pre></div>


            <div class="docstring"><p>Return a 4x4 pose matrix.</p>
</div>


                            </div>
                            <div id="Pose.identity" class="classattr">
                                        <input id="Pose.identity-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">identity</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.identity-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.identity"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.identity-244"><a href="#Pose.identity-244"><span class="linenos">244</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose.identity-245"><a href="#Pose.identity-245"><span class="linenos">245</span></a>    <span class="k">def</span> <span class="nf">identity</span><span class="p">():</span>
</span><span id="Pose.identity-246"><a href="#Pose.identity-246"><span class="linenos">246</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the identity transformation.&quot;&quot;&quot;</span>
</span><span id="Pose.identity-247"><a href="#Pose.identity-247"><span class="linenos">247</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span>
</span></pre></div>


            <div class="docstring"><p>Return the identity transformation.</p>
</div>


                            </div>
                            <div id="Pose.eye" class="classattr">
                                        <input id="Pose.eye-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">eye</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.eye-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.eye"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.eye-244"><a href="#Pose.eye-244"><span class="linenos">244</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose.eye-245"><a href="#Pose.eye-245"><span class="linenos">245</span></a>    <span class="k">def</span> <span class="nf">identity</span><span class="p">():</span>
</span><span id="Pose.eye-246"><a href="#Pose.eye-246"><span class="linenos">246</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the identity transformation.&quot;&quot;&quot;</span>
</span><span id="Pose.eye-247"><a href="#Pose.eye-247"><span class="linenos">247</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span>
</span></pre></div>


            <div class="docstring"><p>Return the identity transformation.</p>
</div>


                            </div>
                            <div id="Pose.id" class="classattr">
                                        <input id="Pose.id-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">id</span><span class="signature pdoc-code condensed">(<span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.id-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.id"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.id-244"><a href="#Pose.id-244"><span class="linenos">244</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose.id-245"><a href="#Pose.id-245"><span class="linenos">245</span></a>    <span class="k">def</span> <span class="nf">identity</span><span class="p">():</span>
</span><span id="Pose.id-246"><a href="#Pose.id-246"><span class="linenos">246</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the identity transformation.&quot;&quot;&quot;</span>
</span><span id="Pose.id-247"><a href="#Pose.id-247"><span class="linenos">247</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]))</span>
</span></pre></div>


            <div class="docstring"><p>Return the identity transformation.</p>
</div>


                            </div>
                            <div id="Pose.apply" class="classattr">
                                        <input id="Pose.apply-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">apply</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">vec</span><span class="p">:</span> <span class="n"><a href="#Array">Array</a></span></span><span class="return-annotation">) -> <span class="n"><a href="#Array">Array</a></span>:</span></span>

                <label class="view-source-button" for="Pose.apply-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.apply"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.apply-252"><a href="#Pose.apply-252"><span class="linenos">252</span></a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vec</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
</span><span id="Pose.apply-253"><a href="#Pose.apply-253"><span class="linenos">253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply pose to vectors.&quot;&quot;&quot;</span>
</span><span id="Pose.apply-254"><a href="#Pose.apply-254"><span class="linenos">254</span></a>        <span class="k">return</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
</span></pre></div>


            <div class="docstring"><p>Apply pose to vectors.</p>
</div>


                            </div>
                            <div id="Pose.compose" class="classattr">
                                        <input id="Pose.compose-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">compose</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">pose</span><span class="p">:</span> <span class="n"><a href="#Pose">Pose</a></span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.compose-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.compose"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.compose-260"><a href="#Pose.compose-260"><span class="linenos">260</span></a>    <span class="k">def</span> <span class="nf">compose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pose</span><span class="p">:</span> <span class="s2">&quot;Pose&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.compose-261"><a href="#Pose.compose-261"><span class="linenos">261</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Compose with other pose.&quot;&quot;&quot;</span>
</span><span id="Pose.compose-262"><a href="#Pose.compose-262"><span class="linenos">262</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pose</span><span class="o">.</span><span class="n">pos</span><span class="p">),</span> <span class="n">multiply_quats</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">,</span> <span class="n">pose</span><span class="o">.</span><span class="n">xyzw</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Compose with other pose.</p>
</div>


                            </div>
                            <div id="Pose.scale" class="classattr">
                                        <input id="Pose.scale-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">scale</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">scale</span><span class="p">:</span> <span class="n"><a href="#Array">Array</a></span></span><span class="return-annotation">) -> <span class="n"><a href="#Pose">Pose</a></span>:</span></span>

                <label class="view-source-button" for="Pose.scale-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.scale"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.scale-272"><a href="#Pose.scale-272"><span class="linenos">272</span></a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="n">Float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Pose&quot;</span><span class="p">:</span>
</span><span id="Pose.scale-273"><a href="#Pose.scale-273"><span class="linenos">273</span></a>        <span class="c1"># NOTE: this is useful for gradient updates.</span>
</span><span id="Pose.scale-274"><a href="#Pose.scale-274"><span class="linenos">274</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">*</span> <span class="n">scale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quat</span> <span class="o">*</span> <span class="n">scale</span><span class="p">)</span>
</span></pre></div>




                            </div>
                            <div id="Pose.concatenate_poses" class="classattr">
                                        <input id="Pose.concatenate_poses-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">concatenate_poses</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pose_list</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.concatenate_poses-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.concatenate_poses"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.concatenate_poses-284"><a href="#Pose.concatenate_poses-284"><span class="linenos">284</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose.concatenate_poses-285"><a href="#Pose.concatenate_poses-285"><span class="linenos">285</span></a>    <span class="k">def</span> <span class="nf">concatenate_poses</span><span class="p">(</span><span class="n">pose_list</span><span class="p">):</span>
</span><span id="Pose.concatenate_poses-286"><a href="#Pose.concatenate_poses-286"><span class="linenos">286</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span>
</span><span id="Pose.concatenate_poses-287"><a href="#Pose.concatenate_poses-287"><span class="linenos">287</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">pose</span><span class="o">.</span><span class="n">pos</span> <span class="k">for</span> <span class="n">pose</span> <span class="ow">in</span> <span class="n">pose_list</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="Pose.concatenate_poses-288"><a href="#Pose.concatenate_poses-288"><span class="linenos">288</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">pose</span><span class="o">.</span><span class="n">quat</span> <span class="k">for</span> <span class="n">pose</span> <span class="ow">in</span> <span class="n">pose_list</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
</span><span id="Pose.concatenate_poses-289"><a href="#Pose.concatenate_poses-289"><span class="linenos">289</span></a>        <span class="p">)</span>
</span></pre></div>




                            </div>
                            <div id="Pose.concat" class="classattr">
                                        <input id="Pose.concat-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">concat</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">poses</span>, </span><span class="param"><span class="n">axis</span><span class="o">=</span><span class="mi">0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.concat-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.concat"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.concat-291"><a href="#Pose.concat-291"><span class="linenos">291</span></a>    <span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">poses</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="Pose.concat-292"><a href="#Pose.concat-292"><span class="linenos">292</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span>
</span><span id="Pose.concat-293"><a href="#Pose.concat-293"><span class="linenos">293</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">poses</span><span class="o">.</span><span class="n">pos</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">),</span>
</span><span id="Pose.concat-294"><a href="#Pose.concat-294"><span class="linenos">294</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">poses</span><span class="o">.</span><span class="n">quat</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">),</span>
</span><span id="Pose.concat-295"><a href="#Pose.concat-295"><span class="linenos">295</span></a>        <span class="p">)</span>
</span></pre></div>




                            </div>
                            <div id="Pose.stack_poses" class="classattr">
                                        <input id="Pose.stack_poses-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">stack_poses</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pose_list</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.stack_poses-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.stack_poses"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.stack_poses-297"><a href="#Pose.stack_poses-297"><span class="linenos">297</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose.stack_poses-298"><a href="#Pose.stack_poses-298"><span class="linenos">298</span></a>    <span class="k">def</span> <span class="nf">stack_poses</span><span class="p">(</span><span class="n">pose_list</span><span class="p">):</span>
</span><span id="Pose.stack_poses-299"><a href="#Pose.stack_poses-299"><span class="linenos">299</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span>
</span><span id="Pose.stack_poses-300"><a href="#Pose.stack_poses-300"><span class="linenos">300</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">pose</span><span class="o">.</span><span class="n">pos</span> <span class="k">for</span> <span class="n">pose</span> <span class="ow">in</span> <span class="n">pose_list</span><span class="p">]),</span>
</span><span id="Pose.stack_poses-301"><a href="#Pose.stack_poses-301"><span class="linenos">301</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">pose</span><span class="o">.</span><span class="n">quat</span> <span class="k">for</span> <span class="n">pose</span> <span class="ow">in</span> <span class="n">pose_list</span><span class="p">]),</span>
</span><span id="Pose.stack_poses-302"><a href="#Pose.stack_poses-302"><span class="linenos">302</span></a>        <span class="p">)</span>
</span></pre></div>




                            </div>
                            <div id="Pose.split" class="classattr">
                                        <input id="Pose.split-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">split</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">n</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.split-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.split"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.split-304"><a href="#Pose.split-304"><span class="linenos">304</span></a>    <span class="k">def</span> <span class="nf">split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span><span id="Pose.split-305"><a href="#Pose.split-305"><span class="linenos">305</span></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="Pose.split-306"><a href="#Pose.split-306"><span class="linenos">306</span></a>            <span class="n">Pose</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">qs</span><span class="p">)</span>
</span><span id="Pose.split-307"><a href="#Pose.split-307"><span class="linenos">307</span></a>            <span class="k">for</span> <span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">qs</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
</span><span id="Pose.split-308"><a href="#Pose.split-308"><span class="linenos">308</span></a>                <span class="n">jnp</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="Pose.split-309"><a href="#Pose.split-309"><span class="linenos">309</span></a>            <span class="p">)</span>
</span><span id="Pose.split-310"><a href="#Pose.split-310"><span class="linenos">310</span></a>        <span class="p">]</span>
</span></pre></div>




                            </div>
                            <div id="Pose.inv" class="classattr">
                                        <input id="Pose.inv-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">inv</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.inv-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.inv"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.inv-312"><a href="#Pose.inv-312"><span class="linenos">312</span></a>    <span class="k">def</span> <span class="nf">inv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.inv-313"><a href="#Pose.inv-313"><span class="linenos">313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Pose.inv-314"><a href="#Pose.inv-314"><span class="linenos">314</span></a><span class="sd">        Inverse of pose.</span>
</span><span id="Pose.inv-315"><a href="#Pose.inv-315"><span class="linenos">315</span></a>
</span><span id="Pose.inv-316"><a href="#Pose.inv-316"><span class="linenos">316</span></a><span class="sd">        Note that for rotation matrix R and</span>
</span><span id="Pose.inv-317"><a href="#Pose.inv-317"><span class="linenos">317</span></a><span class="sd">        translation vector x we have</span>
</span><span id="Pose.inv-318"><a href="#Pose.inv-318"><span class="linenos">318</span></a><span class="sd">        ```</span>
</span><span id="Pose.inv-319"><a href="#Pose.inv-319"><span class="linenos">319</span></a><span class="sd">            [[ R x ]  [[ R&#39; -R&#39;x ]  = [[ I  0 ]</span>
</span><span id="Pose.inv-320"><a href="#Pose.inv-320"><span class="linenos">320</span></a><span class="sd">             [ 0 1 ]]  [ 0    1  ]]      0  1 ]]</span>
</span><span id="Pose.inv-321"><a href="#Pose.inv-321"><span class="linenos">321</span></a><span class="sd">        ```</span>
</span><span id="Pose.inv-322"><a href="#Pose.inv-322"><span class="linenos">322</span></a><span class="sd">        where R&#39; is the transpose of R.</span>
</span><span id="Pose.inv-323"><a href="#Pose.inv-323"><span class="linenos">323</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.inv-324"><a href="#Pose.inv-324"><span class="linenos">324</span></a>        <span class="n">R_inv</span> <span class="o">=</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">)</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="Pose.inv-325"><a href="#Pose.inv-325"><span class="linenos">325</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="o">-</span><span class="n">R_inv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">),</span> <span class="n">R_inv</span><span class="o">.</span><span class="n">as_quat</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Inverse of pose.</p>

<p>Note that for rotation matrix R and
translation vector x we have</p>

<pre><code>    [[ R x ]  [[ R' -R'x ]  = [[ I  0 ]
     [ 0 1 ]]  [ 0    1  ]]      0  1 ]]
</code></pre>

<p>where R' is the transpose of R.</p>
</div>


                            </div>
                            <div id="Pose.inverse" class="classattr">
                                        <input id="Pose.inverse-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">inverse</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.inverse-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.inverse"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.inverse-312"><a href="#Pose.inverse-312"><span class="linenos">312</span></a>    <span class="k">def</span> <span class="nf">inv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Pose.inverse-313"><a href="#Pose.inverse-313"><span class="linenos">313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Pose.inverse-314"><a href="#Pose.inverse-314"><span class="linenos">314</span></a><span class="sd">        Inverse of pose.</span>
</span><span id="Pose.inverse-315"><a href="#Pose.inverse-315"><span class="linenos">315</span></a>
</span><span id="Pose.inverse-316"><a href="#Pose.inverse-316"><span class="linenos">316</span></a><span class="sd">        Note that for rotation matrix R and</span>
</span><span id="Pose.inverse-317"><a href="#Pose.inverse-317"><span class="linenos">317</span></a><span class="sd">        translation vector x we have</span>
</span><span id="Pose.inverse-318"><a href="#Pose.inverse-318"><span class="linenos">318</span></a><span class="sd">        ```</span>
</span><span id="Pose.inverse-319"><a href="#Pose.inverse-319"><span class="linenos">319</span></a><span class="sd">            [[ R x ]  [[ R&#39; -R&#39;x ]  = [[ I  0 ]</span>
</span><span id="Pose.inverse-320"><a href="#Pose.inverse-320"><span class="linenos">320</span></a><span class="sd">             [ 0 1 ]]  [ 0    1  ]]      0  1 ]]</span>
</span><span id="Pose.inverse-321"><a href="#Pose.inverse-321"><span class="linenos">321</span></a><span class="sd">        ```</span>
</span><span id="Pose.inverse-322"><a href="#Pose.inverse-322"><span class="linenos">322</span></a><span class="sd">        where R&#39; is the transpose of R.</span>
</span><span id="Pose.inverse-323"><a href="#Pose.inverse-323"><span class="linenos">323</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.inverse-324"><a href="#Pose.inverse-324"><span class="linenos">324</span></a>        <span class="n">R_inv</span> <span class="o">=</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xyzw</span><span class="p">)</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="Pose.inverse-325"><a href="#Pose.inverse-325"><span class="linenos">325</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="o">-</span><span class="n">R_inv</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos</span><span class="p">),</span> <span class="n">R_inv</span><span class="o">.</span><span class="n">as_quat</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Inverse of pose.</p>

<p>Note that for rotation matrix R and
translation vector x we have</p>

<pre><code>    [[ R x ]  [[ R' -R'x ]  = [[ I  0 ]
     [ 0 1 ]]  [ 0    1  ]]      0  1 ]]
</code></pre>

<p>where R' is the transpose of R.</p>
</div>


                            </div>
                            <div id="Pose.from_matrix" class="classattr">
                                        <input id="Pose.from_matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">from_matrix</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">matrix</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.from_matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.from_matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.from_matrix-335"><a href="#Pose.from_matrix-335"><span class="linenos">335</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose.from_matrix-336"><a href="#Pose.from_matrix-336"><span class="linenos">336</span></a>    <span class="k">def</span> <span class="nf">from_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
</span><span id="Pose.from_matrix-337"><a href="#Pose.from_matrix-337"><span class="linenos">337</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an Pose from a 4x4 matrix.&quot;&quot;&quot;</span>
</span><span id="Pose.from_matrix-338"><a href="#Pose.from_matrix-338"><span class="linenos">338</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">as_quat</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Create an Pose from a 4x4 matrix.</p>
</div>


                            </div>
                            <div id="Pose.from_xyzw" class="classattr">
                                        <input id="Pose.from_xyzw-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">from_xyzw</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">xyzw</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.from_xyzw-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.from_xyzw"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.from_xyzw-340"><a href="#Pose.from_xyzw-340"><span class="linenos">340</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose.from_xyzw-341"><a href="#Pose.from_xyzw-341"><span class="linenos">341</span></a>    <span class="k">def</span> <span class="nf">from_xyzw</span><span class="p">(</span><span class="n">xyzw</span><span class="p">):</span>
</span><span id="Pose.from_xyzw-342"><a href="#Pose.from_xyzw-342"><span class="linenos">342</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pose from a quaternion. With zero translation.&quot;&quot;&quot;</span>
</span><span id="Pose.from_xyzw-343"><a href="#Pose.from_xyzw-343"><span class="linenos">343</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="o">*</span><span class="n">xyzw</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">xyzw</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a pose from a quaternion. With zero translation.</p>
</div>


                            </div>
                            <div id="Pose.from_quat" class="classattr">
                                        <input id="Pose.from_quat-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">from_quat</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">xyzw</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.from_quat-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.from_quat"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.from_quat-340"><a href="#Pose.from_quat-340"><span class="linenos">340</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose.from_quat-341"><a href="#Pose.from_quat-341"><span class="linenos">341</span></a>    <span class="k">def</span> <span class="nf">from_xyzw</span><span class="p">(</span><span class="n">xyzw</span><span class="p">):</span>
</span><span id="Pose.from_quat-342"><a href="#Pose.from_quat-342"><span class="linenos">342</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pose from a quaternion. With zero translation.&quot;&quot;&quot;</span>
</span><span id="Pose.from_quat-343"><a href="#Pose.from_quat-343"><span class="linenos">343</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="o">*</span><span class="n">xyzw</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">xyzw</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a pose from a quaternion. With zero translation.</p>
</div>


                            </div>
                            <div id="Pose.from_pos" class="classattr">
                                        <input id="Pose.from_pos-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">from_pos</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">position_vec</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.from_pos-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.from_pos"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.from_pos-347"><a href="#Pose.from_pos-347"><span class="linenos">347</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose.from_pos-348"><a href="#Pose.from_pos-348"><span class="linenos">348</span></a>    <span class="k">def</span> <span class="nf">from_pos</span><span class="p">(</span><span class="n">position_vec</span><span class="p">):</span>
</span><span id="Pose.from_pos-349"><a href="#Pose.from_pos-349"><span class="linenos">349</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pose from a vector. With the identity rotation.&quot;&quot;&quot;</span>
</span><span id="Pose.from_pos-350"><a href="#Pose.from_pos-350"><span class="linenos">350</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span>
</span><span id="Pose.from_pos-351"><a href="#Pose.from_pos-351"><span class="linenos">351</span></a>            <span class="n">position_vec</span><span class="p">,</span>
</span><span id="Pose.from_pos-352"><a href="#Pose.from_pos-352"><span class="linenos">352</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span> <span class="p">(</span><span class="o">*</span><span class="n">position_vec</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)),</span>
</span><span id="Pose.from_pos-353"><a href="#Pose.from_pos-353"><span class="linenos">353</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a pose from a vector. With the identity rotation.</p>
</div>


                            </div>
                            <div id="Pose.from_translation" class="classattr">
                                        <input id="Pose.from_translation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">from_translation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">position_vec</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.from_translation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.from_translation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.from_translation-347"><a href="#Pose.from_translation-347"><span class="linenos">347</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose.from_translation-348"><a href="#Pose.from_translation-348"><span class="linenos">348</span></a>    <span class="k">def</span> <span class="nf">from_pos</span><span class="p">(</span><span class="n">position_vec</span><span class="p">):</span>
</span><span id="Pose.from_translation-349"><a href="#Pose.from_translation-349"><span class="linenos">349</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a pose from a vector. With the identity rotation.&quot;&quot;&quot;</span>
</span><span id="Pose.from_translation-350"><a href="#Pose.from_translation-350"><span class="linenos">350</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span>
</span><span id="Pose.from_translation-351"><a href="#Pose.from_translation-351"><span class="linenos">351</span></a>            <span class="n">position_vec</span><span class="p">,</span>
</span><span id="Pose.from_translation-352"><a href="#Pose.from_translation-352"><span class="linenos">352</span></a>            <span class="n">jnp</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span> <span class="p">(</span><span class="o">*</span><span class="n">position_vec</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)),</span>
</span><span id="Pose.from_translation-353"><a href="#Pose.from_translation-353"><span class="linenos">353</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Create a pose from a vector. With the identity rotation.</p>
</div>


                            </div>
                            <div id="Pose.from_vec" class="classattr">
                                        <input id="Pose.from_vec-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">from_vec</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">posxyzw</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.from_vec-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.from_vec"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.from_vec-357"><a href="#Pose.from_vec-357"><span class="linenos">357</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose.from_vec-358"><a href="#Pose.from_vec-358"><span class="linenos">358</span></a>    <span class="k">def</span> <span class="nf">from_vec</span><span class="p">(</span><span class="n">posxyzw</span><span class="p">):</span>
</span><span id="Pose.from_vec-359"><a href="#Pose.from_vec-359"><span class="linenos">359</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Pose.from_vec-360"><a href="#Pose.from_vec-360"><span class="linenos">360</span></a><span class="sd">        Creates a Pose from a 7-vector [p_x, p_y, p_z, q_x, q_y, q_z, q_w]</span>
</span><span id="Pose.from_vec-361"><a href="#Pose.from_vec-361"><span class="linenos">361</span></a><span class="sd">        where p is the position and q is the quaternion for the rotation.</span>
</span><span id="Pose.from_vec-362"><a href="#Pose.from_vec-362"><span class="linenos">362</span></a>
</span><span id="Pose.from_vec-363"><a href="#Pose.from_vec-363"><span class="linenos">363</span></a><span class="sd">        Args:</span>
</span><span id="Pose.from_vec-364"><a href="#Pose.from_vec-364"><span class="linenos">364</span></a><span class="sd">            posxyzw: Jax array with shape (7,)</span>
</span><span id="Pose.from_vec-365"><a href="#Pose.from_vec-365"><span class="linenos">365</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Pose.from_vec-366"><a href="#Pose.from_vec-366"><span class="linenos">366</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">posxyzw</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">posxyzw</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>
</span></pre></div>


            <div class="docstring"><p>Creates a Pose from a 7-vector [p_x, p_y, p_z, q_x, q_y, q_z, q_w]
where p is the position and q is the quaternion for the rotation.</p>

<p>Args:
    posxyzw: Jax array with shape (7,)</p>
</div>


                            </div>
                            <div id="Pose.from_pos_matrix" class="classattr">
                                        <input id="Pose.from_pos_matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">from_pos_matrix</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">pos</span>, </span><span class="param"><span class="n">matrix</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.from_pos_matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.from_pos_matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.from_pos_matrix-368"><a href="#Pose.from_pos_matrix-368"><span class="linenos">368</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Pose.from_pos_matrix-369"><a href="#Pose.from_pos_matrix-369"><span class="linenos">369</span></a>    <span class="k">def</span> <span class="nf">from_pos_matrix</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">matrix</span><span class="p">):</span>
</span><span id="Pose.from_pos_matrix-370"><a href="#Pose.from_pos_matrix-370"><span class="linenos">370</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an Pose from a position and a 3x3 matrix.&quot;&quot;&quot;</span>
</span><span id="Pose.from_pos_matrix-371"><a href="#Pose.from_pos_matrix-371"><span class="linenos">371</span></a>        <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">as_quat</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Create an Pose from a position and a 3x3 matrix.</p>
</div>


                            </div>
                            <div id="Pose.from_position_and_target" class="classattr">
                                        <input id="Pose.from_position_and_target-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">

        <span class="def">def</span>
        <span class="name">from_position_and_target</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">position</span>,</span><span class="param">	<span class="n">target</span><span class="o">=</span><span class="n">Array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)</span>,</span><span class="param">	<span class="n">up</span><span class="o">=</span><span class="n">Array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.from_position_and_target-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.from_position_and_target"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.from_position_and_target-99"><a href="#Pose.from_position_and_target-99"><span class="linenos"> 99</span></a><span class="k">def</span> <span class="nf">camera_from_position_and_target</span><span class="p">(</span>
</span><span id="Pose.from_position_and_target-100"><a href="#Pose.from_position_and_target-100"><span class="linenos">100</span></a>    <span class="n">position</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="n">up</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</span><span id="Pose.from_position_and_target-101"><a href="#Pose.from_position_and_target-101"><span class="linenos">101</span></a><span class="p">):</span>
</span><span id="Pose.from_position_and_target-102"><a href="#Pose.from_position_and_target-102"><span class="linenos">102</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Pose.from_position_and_target-103"><a href="#Pose.from_position_and_target-103"><span class="linenos">103</span></a><span class="sd">    Create a camera pose at `position` with the camera-z-axis pointint at `target`.</span>
</span><span id="Pose.from_position_and_target-104"><a href="#Pose.from_position_and_target-104"><span class="linenos">104</span></a><span class="sd">    Recall that in world coordinates we assume z-axis is up.</span>
</span><span id="Pose.from_position_and_target-105"><a href="#Pose.from_position_and_target-105"><span class="linenos">105</span></a>
</span><span id="Pose.from_position_and_target-106"><a href="#Pose.from_position_and_target-106"><span class="linenos">106</span></a><span class="sd">    Args:</span>
</span><span id="Pose.from_position_and_target-107"><a href="#Pose.from_position_and_target-107"><span class="linenos">107</span></a><span class="sd">        `position`: 3D position vector of the camera</span>
</span><span id="Pose.from_position_and_target-108"><a href="#Pose.from_position_and_target-108"><span class="linenos">108</span></a><span class="sd">        `target`: 3D position vector of the point to look at</span>
</span><span id="Pose.from_position_and_target-109"><a href="#Pose.from_position_and_target-109"><span class="linenos">109</span></a><span class="sd">        `up`: 3D vector pointing up.</span>
</span><span id="Pose.from_position_and_target-110"><a href="#Pose.from_position_and_target-110"><span class="linenos">110</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Pose.from_position_and_target-111"><a href="#Pose.from_position_and_target-111"><span class="linenos">111</span></a>    <span class="n">z</span> <span class="o">=</span> <span class="n">target</span> <span class="o">-</span> <span class="n">position</span>
</span><span id="Pose.from_position_and_target-112"><a href="#Pose.from_position_and_target-112"><span class="linenos">112</span></a>    <span class="n">z</span> <span class="o">=</span> <span class="n">z</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</span><span id="Pose.from_position_and_target-113"><a href="#Pose.from_position_and_target-113"><span class="linenos">113</span></a>
</span><span id="Pose.from_position_and_target-114"><a href="#Pose.from_position_and_target-114"><span class="linenos">114</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">up</span><span class="p">)</span>
</span><span id="Pose.from_position_and_target-115"><a href="#Pose.from_position_and_target-115"><span class="linenos">115</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="Pose.from_position_and_target-116"><a href="#Pose.from_position_and_target-116"><span class="linenos">116</span></a>
</span><span id="Pose.from_position_and_target-117"><a href="#Pose.from_position_and_target-117"><span class="linenos">117</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="Pose.from_position_and_target-118"><a href="#Pose.from_position_and_target-118"><span class="linenos">118</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="Pose.from_position_and_target-119"><a href="#Pose.from_position_and_target-119"><span class="linenos">119</span></a>
</span><span id="Pose.from_position_and_target-120"><a href="#Pose.from_position_and_target-120"><span class="linenos">120</span></a>    <span class="n">rotation_matrix</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">z</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
</span><span id="Pose.from_position_and_target-121"><a href="#Pose.from_position_and_target-121"><span class="linenos">121</span></a>    <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">Rot</span><span class="o">.</span><span class="n">from_matrix</span><span class="p">(</span><span class="n">rotation_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">as_quat</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Create a camera pose at <code><a href="#Pose.position">position</a></code> with the camera-z-axis pointint at <code>target</code>.
Recall that in world coordinates we assume z-axis is up.</p>

<p>Args:
    <code><a href="#Pose.position">position</a></code>: 3D position vector of the camera
    <code>target</code>: 3D position vector of the point to look at
    <code>up</code>: 3D vector pointing up.</p>
</div>


                            </div>
                            <div id="Pose.sample_uniform_pose" class="classattr">
                                        <input id="Pose.sample_uniform_pose-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@jax.jit</div>

        <span class="def">def</span>
        <span class="name">sample_uniform_pose</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">key</span>, </span><span class="param"><span class="n">low</span>, </span><span class="param"><span class="n">high</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.sample_uniform_pose-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.sample_uniform_pose"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.sample_uniform_pose-46"><a href="#Pose.sample_uniform_pose-46"><span class="linenos">46</span></a><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
</span><span id="Pose.sample_uniform_pose-47"><a href="#Pose.sample_uniform_pose-47"><span class="linenos">47</span></a><span class="k">def</span> <span class="nf">sample_uniform_pose</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">):</span>
</span><span id="Pose.sample_uniform_pose-48"><a href="#Pose.sample_uniform_pose-48"><span class="linenos">48</span></a>    <span class="n">keys</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Pose.sample_uniform_pose-49"><a href="#Pose.sample_uniform_pose-49"><span class="linenos">49</span></a>    <span class="n">pos</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="mi">3</span><span class="p">,))</span> <span class="o">*</span> <span class="p">(</span><span class="n">high</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span> <span class="o">+</span> <span class="n">low</span>
</span><span id="Pose.sample_uniform_pose-50"><a href="#Pose.sample_uniform_pose-50"><span class="linenos">50</span></a>    <span class="n">quat</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">4</span><span class="p">,))</span>
</span><span id="Pose.sample_uniform_pose-51"><a href="#Pose.sample_uniform_pose-51"><span class="linenos">51</span></a>    <span class="n">quat</span> <span class="o">=</span> <span class="n">quat</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">quat</span><span class="p">)</span>
</span><span id="Pose.sample_uniform_pose-52"><a href="#Pose.sample_uniform_pose-52"><span class="linenos">52</span></a>    <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">quat</span><span class="p">)</span>
</span></pre></div>




                            </div>
                            <div id="Pose.sample_uniform_pose_vmap" class="classattr">
                                        <input id="Pose.sample_uniform_pose_vmap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@jax.jit</div>

        <span class="def">def</span>
        <span class="name">sample_uniform_pose_vmap</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">key</span>, </span><span class="param"><span class="n">low</span>, </span><span class="param"><span class="n">high</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.sample_uniform_pose_vmap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.sample_uniform_pose_vmap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.sample_uniform_pose_vmap-46"><a href="#Pose.sample_uniform_pose_vmap-46"><span class="linenos">46</span></a><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
</span><span id="Pose.sample_uniform_pose_vmap-47"><a href="#Pose.sample_uniform_pose_vmap-47"><span class="linenos">47</span></a><span class="k">def</span> <span class="nf">sample_uniform_pose</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">):</span>
</span><span id="Pose.sample_uniform_pose_vmap-48"><a href="#Pose.sample_uniform_pose_vmap-48"><span class="linenos">48</span></a>    <span class="n">keys</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Pose.sample_uniform_pose_vmap-49"><a href="#Pose.sample_uniform_pose_vmap-49"><span class="linenos">49</span></a>    <span class="n">pos</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="mi">3</span><span class="p">,))</span> <span class="o">*</span> <span class="p">(</span><span class="n">high</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span> <span class="o">+</span> <span class="n">low</span>
</span><span id="Pose.sample_uniform_pose_vmap-50"><a href="#Pose.sample_uniform_pose_vmap-50"><span class="linenos">50</span></a>    <span class="n">quat</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">4</span><span class="p">,))</span>
</span><span id="Pose.sample_uniform_pose_vmap-51"><a href="#Pose.sample_uniform_pose_vmap-51"><span class="linenos">51</span></a>    <span class="n">quat</span> <span class="o">=</span> <span class="n">quat</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">quat</span><span class="p">)</span>
</span><span id="Pose.sample_uniform_pose_vmap-52"><a href="#Pose.sample_uniform_pose_vmap-52"><span class="linenos">52</span></a>    <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">quat</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Vectorized version of sample_uniform_pose. Takes similar arguments as sample_uniform_pose but with additional array axes over which sample_uniform_pose is mapped.</p>
</div>


                            </div>
                            <div id="Pose.sample_gaussian_vmf_pose" class="classattr">
                                        <input id="Pose.sample_gaussian_vmf_pose-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@jax.jit</div>

        <span class="def">def</span>
        <span class="name">sample_gaussian_vmf_pose</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">key</span>, </span><span class="param"><span class="n">mean_pose</span>, </span><span class="param"><span class="n">std</span>, </span><span class="param"><span class="n">concentration</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.sample_gaussian_vmf_pose-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.sample_gaussian_vmf_pose"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.sample_gaussian_vmf_pose-62"><a href="#Pose.sample_gaussian_vmf_pose-62"><span class="linenos">62</span></a><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
</span><span id="Pose.sample_gaussian_vmf_pose-63"><a href="#Pose.sample_gaussian_vmf_pose-63"><span class="linenos">63</span></a><span class="k">def</span> <span class="nf">sample_gaussian_vmf_pose</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">mean_pose</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">concentration</span><span class="p">):</span>
</span><span id="Pose.sample_gaussian_vmf_pose-64"><a href="#Pose.sample_gaussian_vmf_pose-64"><span class="linenos">64</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Pose.sample_gaussian_vmf_pose-65"><a href="#Pose.sample_gaussian_vmf_pose-65"><span class="linenos">65</span></a><span class="sd">    Samples poses from the product of a diagonal normal distribution (for position) and</span>
</span><span id="Pose.sample_gaussian_vmf_pose-66"><a href="#Pose.sample_gaussian_vmf_pose-66"><span class="linenos">66</span></a><span class="sd">    a generalized von Mises-Fisher distribution (for quaternion).</span>
</span><span id="Pose.sample_gaussian_vmf_pose-67"><a href="#Pose.sample_gaussian_vmf_pose-67"><span class="linenos">67</span></a>
</span><span id="Pose.sample_gaussian_vmf_pose-68"><a href="#Pose.sample_gaussian_vmf_pose-68"><span class="linenos">68</span></a><span class="sd">    Note:</span>
</span><span id="Pose.sample_gaussian_vmf_pose-69"><a href="#Pose.sample_gaussian_vmf_pose-69"><span class="linenos">69</span></a><span class="sd">    One can view the von MisesFisher distribution over the n-sphere</span>
</span><span id="Pose.sample_gaussian_vmf_pose-70"><a href="#Pose.sample_gaussian_vmf_pose-70"><span class="linenos">70</span></a><span class="sd">    as the restriction of the normal distribution on R^{n+1}</span>
</span><span id="Pose.sample_gaussian_vmf_pose-71"><a href="#Pose.sample_gaussian_vmf_pose-71"><span class="linenos">71</span></a><span class="sd">    to the n-sphere. From this viewpoint the concentration is</span>
</span><span id="Pose.sample_gaussian_vmf_pose-72"><a href="#Pose.sample_gaussian_vmf_pose-72"><span class="linenos">72</span></a><span class="sd">    approximateley the inverse of the variance.</span>
</span><span id="Pose.sample_gaussian_vmf_pose-73"><a href="#Pose.sample_gaussian_vmf_pose-73"><span class="linenos">73</span></a>
</span><span id="Pose.sample_gaussian_vmf_pose-74"><a href="#Pose.sample_gaussian_vmf_pose-74"><span class="linenos">74</span></a><span class="sd">    See:</span>
</span><span id="Pose.sample_gaussian_vmf_pose-75"><a href="#Pose.sample_gaussian_vmf_pose-75"><span class="linenos">75</span></a><span class="sd">    &gt; https://en.wikipedia.org/wiki/Von_Mises%E2%80%93Fisher_distribution#Relation_to_normal_distribution</span>
</span><span id="Pose.sample_gaussian_vmf_pose-76"><a href="#Pose.sample_gaussian_vmf_pose-76"><span class="linenos">76</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Pose.sample_gaussian_vmf_pose-77"><a href="#Pose.sample_gaussian_vmf_pose-77"><span class="linenos">77</span></a>    <span class="kn">from</span> <span class="nn">b3d.utils</span> <span class="kn">import</span> <span class="n">keysplit</span>
</span><span id="Pose.sample_gaussian_vmf_pose-78"><a href="#Pose.sample_gaussian_vmf_pose-78"><span class="linenos">78</span></a>
</span><span id="Pose.sample_gaussian_vmf_pose-79"><a href="#Pose.sample_gaussian_vmf_pose-79"><span class="linenos">79</span></a>    <span class="n">_</span><span class="p">,</span> <span class="n">keys</span> <span class="o">=</span> <span class="n">keysplit</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Pose.sample_gaussian_vmf_pose-80"><a href="#Pose.sample_gaussian_vmf_pose-80"><span class="linenos">80</span></a>    <span class="n">var</span> <span class="o">=</span> <span class="n">std</span><span class="o">**</span><span class="mi">2</span>
</span><span id="Pose.sample_gaussian_vmf_pose-81"><a href="#Pose.sample_gaussian_vmf_pose-81"><span class="linenos">81</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mean_pose</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">var</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</span><span id="Pose.sample_gaussian_vmf_pose-82"><a href="#Pose.sample_gaussian_vmf_pose-82"><span class="linenos">82</span></a>    <span class="n">q</span> <span class="o">=</span> <span class="n">tfp</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">VonMisesFisher</span><span class="p">(</span><span class="n">mean_pose</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">concentration</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
</span><span id="Pose.sample_gaussian_vmf_pose-83"><a href="#Pose.sample_gaussian_vmf_pose-83"><span class="linenos">83</span></a>        <span class="n">seed</span><span class="o">=</span><span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Pose.sample_gaussian_vmf_pose-84"><a href="#Pose.sample_gaussian_vmf_pose-84"><span class="linenos">84</span></a>    <span class="p">)</span>
</span><span id="Pose.sample_gaussian_vmf_pose-85"><a href="#Pose.sample_gaussian_vmf_pose-85"><span class="linenos">85</span></a>
</span><span id="Pose.sample_gaussian_vmf_pose-86"><a href="#Pose.sample_gaussian_vmf_pose-86"><span class="linenos">86</span></a>    <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Samples poses from the product of a diagonal normal distribution (for position) and
a generalized von Mises-Fisher distribution (for quaternion).</p>

<p>Note:
One can view the von MisesFisher distribution over the n-sphere
as the restriction of the normal distribution on R^{n+1}
to the n-sphere. From this viewpoint the concentration is
approximateley the inverse of the variance.</p>

<p>See:</p>

<blockquote>
  <p><a href="https://en.wikipedia.org/wiki/Von_Mises%E2%80%93Fisher_distribution#Relation_to_normal_distribution">https://en.wikipedia.org/wiki/Von_Mises%E2%80%93Fisher_distribution#Relation_to_normal_distribution</a></p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.sample_gaussian_vmf_pose_jit" class="classattr">
                                        <input id="Pose.sample_gaussian_vmf_pose_jit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@jax.jit</div>

        <span class="def">def</span>
        <span class="name">sample_gaussian_vmf_pose_jit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">key</span>, </span><span class="param"><span class="n">mean_pose</span>, </span><span class="param"><span class="n">std</span>, </span><span class="param"><span class="n">concentration</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.sample_gaussian_vmf_pose_jit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.sample_gaussian_vmf_pose_jit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.sample_gaussian_vmf_pose_jit-62"><a href="#Pose.sample_gaussian_vmf_pose_jit-62"><span class="linenos">62</span></a><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-63"><a href="#Pose.sample_gaussian_vmf_pose_jit-63"><span class="linenos">63</span></a><span class="k">def</span> <span class="nf">sample_gaussian_vmf_pose</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">mean_pose</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">concentration</span><span class="p">):</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-64"><a href="#Pose.sample_gaussian_vmf_pose_jit-64"><span class="linenos">64</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-65"><a href="#Pose.sample_gaussian_vmf_pose_jit-65"><span class="linenos">65</span></a><span class="sd">    Samples poses from the product of a diagonal normal distribution (for position) and</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-66"><a href="#Pose.sample_gaussian_vmf_pose_jit-66"><span class="linenos">66</span></a><span class="sd">    a generalized von Mises-Fisher distribution (for quaternion).</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-67"><a href="#Pose.sample_gaussian_vmf_pose_jit-67"><span class="linenos">67</span></a>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-68"><a href="#Pose.sample_gaussian_vmf_pose_jit-68"><span class="linenos">68</span></a><span class="sd">    Note:</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-69"><a href="#Pose.sample_gaussian_vmf_pose_jit-69"><span class="linenos">69</span></a><span class="sd">    One can view the von MisesFisher distribution over the n-sphere</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-70"><a href="#Pose.sample_gaussian_vmf_pose_jit-70"><span class="linenos">70</span></a><span class="sd">    as the restriction of the normal distribution on R^{n+1}</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-71"><a href="#Pose.sample_gaussian_vmf_pose_jit-71"><span class="linenos">71</span></a><span class="sd">    to the n-sphere. From this viewpoint the concentration is</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-72"><a href="#Pose.sample_gaussian_vmf_pose_jit-72"><span class="linenos">72</span></a><span class="sd">    approximateley the inverse of the variance.</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-73"><a href="#Pose.sample_gaussian_vmf_pose_jit-73"><span class="linenos">73</span></a>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-74"><a href="#Pose.sample_gaussian_vmf_pose_jit-74"><span class="linenos">74</span></a><span class="sd">    See:</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-75"><a href="#Pose.sample_gaussian_vmf_pose_jit-75"><span class="linenos">75</span></a><span class="sd">    &gt; https://en.wikipedia.org/wiki/Von_Mises%E2%80%93Fisher_distribution#Relation_to_normal_distribution</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-76"><a href="#Pose.sample_gaussian_vmf_pose_jit-76"><span class="linenos">76</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-77"><a href="#Pose.sample_gaussian_vmf_pose_jit-77"><span class="linenos">77</span></a>    <span class="kn">from</span> <span class="nn">b3d.utils</span> <span class="kn">import</span> <span class="n">keysplit</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-78"><a href="#Pose.sample_gaussian_vmf_pose_jit-78"><span class="linenos">78</span></a>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-79"><a href="#Pose.sample_gaussian_vmf_pose_jit-79"><span class="linenos">79</span></a>    <span class="n">_</span><span class="p">,</span> <span class="n">keys</span> <span class="o">=</span> <span class="n">keysplit</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-80"><a href="#Pose.sample_gaussian_vmf_pose_jit-80"><span class="linenos">80</span></a>    <span class="n">var</span> <span class="o">=</span> <span class="n">std</span><span class="o">**</span><span class="mi">2</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-81"><a href="#Pose.sample_gaussian_vmf_pose_jit-81"><span class="linenos">81</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mean_pose</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">var</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-82"><a href="#Pose.sample_gaussian_vmf_pose_jit-82"><span class="linenos">82</span></a>    <span class="n">q</span> <span class="o">=</span> <span class="n">tfp</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">VonMisesFisher</span><span class="p">(</span><span class="n">mean_pose</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">concentration</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-83"><a href="#Pose.sample_gaussian_vmf_pose_jit-83"><span class="linenos">83</span></a>        <span class="n">seed</span><span class="o">=</span><span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-84"><a href="#Pose.sample_gaussian_vmf_pose_jit-84"><span class="linenos">84</span></a>    <span class="p">)</span>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-85"><a href="#Pose.sample_gaussian_vmf_pose_jit-85"><span class="linenos">85</span></a>
</span><span id="Pose.sample_gaussian_vmf_pose_jit-86"><a href="#Pose.sample_gaussian_vmf_pose_jit-86"><span class="linenos">86</span></a>    <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Samples poses from the product of a diagonal normal distribution (for position) and
a generalized von Mises-Fisher distribution (for quaternion).</p>

<p>Note:
One can view the von MisesFisher distribution over the n-sphere
as the restriction of the normal distribution on R^{n+1}
to the n-sphere. From this viewpoint the concentration is
approximateley the inverse of the variance.</p>

<p>See:</p>

<blockquote>
  <p><a href="https://en.wikipedia.org/wiki/Von_Mises%E2%80%93Fisher_distribution#Relation_to_normal_distribution">https://en.wikipedia.org/wiki/Von_Mises%E2%80%93Fisher_distribution#Relation_to_normal_distribution</a></p>
</blockquote>
</div>


                            </div>
                            <div id="Pose.sample_gaussian_vmf_pose_vmap" class="classattr">
                                        <input id="Pose.sample_gaussian_vmf_pose_vmap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@jax.jit</div>

        <span class="def">def</span>
        <span class="name">sample_gaussian_vmf_pose_vmap</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">key</span>, </span><span class="param"><span class="n">mean_pose</span>, </span><span class="param"><span class="n">std</span>, </span><span class="param"><span class="n">concentration</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Pose.sample_gaussian_vmf_pose_vmap-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Pose.sample_gaussian_vmf_pose_vmap"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Pose.sample_gaussian_vmf_pose_vmap-62"><a href="#Pose.sample_gaussian_vmf_pose_vmap-62"><span class="linenos">62</span></a><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-63"><a href="#Pose.sample_gaussian_vmf_pose_vmap-63"><span class="linenos">63</span></a><span class="k">def</span> <span class="nf">sample_gaussian_vmf_pose</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">mean_pose</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="n">concentration</span><span class="p">):</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-64"><a href="#Pose.sample_gaussian_vmf_pose_vmap-64"><span class="linenos">64</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-65"><a href="#Pose.sample_gaussian_vmf_pose_vmap-65"><span class="linenos">65</span></a><span class="sd">    Samples poses from the product of a diagonal normal distribution (for position) and</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-66"><a href="#Pose.sample_gaussian_vmf_pose_vmap-66"><span class="linenos">66</span></a><span class="sd">    a generalized von Mises-Fisher distribution (for quaternion).</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-67"><a href="#Pose.sample_gaussian_vmf_pose_vmap-67"><span class="linenos">67</span></a>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-68"><a href="#Pose.sample_gaussian_vmf_pose_vmap-68"><span class="linenos">68</span></a><span class="sd">    Note:</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-69"><a href="#Pose.sample_gaussian_vmf_pose_vmap-69"><span class="linenos">69</span></a><span class="sd">    One can view the von MisesFisher distribution over the n-sphere</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-70"><a href="#Pose.sample_gaussian_vmf_pose_vmap-70"><span class="linenos">70</span></a><span class="sd">    as the restriction of the normal distribution on R^{n+1}</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-71"><a href="#Pose.sample_gaussian_vmf_pose_vmap-71"><span class="linenos">71</span></a><span class="sd">    to the n-sphere. From this viewpoint the concentration is</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-72"><a href="#Pose.sample_gaussian_vmf_pose_vmap-72"><span class="linenos">72</span></a><span class="sd">    approximateley the inverse of the variance.</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-73"><a href="#Pose.sample_gaussian_vmf_pose_vmap-73"><span class="linenos">73</span></a>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-74"><a href="#Pose.sample_gaussian_vmf_pose_vmap-74"><span class="linenos">74</span></a><span class="sd">    See:</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-75"><a href="#Pose.sample_gaussian_vmf_pose_vmap-75"><span class="linenos">75</span></a><span class="sd">    &gt; https://en.wikipedia.org/wiki/Von_Mises%E2%80%93Fisher_distribution#Relation_to_normal_distribution</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-76"><a href="#Pose.sample_gaussian_vmf_pose_vmap-76"><span class="linenos">76</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-77"><a href="#Pose.sample_gaussian_vmf_pose_vmap-77"><span class="linenos">77</span></a>    <span class="kn">from</span> <span class="nn">b3d.utils</span> <span class="kn">import</span> <span class="n">keysplit</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-78"><a href="#Pose.sample_gaussian_vmf_pose_vmap-78"><span class="linenos">78</span></a>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-79"><a href="#Pose.sample_gaussian_vmf_pose_vmap-79"><span class="linenos">79</span></a>    <span class="n">_</span><span class="p">,</span> <span class="n">keys</span> <span class="o">=</span> <span class="n">keysplit</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-80"><a href="#Pose.sample_gaussian_vmf_pose_vmap-80"><span class="linenos">80</span></a>    <span class="n">var</span> <span class="o">=</span> <span class="n">std</span><span class="o">**</span><span class="mi">2</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-81"><a href="#Pose.sample_gaussian_vmf_pose_vmap-81"><span class="linenos">81</span></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mean_pose</span><span class="o">.</span><span class="n">pos</span><span class="p">,</span> <span class="n">var</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-82"><a href="#Pose.sample_gaussian_vmf_pose_vmap-82"><span class="linenos">82</span></a>    <span class="n">q</span> <span class="o">=</span> <span class="n">tfp</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">VonMisesFisher</span><span class="p">(</span><span class="n">mean_pose</span><span class="o">.</span><span class="n">quat</span><span class="p">,</span> <span class="n">concentration</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-83"><a href="#Pose.sample_gaussian_vmf_pose_vmap-83"><span class="linenos">83</span></a>        <span class="n">seed</span><span class="o">=</span><span class="n">keys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-84"><a href="#Pose.sample_gaussian_vmf_pose_vmap-84"><span class="linenos">84</span></a>    <span class="p">)</span>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-85"><a href="#Pose.sample_gaussian_vmf_pose_vmap-85"><span class="linenos">85</span></a>
</span><span id="Pose.sample_gaussian_vmf_pose_vmap-86"><a href="#Pose.sample_gaussian_vmf_pose_vmap-86"><span class="linenos">86</span></a>    <span class="k">return</span> <span class="n">Pose</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Samples poses from the product of a diagonal normal distribution (for position) and
a generalized von Mises-Fisher distribution (for quaternion).</p>

<p>Note:
One can view the von MisesFisher distribution over the n-sphere
as the restriction of the normal distribution on R^{n+1}
to the n-sphere. From this viewpoint the concentration is
approximateley the inverse of the variance.</p>

<p>See:</p>

<blockquote>
  <p><a href="https://en.wikipedia.org/wiki/Von_Mises%E2%80%93Fisher_distribution#Relation_to_normal_distribution">https://en.wikipedia.org/wiki/Von_Mises%E2%80%93Fisher_distribution#Relation_to_normal_distribution</a></p>
</blockquote>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>
